(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"064b":function(t,e,o){},"14ff":function(t,e,o){},"235c":function(t,e,o){},"5c6b":function(t,e,o){"use strict";o("82b2")},"5e15":function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-page",[o("div",{staticClass:"container full-width"},[o("div",{staticClass:"sticky-bar q-py-sm bg-page text-page q-header--bordered"},[o("q-toolbar",{staticClass:"sticky-bar-toolbar"},[t._l([{tabName:"downloading",label:"start_all",color:"primary",disable:t.isAllStarted,handleClick:t.downloadAll},{tabName:"downloading",label:"pause_all",color:"general",disable:t.isAllPaused,handleClick:t.requestPauseAllDownloading},{tabName:"downloading",label:"remove_all",color:"negative",disable:0===t.currentList.length,handleClick:t.removeAllDownloading},{tabName:"uploading",label:"pause_all",color:"general",disable:t.isAllPaused,handleClick:t.pauseAllUploading},{tabName:"uploading",label:"remove_all",color:"negative",disable:0===t.currentList.length,handleClick:t.removeAllUploading},{tabName:"downloaded",label:"clear_history",color:"general",disable:0===t.currentList.length,handleClick:t.clearAll}],(function(e,s){return o("alphabiz-button",{directives:[{name:"show",rawName:"v-show",value:t.currentTab===e.tabName,expression:"currentTab === buttonData.tabName"}],key:s,style:"negative"===e.color?{marginLeft:"16px"}:{},attrs:{color:e.color,icon:e.icon,label:t.$t(e.label),value:e.disable},on:{click:function(o){return t.ensureLogin(e.handleClick)}}})})),o("q-space"),o("alphabiz-button",{directives:[{name:"show",rawName:"v-show",value:!(t.showSearchText||t.searchText.length),expression:"!(showSearchText || searchText.length)"}],attrs:{"button-type":"icon",icon:"search"},on:{click:function(e){return t.toggleSearchText(!0)}}}),o("q-input",{directives:[{name:"show",rawName:"v-show",value:t.showSearchText||t.searchText.length,expression:"showSearchText || searchText.length"}],ref:"searchInput",attrs:{outlined:"",dense:"",type:"text",debounce:"300"},on:{blur:function(e){return t.toggleSearchText(!1)}},nativeOn:{paste:function(t){t.stopPropagation()}},scopedSlots:t._u([{key:"append",fn:function(){return[o("q-icon",{staticClass:"cursor-pointer text-red",attrs:{name:"close"},on:{click:t.clearSearch}})]},proxy:!0}]),model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),o("alphabiz-button",{attrs:{"button-type":"icon",icon:"list"===t.listMode?"view_list":"view_agenda"},on:{click:t.changeListMode}},[o("q-tooltip",[t._v(t._s(t.$t("toggle_list_mode")))])],1),o("SortMenu",{on:{changeSortSequence:t.changeSortSequence,changeSortOption:t.changeSortOption}})],2),"downloading"===t.currentTab?o("q-toolbar",{staticClass:"sticky-bar-toolbar",staticStyle:{"min-height":"unset"}},[o("q-linear-progress",{attrs:{value:t.downloadingProgress.value,rounded:"",color:"primary",size:"20px"}},[o("div",{staticClass:"absolute-full flex flex-center text-general"},[o("span",{staticStyle:{"font-size":"0.9rem"}},[t._v(t._s(t.downloadingProgress.label))])])]),o("div",{staticClass:"download-speed"},[t._v(t._s(t.totalDownloadSpeed))])],1):t._e(),"uploading"===t.currentTab?o("q-toolbar",{staticClass:"sticky-bar-toolbar",staticStyle:{"min-height":"unset"}},[o("div",[t._v(t._s(t.totalIncomeInfo))]),o("q-space"),o("div",[t._v(t._s(t.$t("total_upload_speed"))+": "+t._s(t.totalUploadSpeed))])],1):t._e()],1),o("q-tab-panels",{staticClass:"torrent-list bg-transparent",class:{"torrent-list-large":"downloaded"!==t.currentTab},model:{value:t.displayTab,callback:function(e){t.displayTab=e},expression:"displayTab"}},t._l(t.displayList,(function(e){return o("q-tab-panel",{key:"panel_"+e.label,staticClass:"q-px-none q-mt-none q-pa-none",attrs:{name:e.key}},[o(t.listComponent,{key:"task-list-"+e.label,tag:"component",attrs:{list:e,tab:t.currentTab,incomes:t.incomes,noDataMessage:t.noDataMessage},on:{pauseTorrent:t.pauseTorrent,resumeTorrent:t.resumeTorrent,deleteTorrent:t.deleteTorrent,play:t.play,showOriginTorrent:t.showOriginTorrent,showDirectory:t.showDirectory,setThrottleGroup:t.setThrottleGroup,saveTorrentFile:t.saveTorrentFile,showPaymentPannel:t.showPaymentPannel,showDetail:t.showDetail,showAbPanel:t.showAbPanel,showPostInfo:t.showPostInfo,showQuickStart:t.showQuickStart}})],1)})),1),o("q-page-sticky",{attrs:{position:"bottom-right",offset:[16,16]}},t._l({download:{tabName:"downloading",icon:"add",handleClick:function(){return t.showMagnetDialog("download")}},upload:{tabName:"uploading",icon:"cloud_upload",handleClick:function(){return t.showMagnetDialog("upload")}},upload_all:{tabName:"downloaded",icon:"cloud_upload",handleClick:t.uploadAll}},(function(e,s){return o("alphabiz-button",{directives:[{name:"show",rawName:"v-show",value:t.currentTab===e.tabName,expression:"currentTab === buttonData.tabName"}],key:s,staticClass:"q-ma-xs",attrs:{color:"primary",icon:e.icon,label:t.$t(s),"button-type":"fab"},on:{click:function(o){return t.ensureLogin(e.handleClick)}}})})),1)],1),o("q-dialog",{staticClass:"channel-post",model:{value:t.showChannelPost,callback:function(e){t.showChannelPost=e},expression:"showChannelPost"}},[t.channelPost?o("PostCard",{attrs:{post:t.channelPost,followable:t.channelFollowable,hideButtons:""},on:{"to-channel":t.toChannelPage}}):t._e()],1),o("torrent-payment",t._b({attrs:{show:t.showPayment,autoRenew:t.autoRenew},on:{change:function(e){return t.showPayment=e},createPayment:t.createPayment,setAutoRenew:t.setAutoRenew}},"torrent-payment",t.paymentData,!1)),o("TableListDetail",{attrs:{show:t.showTorrentDetail,torrent:t.torrentDetail},on:{close:t.hideDetail,showDirectory:t.showDirectory,showPaymentPannel:t.showPaymentPannel,play:t.play}}),o("AlphabizPanel",{attrs:{show:t.showAlphabizPanel,torrent:t.alphabizTorrent,paymentSize:t.paymentSize},on:{close:t.hideAbPanel,createPayment:t.createPayment,setAutoRenew:t.setAutoRenew}}),o("QuickStart",{attrs:{show:t.showQuickStartDialog,preset:t.quickStartTask},on:{input:t.hideQuickStartDialog}})],1)},i=[],n=(o("5319"),o("ddb0"),o("e9c4"),o("9b0f")),a=o.n(n),r=o("a32b"),l=o.n(r),h=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-virtual-scroll",{key:"torrent-list-"+t.list.label,ref:"listIns",staticClass:"q-pt-md",style:"max-height: calc(100vh - "+(t.list.key.startsWith("downloaded")?146:176)+"px);",attrs:{items:t.list.list,"virtual-scroll-item-size":178},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.item;return[o("q-item",{key:t.list.label+"-"+s.infoHash,staticClass:"fit",attrs:{dense:""}},[o("card-item",{attrs:{torrent:s,highlight:s.infoHash&&s.infoHash===t.highlightItem.infoHash},on:{pauseTorrent:t.emitEvent["pauseTorrent"],resumeTorrent:t.emitEvent["resumeTorrent"],deleteTorrent:t.emitEvent["deleteTorrent"],play:t.emitEvent["play"],showOriginTorrent:t.emitEvent["showOriginTorrent"],showDirectory:t.emitEvent["showDirectory"],setThrottleGroup:t.emitEvent["setThrottleGroup"],saveTorrentFile:t.emitEvent["saveTorrentFile"],showPaymentPannel:t.emitEvent["showPaymentPannel"],showDetail:t.emitEvent["showDetail"],showAbPanel:t.emitEvent["showAbPanel"],showPostInfo:t.emitEvent["showPostInfo"],showQuickStart:t.emitEvent["showQuickStart"]}})],1)]}},{key:"after",fn:function(){return[t.list.list.length?t._e():o("div",{staticClass:"full-width text-center text-subtitle1"},[o("q-icon",{attrs:{name:"help_outline"}}),t._v("\n        "+t._s(t.noDataMessage)+"\n      ")],1),o("div",{directives:[{name:"show",rawName:"v-show",value:t.list.list.length,expression:"list.list.length"}],staticClass:"q-py-xl"})]},proxy:!0}])})},d=[],c=o("c428"),u=o("1ffc"),p={name:"CardList",props:{list:Object,noDataMessage:String},data(){const t=this;return{emitEvent:new Proxy({},{get(e,o){return(...e)=>{t.$emit(o,...e)}}}),highlightItem:{}}},components:{CardItem:u["a"]},methods:{findTaskIndex(t,e){for(const o in this.list.list){const s=this.list.list[o];if(e&&s.fromPost===e)return console.log("found item by soul",e),parseInt(o);if(Object(c["a"])(s.alphabizURI)===t)return console.log("found",t,s.alphabizURI,o),parseInt(o)}return-1}},activated(){this.highlightItem={infoHash:-1},this.$route.query&&this.$route.query.abKey&&setTimeout((()=>{if(this.$refs.listIns){var t;const e=null===(t=this.$route.query.abKey)||void 0===t?void 0:t.replace(/\s/g,"+"),o=this.findTaskIndex(e,this.$route.query.soul);if(-1===o)return console.log("Cannot find abKey",e);const s=this.list.list[o];console.log("scroll to",o,s),this.highlightItem=s,this.$refs.listIns.scrollTo(o,"center"),setTimeout((()=>{this.highlightItem===s&&(this.highlightItem={infoHash:-1})}),2500)}else console.log("List ins not found")}),1100)}},m=p,g=(o("f74a"),o("2877")),b=o("a12b"),f=o("66e5"),w=o("0016"),y=o("eebe"),_=o.n(y),v=Object(g["a"])(m,h,d,!1,null,"6cf315b5",null),T=v.exports;_()(v,"components",{QVirtualScroll:b["a"],QItem:f["a"],QIcon:w["a"]});var S=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-table",{ref:"tableIns",staticClass:"list bg-page text-page",attrs:{data:t.list.list,columns:t.columns,"row-key":"name",dense:"","virtual-scroll":"","hide-bottom":!!t.list.list.length,"rows-per-page-options":[0],"visible-columns":t.visibleColumns,"no-data-label":t.noDataMessage},nativeOn:{mousemove:function(e){return t.onDrag(e)},mouseleave:function(e){return t.onDragEnd.apply(null,arguments)},mouseup:function(e){return t.onDragEnd.apply(null,arguments)}},scopedSlots:t._u([{key:"header",fn:function(e){return[o("q-tr",{attrs:{props:e}},t._l(e.cols,(function(s){return o("q-th",{key:s.name,staticClass:"thead",attrs:{props:e}},[o("span",{staticClass:"text-ellipsis"},[t._v(t._s(s.label))]),"options"!==s.name?o("span",{staticClass:"thead-dragable",on:{mousedown:function(e){return t.onDragStart(s,e)},mouseup:t.onDragEnd}},[t._v("|")]):t._e()])})),1)]}},{key:"body",fn:function(e){return[o("ListItem",{key:e.row.infoHash,attrs:{torrent:e.row,visibleColumns:t.visibleColumns,showCols:t.showCols,incomes:t.taskIncomes[e.row.infoHash],colWidth:t.colWidthText,highlight:e.row.infoHash&&e.row.infoHash===t.highlightItem.infoHash},on:{pauseTorrent:t.emitEvent["pauseTorrent"],resumeTorrent:t.emitEvent["resumeTorrent"],deleteTorrent:t.emitEvent["deleteTorrent"],play:t.emitEvent["play"],showOriginTorrent:t.emitEvent["showOriginTorrent"],showDirectory:t.emitEvent["showDirectory"],setThrottleGroup:t.emitEvent["setThrottleGroup"],saveTorrentFile:t.emitEvent["saveTorrentFile"],showPaymentPannel:t.emitEvent["showPaymentPannel"],showDetail:t.emitEvent["showDetail"],showAbPanel:t.emitEvent["showAbPanel"],showPostInfo:t.emitEvent["showPostInfo"],showQuickStart:t.emitEvent["showQuickStart"]}})]}},{key:"bottom-row",fn:function(){return[o("div",{directives:[{name:"show",rawName:"v-show",value:t.list.list.length,expression:"list.list.length"}],staticClass:"q-py-xl"})]},proxy:!0},{key:"no-data",fn:function(){return[o("div",{staticClass:"full-width text-center text-subtitle1"},[o("q-icon",{attrs:{name:"help_outline"}}),t._v("\n      "+t._s(t.noDataMessage)+"\n    ")],1)]},proxy:!0}])})},$=[],k=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-tr",{key:t.torrent.infoHash||t.torrent.origin,staticClass:"list-item-tr",class:{highlight:t.highlight}},[o("q-td",{key:"name",staticClass:"no-select task-name",style:t.colWidth.name,on:{dblclick:t.onDoubleClick}},[o("IconWithTooltip",t._b({staticClass:"q-mr-xs name-icon"},"IconWithTooltip",t.taskIcon,!1)),o("div",{staticClass:"name-info"},[o("span",{staticClass:"torrent-name",attrs:{title:t.displayName}},[t._v(t._s(t.displayName))]),o("br"),t.torrent.isAutoUpload?o("IconWithTooltip",{staticClass:"q-mr-xs text-primary",attrs:{tooltip:t.$t("auto_uploading"),icon:"cloud_upload"}}):t._e(),o("span",{staticClass:"text-grey"},[t._v(t._s(t.downloadStatus))])],1)],1),t.showCols["remaining"]?o("q-td",{key:"remaining",style:t.colWidth.remaining},[t._v(t._s(t.remaining))]):t._e(),t.showCols["completedTime"]?o("q-td",{key:"completedTime",style:t.colWidth.completedTime},[t._v(t._s(t.completedTime))]):t._e(),t.showCols["progress"]?o("q-td",{key:"progress",style:t.colWidth.progress},[o("q-linear-progress",{attrs:{value:t.torrent.progress,color:"primary",size:"20px",rounded:""}},[o("div",{staticClass:"absolute-full flex flex-center text-general"},[o("span",{staticStyle:{"font-size":"0.9rem"}},[t._v(t._s(t.progress||"0%"))])])])],1):t._e(),t.showCols["uploadSpeed"]?o("q-td",{key:"uploadSpeed",style:t.colWidth.uploadSpeed},[t._v(t._s(t.uploadSpeed))]):t._e(),t.showCols["downloadSpeed"]?o("q-td",{key:"downloadSpeed",staticClass:"download-speed",style:t.colWidth.downloadSpeed},[o("span",{attrs:{title:t.downloadSpeed}},[t._v(t._s(t.downloadSpeed))]),t.showAbButton?o("q-btn",{staticClass:"text-primary float-right",attrs:{flat:"",dense:"",size:"sm"},on:{click:t.openAbPanel}},[o("IconWithTooltip",{attrs:{icon:t.isPayed?"flash_auto":"flash_on",tooltip:t.isPayed?t.$t("alphabiz_accelerating"):t.$t("ab_peer_available")}})],1):t._e()],1):t._e(),t.showCols["incomeInfo"]?o("q-td",{key:"incomeInfo",staticClass:"text-right",style:t.colWidth.incomeInfo},[t._v(t._s(t.incomeInfo))]):t._e(),t.visibleColumns.includes("options")?o("q-td",{key:"options",staticClass:"option-btns",style:t.colWidth.options,attrs:{"auto-width":""}},[t.torrent.isAutoUpload||t.torrent.missFile?t._e():o("q-btn",{attrs:{flat:"",dense:"",size:"sm",disable:t.locked},on:{click:t.toggleStatus}},[o("IconWithTooltip",{attrs:{icon:t.actionIcon,tooltip:t.taskAction,clickable:""}})],1),o("q-btn",{attrs:{flat:"",dense:"",size:"sm"},on:{click:t.onDoubleClick}},[o("IconWithTooltip",{attrs:{icon:"file_open",tooltip:t.$t("open_file"),clickable:""}})],1),o("q-btn",{attrs:{flat:"",dense:"",size:"sm"},on:{click:t.showDirectory}},[o("IconWithTooltip",{attrs:{icon:"folder",tooltip:t.$t("open_directory"),clickable:""}})],1),t.torrent.fromPost?o("q-btn",{attrs:{flat:"",dense:"",size:"sm"},on:{click:t.showPostInfo}},[o("IconWithTooltip",{attrs:{icon:"video_library",tooltip:t.$t("library"),clickable:""}})],1):t._e(),1!==t.torrent.progress||t.torrent.paused?t._e():o("q-btn",{attrs:{flat:"",dense:"",size:"sm"},on:{click:t.showQuickStart}},[o("IconWithTooltip",{attrs:{icon:"present_to_all",tooltip:t.$t("share_to_library"),clickable:""}})],1),o("q-btn",{attrs:{flat:"",dense:"",size:"sm"},on:{click:t.showDetail}},[o("IconWithTooltip",{attrs:{icon:"more_horiz",tooltip:t.$t("more"),clickable:""}})],1),o("q-btn",{staticClass:"text-red",attrs:{flat:"",dense:"",size:"sm"},on:{click:t.deleteTorrent}},[o("IconWithTooltip",{attrs:{icon:"close",tooltip:t.$t("delete"),clickable:""}})],1)],1):t._e()],1)},I=[],q=o("f880"),x=o("0613"),C=o("51d9"),D=o("307e"),P={name:"ListItem",props:{torrent:{type:Object,required:!0},visibleColumns:{type:Array,required:!0},showCols:{type:Object,required:!0},incomes:{type:Object,default:()=>({})},colWidth:{type:Object,default:()=>({})},highlight:Boolean},inject:["io"],components:{IconWithTooltip:C["a"]},data(){return{locked:!1}},computed:{isDevMode(){return x["a"].getters.isDevMode},displayName(){const t=this.torrent.postTitle||this.torrent.name||this.torrent.origin||this.torrent.token;if(!t)return"";if(t.includes("&dn")){const e=(t+"&").match(/&dn=(.*?)&/);if(e&&e[1])return e[1]}const e=t.match(/btih:([^&]*)/);if(e&&e[1])return e[1];if(t.includes("/")||t.includes("\\")){const e=t.replace(/(\\|\/)$/,"").match(/([^\\/]*$)/);if(e&&e[1])return e[1]}return t},isReady(){return this.torrent&&this.torrent.name&&this.torrent.ready},taskIcon(){const t=this.torrent.files?this.torrent.files:[],e=Object(q["c"])(t.map((t=>t.path||t)));return{icon:e.icon,tooltip:this.$t(e.tooltip)}},downloadStatus(){if(this.torrent.isSeeding||this.torrent.done){if(this.torrent.missFile)return this.$t("miss_file");if(!this.torrent.length){if(this.torrent.verifyStatus){const{current:t,total:e}=this.torrent.verifyStatus,o=t/e,s=Object(q["f"])(o);if(!isNaN(o))return this.$t("loading")+` (${s})`}return this.$t("loading")}return Object(q["a"])(this.torrent.length)}return this.isReady||this.torrent.paused||this.torrent.length?this.torrent.done||this.torrent.downloaded===this.torrent.length?Object(q["a"])(this.torrent.length):`${Object(q["a"])(this.torrent.downloaded)}/${Object(q["a"])(this.torrent.length)}`:"-"},remaining(){return this.torrent.paused||this.torrent.pending?"-":Object(q["d"])(this.torrent.timeRemaining)},completedTime(){const t=(...t)=>this.$t(...t);return this.torrent.completedTime?Object(q["e"])(this.torrent.completedTime,t,null===this||void 0===this?void 0:this.$i18n.locale):Object(q["e"])(this.torrent.createdTime,t,null===this||void 0===this?void 0:this.$i18n.locale)},progress(){return Object(q["f"])(this.torrent.progress)},downloadSpeed(){if(this.torrent.paused)return this.$t("paused");if(this.torrent.pending)return this.$t("pending");if(!this.torrent.ready){if(!this.torrent.hasMetadata)return this.$t("loading");if(this.torrent.waiting)return this.$t("waiting_for_verify");if(this.torrent.verifyStatus){const{current:t,total:e}=this.torrent.verifyStatus,o=t/e,s=Object(q["f"])(o);if(!isNaN(o))return this.$t("verifying")+` (${s})`}return this.$t("verifying")}return Object(q["a"])(this.torrent.downloadSpeed,{byte:!1,gb:!1})+"/s"},incomeInfo(){return[Number(((this.incomes.today||0)/1e3).toFixed(3)),Number(((this.incomes.total||0)/1e3).toFixed(3))].join(" / ")},uploadSpeed(){return this.torrent.ready?Object(q["a"])(this.torrent.uploadSpeed,{byte:!1,gb:!1})+"/s":"-/s"},taskAction(){return this.torrent.paused?this.torrent.done||this.torrent.isSeeding?this.$t("seed"):this.$t("resume"):this.torrent.isSeeding?this.$t("stop_torrent"):this.$t("pause")},actionIcon(){return this.torrent.paused?this.torrent.done||this.torrent.isSeeding?"cloud_upload":"play_arrow":this.torrent.isSeeding?"stop":"pause"},playableFiles(){var t;return(null===(t=this.torrent.files)||void 0===t?void 0:t.filter((t=>Object(D["a"])(t.name))))||[]},playable(){return this.playableFiles.length},abPeers(){return this.torrent.connections?this.torrent.connections.filter((t=>!(!this.torrent.hasMetadata&&!t.hasMeta)&&(!!t.hasResource&&(t.isAbPeer&&t.subId&&t.subId!==x["a"].getters.accountUserInfo.sub)))):[]},showAbButton(){return this.isDevMode&&this.abPeers.length},isPayed(){return this.abPeers.some((t=>"high"===t.remoteGroup))}},methods:{shouldShow(t){return this.visibleColumns.includes(t)},onDoubleClick(){this.playable?this.$emit("play",this.playableFiles[0].path,this.torrent.infoHash):this.torrent.files&&this.torrent.files.length?this.openFile():this.$q.notify(this.$t("no_available_file"))},toggleStatus(){if(!this.locked)if(this.locked=!0,this.torrent.isSeeding?setTimeout((()=>{this.locked=!1}),2e3):setTimeout((()=>{this.locked=!1}),1e3),this.torrent.paused)this.$emit("resumeTorrent",this.torrent);else{if(!this.torrent.infoHash)return this.$q.dialog({message:this.$t("this_task_not_ready"),ok:this.$t("remove"),cancel:this.$t("cancel")}).onOk((()=>{this.io.emit("delete_torrent",this.torrent.token,!1)}));this.$emit("pauseTorrent",this.torrent.infoHash||this.torrent.token)}},deleteTorrent(){this.$emit("deleteTorrent",this.torrent)},openFile(){1===this.torrent.files.length?this.io.emit("open-external-file",this.torrent.files[0].path,this.torrent.infoHash):this.showDirectory()},showDirectory(){this.$emit("showDirectory",this.torrent)},showDetail(){this.$emit("showDetail",this.torrent)},showPostInfo(){this.$emit("showPostInfo",this.torrent.fromPost)},openAbPanel(){this.$emit("showAbPanel",this.torrent)},showQuickStart(){this.$emit("showQuickStart",this.torrent)}}},O=P,L=(o("755b"),o("bd08")),A=o("db86"),H=o("6b1d"),Q=o("9c40"),j=Object(g["a"])(O,k,I,!1,null,null,null),N=j.exports;_()(j,"components",{QTr:L["a"],QTd:A["a"],QLinearProgress:H["a"],QBtn:Q["a"]});var z=o("e302"),R={name:"TableList",props:{list:{type:Object,required:!0},tab:{type:String,default:"downloading"},incomes:{type:Object,default:()=>({})},noDataMessage:{type:String,default:()=>""}},components:{ListItem:N},data(){const t=this;let e={name:250,remaining:80,completedTime:80,progress:120,downloadSpeed:150,uploadSpeed:100,incomeInfo:120,options:165};return localStorage.getItem("table-col-width")||localStorage.setItem("table-col-width",JSON.stringify(e)),e=JSON.parse(localStorage.getItem("table-col-width")),{emitEvent:new Proxy({},{get(e,o){return(...e)=>{t.$emit(o,...e)}}}),defaultColumns:{downloading:["name","remaining","progress","downloadSpeed","options"],uploading:["name","completedTime","uploadSpeed","incomeInfo","options"],downloaded:["name","completedTime","options"]},dragData:{start:!1,col:"",pageX:0,pageY:0},highlightItem:{},colWidth:e}},computed:{columns(){return[{name:"name",required:!0,label:this.$t("task_name"),align:"left",headerStyle:this.colWidthText.name+";padding-left: 48px; max-width: calc(100% - 48px);"},{name:"remaining",label:this.$t("remaining"),align:"left",headerStyle:this.colWidthText.remaining+"; max-width: calc(100% - 8px)"},{name:"completedTime",label:this.$t("completed_time"),align:"left",headerStyle:this.colWidthText.completedTime+"; max-width: calc(100% - 8px)"},{name:"progress",label:this.$t("progress"),align:"left",headerStyle:this.colWidthText.progress+"; max-width: calc(100% - 8px)"},{name:"downloadSpeed",label:this.$t("total_download_speed"),align:"left",headerStyle:this.colWidthText.downloadSpeed+"; max-width: calc(100% - 8px)"},{name:"uploadSpeed",label:this.$t("total_upload_speed"),align:"left",headerStyle:this.colWidthText.uploadSpeed+"; max-width: calc(100% - 8px)"},{name:"incomeInfo",label:this.$t("income_info"),align:"right",headerStyle:this.colWidthText.incomeInfo+"; max-width: calc(100% - 8px)"},{name:"options",label:this.$t("operations"),align:"left"}]},visibleColumns(){switch(this.tab){case"downloading":return this.defaultColumns.downloading;case"uploading":return 2!==this.$store.state.credits.isModuleInit?this.defaultColumns.uploading.filter((t=>"incomeInfo"!==t)):this.defaultColumns.uploading;case"downloaded":return this.defaultColumns.downloaded}return this.defaultColumns.downloading},showCols(){const t={};for(const e of this.visibleColumns)t[e]=!0;return t},colWidthText(){const t={};for(const e in this.colWidth){const o=this.colWidth[e];t[e]=`width: ${o}px; min-width: ${o}px; max-width: ${o}px;`}return t},tableList(){var t,e;return(null===(t=this.list)||void 0===t||null===(e=t.list)||void 0===e?void 0:e.map((t=>({name:t.name}))))||[]},taskIncomes(){const{todayTaskIncome:t,allTaskIncome:e}=this.incomes,o={};for(const s in e)o[s]||(o[s]={today:0,total:0}),o[s].total+=e[s],t[s]&&(o[s].today+=t[s]);return o}},methods:{onDragStart(t,e){this.dragData.pageX=e.pageX,this.dragData.pageY=e.pageY,this.dragData.start=!0,this.dragData.col=t.name,document.body.style.cursor="col-resize"},onDragEnd(){this.dragData.start&&(this.dragData.start=!1,document.body.style.cursor="",localStorage.setItem("table-col-width",JSON.stringify(this.colWidth)))},onDrag(t){if(!this.dragData.start)return;const e=this.dragData.pageX-t.pageX;this.dragData.pageX=t.pageX,this.colWidth[this.dragData.col]&&(this.colWidth[this.dragData.col]-=e,this.colWidth[this.dragData.col]<80&&(this.colWidth[this.dragData.col]=80))},onResize(){this.$refs.tableIns.resetVirtualScroll()},findTaskIndex(t,e){for(const o in this.list.list){const s=this.list.list[o];if(e&&s.fromPost===e)return console.log("found item by soul",e),parseInt(o);if(Object(c["a"])(s.alphabizURI)===t)return console.log("found",t,s.alphabizURI,o),parseInt(o)}return-1}},created(){this.onDrag=Object(z["a"])(this.onDrag,1e3/60),this.onResize=Object(z["a"])(this.onResize)},mounted(){window.addEventListener("resize",this.onResize)},beforeDestroy(){window.removeEventListener("resize",this.onResize)},activated(){console.log("table created",this.$route.query),this.highlightItem={infoHash:-1},this.$route.query&&this.$route.query.abKey&&setTimeout((()=>{if(this.$refs.tableIns){var t;const e=null===(t=this.$route.query.abKey)||void 0===t?void 0:t.replace(/\s/g,"+"),o=this.findTaskIndex(e,this.$route.query.soul);if(-1===o)return console.log("Cannot find abKey",e);const s=this.list.list[o];console.log("scroll to",o,s),this.highlightItem=s,this.$refs.tableIns.scrollTo(o,"center"),setTimeout((()=>{this.highlightItem===s&&(this.highlightItem={infoHash:-1})}),2500)}else console.log("Table ins not found")}),1100)}},E=R,W=(o("b6d3"),o("eaac")),M=o("357e"),F=Object(g["a"])(E,S,$,!1,null,null,null),U=F.exports;_()(F,"components",{QTable:W["a"],QTr:L["a"],QTh:M["a"],QIcon:w["a"]});var B=function(){var t=this,e=this,o=e.$createElement,s=e._self._c||o;return s("q-dialog",{attrs:{value:e.show},on:{input:function(e){return t.$emit("change",e)},"before-hide":function(){return t.disable=!1}}},[s("q-card",{staticClass:"info"},[s("q-card-section",[s("div",{staticClass:"text-h6"},[e._v(e._s(e.$t("create_payment")))]),s("div",{staticClass:"infohash"},[e._v(e._s(e.$t("pay_for_torrent",[e.torrentName])))]),s("small",{staticClass:"infohash text-secondary"},[e._v("infoHash: "+e._s(e.infoHash))]),s("div",{staticClass:"peer-info"},[e._v(e._s(e.$t("pay_target"))+":\n        "),s("div",{staticClass:"q-ml-sm remote"},[e._v("SubId: "+e._s(e.remoteSubId))]),s("div",{staticClass:"peer-address q-ml-md"},[e._v("Address: "+e._s(e.address))]),s("div",{staticClass:"peer-id q-ml-md"},[e._v("PeerId: "+e._s(e.peerId))])]),s("div",{staticClass:"space q-my-md"}),s("div",{staticClass:"user-info"},[s("div",{staticClass:"sub-id"},[e._v(e._s(e.$t("your_subid"))+": "+e._s(e.subId))]),s("div",{staticClass:"credit-count"},[e._v(e._s(e.$t("your_credits"))+": "+e._s(e.credit))])]),s("div",{staticClass:"actions"},[s("q-btn",{attrs:{"no-caps":"",label:e.$t("pay_point_for_data",[2,"20MB"]),disable:e.disable,loading:e.disable},on:{click:function(t){return e.pay(2)}}}),s("q-btn",{attrs:{"no-caps":"",label:e.$t("pay_point_for_data",[10,"100MB"]),disable:e.disable,loading:e.disable},on:{click:function(t){return e.pay(10)}}}),s("br"),s("q-toggle",{attrs:{value:e.enableAutoRenew,label:e.$t("auto_renew"),"left-label":""},on:{input:e.setAutoRenew}})],1)])],1)],1)},J=[],G=o("c0c0"),K={name:"TorrentPayment",mixins:[G["a"]],props:{infoHash:{type:String,default:""},torrentName:{type:String,default:""},peerId:{type:String,default:""},address:{type:String,default:""},remoteUser:{type:String,default:""},remoteSubId:{type:String,default:""},show:{type:Boolean,default:!1},autoRenew:{type:Object,default:()=>({})}},data(){return{disable:!1,sentTransactions:new Set,pendingTransactions:new Map}},computed:{credit(){return this.dp$credit},userId(){return this.$store.state.account.username},subId(){return this.dp$address},enableAutoRenew(){return this.autoRenew&&this.autoRenew[this.infoHash]||!1},income(){return this.dp$incomeTxnList},expenses(){return this.dp$expenseTxnList}},methods:{setAutoRenew(t){this.$emit("setAutoRenew",this.infoHash,t)},pay(t=1){if(!this.infoHash.length||!this.peerId.length||!this.remoteSubId.length)return this.$q.notify("Info missing");this.disable=!0,console.log("dp$ create payment from","TorrentPayment::pay"),this.$emit("createPayment",{infoHash:this.infoHash,peerId:this.peerId,remoteSubId:this.remoteSubId,payed:t,autoRenew:this.enableAutoRenew})}}},X=K,Y=o("24e8"),V=o("f09f"),Z=o("a370"),tt=o("9564"),et=Object(g["a"])(X,B,J,!1,null,null,null),ot=et.exports;_()(et,"components",{QDialog:Y["a"],QCard:V["a"],QCardSection:Z["a"],QBtn:Q["a"],QToggle:tt["a"]});var st=o("d491"),it=o("9e90"),nt=o("2de9"),at=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("alphabiz-button",{attrs:{"button-type":"icon",icon:"sort"}},[o("q-tooltip",[t._v(t._s(t.$t("sort")))]),o("q-menu",{attrs:{"transition-show":"jump-down","transition-hide":"jump-up"}},[o("q-list",{attrs:{padding:""}},[o("q-item",{staticStyle:{"min-width":"240px"}},[o("q-item-section",[o("q-item-label",[t._v(t._s(t.$t("sort")))])],1),o("q-item-section",{attrs:{side:""}},[o("q-badge",{staticClass:"cursor-pointer non-selectable",attrs:{color:"general","text-color":"general"},on:{click:t.changeSortSequence}},[o("span",{staticClass:"q-ml-sm"},[t._v(t._s(1===t.sortSequence?t.$t("ascending"):t.$t("descending")))]),o("q-icon",{attrs:{size:"1.5rem",name:1===t.sortSequence?"arrow_drop_up":"arrow_drop_down"}})],1)],1)],1),o("q-separator"),t._l(t.options,(function(e){return o("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.value,attrs:{clickable:"",dense:"",tag:"label"}},[o("q-item-section",{attrs:{avatar:""}},[o("q-radio",{attrs:{val:e.value,color:"positive"},model:{value:t.sortOption,callback:function(e){t.sortOption=e},expression:"sortOption"}})],1),o("q-item-section",[o("q-item-label",[t._v(t._s(e.label))])],1)],1)}))],2)],1)],1)},rt=[],lt={name:"DownloaderSortMenu",inject:["io"],data(){return{sortOption:"createdTime",sortSequence:1}},computed:{options(){switch(this.$route.query.currentTab){case"downloading":return[{label:this.$t("status"),value:"status"},{label:this.$t("task_name"),value:"name"},{label:this.$t("size"),value:"length"},{label:this.$t("total_download_speed"),value:"downloadSpeed"},{label:this.$t("progress"),value:"progress"},{label:this.$t("remaining"),value:"timeRemaining"},{label:this.$t("created_time"),value:"createdTime"},{label:this.$t("used_time"),value:"usedTime"}];case"uploading":return[{label:this.$t("status"),value:"status"},{label:this.$t("task_name"),value:"name"},{label:this.$t("size"),value:"length"},{label:this.$t("total_upload_speed"),value:"uploadSpeed"},{label:this.$t("created_time"),value:"createdTime"},{label:this.$t("completed_time"),value:"completedTime"},{label:this.$t("income"),value:"income"}];case"downloaded":return[{label:this.$t("status"),value:"status"},{label:this.$t("task_name"),value:"name"},{label:this.$t("size"),value:"length"},{label:this.$t("created_time"),value:"createdTime"},{label:this.$t("completed_time"),value:"completedTime"},{label:this.$t("used_time"),value:"usedTime"}]}return[{label:this.$t("status"),value:"status"},{label:this.$t("task_name"),value:"name"}]}},methods:{saveSortOptions(){localStorage.setItem("sortOptions_"+this.$route.query.currentTab,JSON.stringify({sortOption:this.sortOption,sortSequence:this.sortSequence}))},changeSortSequence(){this.sortSequence=-1*this.sortSequence,this.$emit("changeSortSequence",this.sortSequence),this.io.emit("set_sort_sequence",this.sortSequence),this.saveSortOptions()}},mounted(){const t=localStorage.getItem("sortOptions_"+this.$route.query.currentTab);if(t){const{sortOption:e,sortSequence:o}=JSON.parse(t);e&&(this.sortOption=e),o&&(this.sortSequence=o)}else this.sortOption="createdTime",this.sortSequence=1,this.saveSortOptions()},watch:{sortOption(t){this.$emit("changeSortOption",t),this.io.emit("set_sort_option",this.sortOption),this.saveSortOptions()},"$route.query.currentTab"(t,e){if(t===e||!t)return;const o=localStorage.getItem("sortOptions_"+t);if(o){const{sortOption:t,sortSequence:e}=JSON.parse(o);t&&(this.sortOption=t),e&&(this.sortSequence=e)}else this.sortOption="createdTime",this.sortSequence=1}}},ht=lt,dt=o("05c0"),ct=o("4e73"),ut=o("1c1c"),pt=o("4074"),mt=o("0170"),gt=o("58a8"),bt=o("eb85"),ft=o("3786"),wt=o("714f"),yt=Object(g["a"])(ht,at,rt,!1,null,"b08e87f8",null),_t=yt.exports;_()(yt,"components",{QTooltip:dt["a"],QMenu:ct["a"],QList:ut["a"],QItem:f["a"],QItemSection:pt["a"],QItemLabel:mt["a"],QBadge:gt["a"],QIcon:w["a"],QSeparator:bt["a"],QRadio:ft["a"]}),_()(yt,"directives",{Ripple:wt["a"]});var vt=o("4aad"),Tt=o("1141"),St=o("648d"),$t=o("9b6a"),kt=o("b4ab");const It=o("ed08").isElectron(),qt=It?o("34bb").clipboard:null;var xt={name:"Downloader",inject:["rootApp","io","taskQueue"],mixins:[G["a"]],components:{CardList:T,TableList:U,TableListDetail:st["a"],IconWithTooltip:C["a"],AlphabizPanel:it["a"],TorrentPayment:ot,SortMenu:_t,PostCard:nt["a"],QuickStart:kt["a"]},data(){return{currentTab:"downloading",loading:!1,listMode:localStorage.getItem("task-list-mode")||"card",searchText:"",showSearchText:!1,autoRenew:JSON.parse(localStorage.getItem("task-autorenew")||"{}"),sortOption:"createdTime",sortSequence:1,statusText:{},info:{downloadSpeed:0,uploadSpeed:0,progress:0,taskNum:0},showPayment:!1,showTorrentDetail:!1,torrentDetailInfoHash:"",paymentData:{infoHash:"",torrentName:"",peerId:"",address:"",remoteUser:"",remoteSubId:""},paymentSize:1e7,showAlphabizPanel:!1,abTorrentInfoHash:"",lib:vt["a"],showChannelPost:!1,channelPost:null,showQuickStartDialog:!1,quickStartTask:null}},computed:{torrentList(){return St["a"].taskList},listComponent(){switch(this.listMode){case"list":return"TableList";case"card":return"CardList";default:return"CardList"}},displayTab:{get(){return this.currentTab+"Torrents"},set(t){const e=t.replace(/Torrents$/,"");this.$router.push({path:this.$route.path,query:{...this.$route.query,currentTab:e}})}},displayList(){return[{key:"downloadingTorrents",label:this.$t("downloading"),open:!0,list:this.filterTorrent(this.downloadingTorrents||[])},{key:"uploadingTorrents",label:this.$t("uploading"),open:!1,list:this.filterTorrent(this.uploadingTorrents||[])},{key:"downloadedTorrents",label:this.$t("downloaded"),open:!1,list:this.filterTorrent(this.downloadedTorrents||[])}]},currentList(){switch(this.displayTab){case"downloadingTorrents":return this.displayList[0].list;case"uploadingTorrents":return this.displayList[1].list;default:return this.displayList[2].list}},isAllStarted(){return this.currentList.every((t=>!t.paused))},isAllPaused(){return this.currentList.every((t=>t.paused))},noDataMessage(){return this.searchText?this.$t("no_matched_task"):this.$t("no_task")},downloadingTorrents(){const t=this.sortTorrents(this.torrentList.downloading);return t},disableDownloadAll(){return this.loading||this.downloadingTorrents.every((t=>!t.paused))},disablePauseAllDownloading(){return this.loading||this.downloadingTorrents.every((t=>t.paused))},downloadingProgress(){const t=this.torrentList.totalDownloadProgress;return isNaN(t)||0===t&&0===this.downloadingNum?{value:0,label:this.$t("no_downloading_task")}:{value:t,label:Object(q["f"])(t)}},uploadingTorrents(){const t=this.sortTorrents(this.torrentList.uploading);return t},totalDownloadSpeed(){return this.torrentList.totalDownloadSpeed?Object(q["a"])(this.torrentList.totalDownloadSpeed,{byte:!1,gb:!1})+" / s":"0.00 KB / s"},totalUploadSpeed(){if(!this.uploadingTorrents)return"-";const t=this.torrentList.totalUploadSpeed;return Object(q["a"])(t,{byte:!1,gb:!1})+" / s"},downloadedTorrents(){return this.sortTorrents(this.torrentList.downloaded)},torrentItems(){return St["a"].allTasks},torrentDetail(){return this.torrentDetailInfoHash&&this.torrentItems.find((t=>t.infoHash===this.torrentDetailInfoHash))||{}},alphabizTorrent(){return this.abTorrentInfoHash&&this.torrentItems.find((t=>t.infoHash===this.abTorrentInfoHash))||{}},downloadingNum(){return this.downloadingTorrents.filter((t=>!t.paused&&!t.pending&&!(!t.download||1===t.progress))).length},incomes(){let t=0;const e={};this.dp$incomeTxnListToday.forEach((o=>{if(!o.meta||"FINISH"!==o.status)return;t+=o.amount;const s=JSON.parse(o.meta);s.infoHash&&(e[s.infoHash]||(e[s.infoHash]=0),e[s.infoHash]+=o.amount)}));let o=0;const s={},i=this.dp$incomeStatusMapper.FINISH;i&&i.forEach((t=>{const e=this.dp$incomeTxnDict[t];o+=e.amount;const i=JSON.parse(e.meta).infoHash;s[i]||(s[i]=0),s[i]+=e.amount}));return{todayIncome:t,todayTaskIncome:e,allIncome:o,allTaskIncome:s}},totalIncomeInfo(){return 2!==x["a"].state.credits.isModuleInit?this.$t("login_to_see_income"):this.$t("total_income_info",[Number((this.incomes.todayIncome/1e3).toFixed(3)),Number((this.incomes.allIncome/1e3).toFixed(3))])},disableTasks(){return!!x["a"].getters.shouldDisableTasks||!!x["a"].getters.settings.forceLogin&&(!x["a"].getters.accountUserInfo||!x["a"].getters.accountUserInfo.sub)},channelFollowable(){return!!this.channelPost&&!vt["a"].followingChannels.some((t=>{var e;return t&&t.id===(null===(e=this.channelPost.channel)||void 0===e?void 0:e.id)}))}},methods:{ensureLogin(t){if(this.disableTasks){if(!x["a"].state.account.authState)return;this.$amplify.showSignedOutDialog()}else"function"===typeof t&&t()},async setLoading(){this.loading=!0,await new Promise((t=>setTimeout(t,1e3))),this.loading=!1},toggleSearchText(t){this.showSearchText=t,t&&this.$nextTick((()=>{this.$refs.searchInput.focus()}))},filterTorrent(t){const e=this.searchText.toLowerCase();return t.filter((t=>t.name||t.postTitle?t.postTitle?t.postTitle.toLowerCase().includes(e):t.name.toLowerCase().includes(e):""===e))},clearSearch(){this.searchText="",this.$refs.searchInput.blur()},changeListMode(){"list"===this.listMode?this.listMode="card":this.listMode="list",localStorage.setItem("task-list-mode",this.listMode)},byteToLargerSize(t){return Object(q["a"])(t,{byte:!0,gb:!0})},getTorrentListName(t){let e="downloading";return t.isSeeding||t.uploading?e="uploading":t.pending?e="pending":1===t.progress||t.done?e="downloaded":t.paused&&(e="paused"),e},showMagnetDialog(t){this.$root.$emit("openTaskDialog",t)},showDetail(t){this.torrentDetailInfoHash=t.infoHash,this.showTorrentDetail=!0},hideDetail(){this.showTorrentDetail=!1,this.torrentDetailInfoHash=""},showAbPanel({infoHash:t}){this.abTorrentInfoHash=t,this.showAlphabizPanel=!0},async showPostInfo(t=""){if(console.log("show",t),!t||!t.includes("posts"))return this.$q.notify("Cannot find post");this.$q.loading.show();const e=t.replace(/\/posts\/([^/]+$)/,""),o=e.split("/").filter((t=>t)).pop(),s=t.split("/").filter((t=>t)).pop();let i=!1;setTimeout((()=>{i||(i=!0,this.$q.loading.hide(),this.$q.dialog({title:this.$t("error"),message:this.$t("cannot_get_channel_info"),ok:this.$t("ok")}))}),5e3);const n=await vt["a"].getPostById(o,s,!0);if(console.log("show post",n),i)return;const a=await vt["a"].getChannelById(o);if(console.log("show post channel",a),!i){if(i=!0,!n)return this.$q.loading.hide(),void this.$q.dialog({title:"Not Found",message:"Cannot found post info"});n.channel=a,this.channelPost=n,this.$q.loading.hide(),this.showChannelPost=!0}},toChannelPage(t){console.log("to",t);const e=["id","title"].map((e=>{const o=t[e];return encodeURIComponent(e)+"="+encodeURIComponent(o)})).join("&");this.$router.push(`/library/channel?${e}`),setTimeout((()=>{this.$root.$emit("navigate-to",`/library/channel?${e}`)}),200)},hideAbPanel(){this.showAlphabizPanel=!1,this.abTorrentInfoHash=""},showOriginTorrent(t){let e=t.token||t.origin;if(t.isSeeding||t.upload?e=t.magnetURI:t.magnetPath&&(e=t.magnetPath),!e)return this.$q.notify("origin_not_found");a.a.existsSync(e)?this.io.emit("show_torrent_file",e):(e.startsWith("magnet")||(e="magnet:?xt=urn:btih:"+t.infoHash),t.name&&(e+="&dn="+encodeURIComponent(t.name)),qt.writeText(e),this.$q.notify(this.$t("text_copied")))},showDirectory(t){if(!a.a.existsSync(t.path))return this.$q.notify(this.$t("path_missing"));if(t.files&&1===t.files.length&&a.a.existsSync(t.files[0].path))return this.io.emit("show_torrent_file",t.files[0].path);const e=l.a.resolve(t.path,t.postTitle||t.name||"");if(!a.a.existsSync(e))return this.io.emit("show_torrent_file",t.path);this.io.emit("show_torrent_file",e)},setAutoRenew(t,e){return Object($t["c"])(t,e),this.$set(this.autoRenew,t,e)},showPaymentPannel(t){this.paymentData=t,this.showPayment=!0},changeSortOption(t){this.sortOption=t},changeSortSequence(t){this.sortSequence=t},sortTorrents(t){const e=this.sortOption,o=e;switch(o){case"income":{const e=this.incomes.allTaskIncome;return[...t].sort(((t,o)=>e[t.infoHash]?e[o.infoHash]?(e[t.infoHash]-e[o.infoHash])*this.sortSequence:-1:e[o.infoHash]?1:0))}default:return t}},downloadAll(t=!1){if(console.log("download all!"),this.loading)return console.log("skip downloadAll since loading");this.setLoading(),Object(Tt["c"])(t)},async pauseAllDownloading(t=!1){if(!this.torrentList.downloading.length)return console.log("skip pause all downloading");console.log("pauseall"),this.setLoading(),Object(Tt["d"])(t)},requestPauseAllDownloading(){this.$q.dialog({title:this.$t("pause_all"),message:this.$t("pause_all_finish_payments"),ok:this.$t("pause_all"),cancel:this.$t("cancel")}).onOk((()=>{this.pauseAllDownloading()}))},removeAllDownloading(){const t=[];x["a"].getters.settings.defaultDeleteFiles&&t.push("deleteFiles"),this.$q.dialog({title:this.$t("delete_task"),message:this.$t("remove_all_downloading_tasks"),options:{type:"checkbox",model:t,items:[{label:this.$t("also_delete_files"),value:"deleteFiles"}]},ok:{textColor:"red",color:"unset",flat:!0,label:this.$t("remove_all")},cancel:this.$t("not_now")}).onOk((t=>{this.setLoading();const e=t.includes("deleteFiles");this.io.emit("delete_all","download",e);for(const o of this.downloadingTorrents)this.io.emit("delete_torrent",o.infoHash,e);x["a"].dispatch("updateSettings",{defaultDeleteFiles:e})}))},pauseAllUploading(t=!1){this.torrentList.uploading.length&&(this.setLoading(),Object(Tt["e"])(t))},removeAllUploading(){const t=[];x["a"].getters.settings.defaultDeleteFiles&&t.push("deleteFiles"),this.$q.dialog({title:this.$t("delete_task"),message:this.$t("remove_all_upload_tasks"),options:{type:"checkbox",model:t,items:[{label:this.$t("also_delete_files"),value:"deleteFiles"},{label:this.$t("remove_autoupload_files"),value:"deleteAutoUpload"}]},ok:{textColor:"red",color:"unset",flat:!0,label:this.$t("remove_all")},cancel:this.$t("not_now")}).onOk((t=>{this.setLoading();const e=t.includes("deleteFiles"),o=t.includes("deleteAutoUpload");this.io.emit("delete_all","upload",e,o),x["a"].dispatch("updateSettings",{defaultDeleteFiles:e})}))},async uploadAll(t=!1){const e=Object(Tt["h"])(t);if(console.log("rest",e),e<=this.downloadedTorrents.length)return void console.log("Skip watch: nothing to upload");this.loading=!0;let o=null;const s=new Promise((t=>o=t)),i=this.$watch("downloadedTorrents",(t=>{t.length<=e&&(i(),this.loading=!1,console.log("upload done"),o())}));return setTimeout((()=>{this.loading&&(this.loading=!1,i(),o())}),5e3),s},pauseTorrent(t){this.setLoading(),Object(Tt["f"])(t,this)},resumeTorrent(t){t&&this.ensureLogin((()=>{this.setLoading(),console.log("resume",t),this.io.emit("resume_torrent",t)}))},deleteTorrent(t){this.ensureLogin((()=>{St["a"].deleteTask(t)}))},clearAll(){this.ensureLogin((()=>{this.$q.dialog({title:this.$t("clear_history"),message:this.$t("remove_all_history"),ok:this.$t("remove_all"),cancel:this.$t("not_now")}).onOk((()=>{this.setLoading();for(const t of this.downloadedTorrents)this.io.emit("delete_torrent",t.infoHash)}))}))},startPayment(t,e=!1){Object($t["d"])(t,e)},async createPayment(t,e=!1){await Object($t["a"])(t,e,this),e||(this.showPayment=!1)},setThrottleGroup(t){this.io.emit("set_throttle_group",t)},saveTorrentFile(t){this.io.emit("save_torrent_file",t)},play(t,e){It&&(console.log("run play():"+e+", "+t),x["a"].dispatch("remotePlay",e),this.io.emit("play-torrent",{infoHash:e,filepath:t}))},showQuickStart(t){this.quickStartTask=t,this.showQuickStartDialog=!0},hideQuickStartDialog(){this.showQuickStartDialog=!1,this.quickStartTask=null}},created(){this.io.on("client_info",(t=>{this.info=t}))},mounted(){if(Object.keys(this.autoRenew).length)for(const t in this.autoRenew)Object($t["c"])(t,this.autoRenew[t])},beforeRouteEnter(t,e,o){if(console.log("before enter",t,e),"/downloader"!==t.path)return o();console.log("is downloader"),t.query.currentTab?(console.log("current tab:",t.query.currentTab),o((e=>{e.currentTab=t.query.currentTab}))):(console.log("not current tab",t.query),o({path:t.path,query:{...t.query,currentTab:"downloading"}}))},beforeRouteUpdate(t,e,o){console.log("before update",t,e),this.currentTab=t.query.currentTab,o()},watch:{autoRenew(t){localStorage.setItem("task-autorenew",JSON.stringify(t))}}},Ct=xt,Dt=(o("5c6b"),o("5f04"),o("9989")),Pt=o("e359"),Ot=o("65c6"),Lt=o("2c91"),At=o("27f9"),Ht=o("adad"),Qt=o("823b"),jt=o("de5e"),Nt=Object(g["a"])(Ct,s,i,!1,null,"af9cd090",null);e["default"]=Nt.exports;_()(Nt,"components",{QPage:Dt["a"],QHeader:Pt["a"],QToolbar:Ot["a"],QSpace:Lt["a"],QBtn:Q["a"],QInput:At["a"],QIcon:w["a"],QTooltip:dt["a"],QLinearProgress:H["a"],QTabPanels:Ht["a"],QTabPanel:Qt["a"],QPageSticky:jt["a"],QDialog:Y["a"]})},"5f04":function(t,e,o){"use strict";o("235c")},"6f4b":function(t,e,o){},"755b":function(t,e,o){"use strict";o("14ff")},"82b2":function(t,e,o){},b6d3:function(t,e,o){"use strict";o("064b")},f74a:function(t,e,o){"use strict";o("6f4b")}}]);