module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=117)}([function(e,t){e.exports=require("electron")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("winreg")},function(e,t){e.exports=require("path")},function(e,t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof global&&global)||function(){return this}()||Function("return this")()},function(e,t,n){var r=n(38),o=Function.prototype,s=o.bind,a=o.call,i=r&&s.bind(a,a);e.exports=r?function(e){return e&&i(e)}:function(e){return e&&function(){return a.apply(e,arguments)}}},function(e,t,n){var r=n(4),o=n(118),s=n(119),a=n(70),i=n(19),l=n(9),c=l("iterator"),u=l("toStringTag"),p=a.values,d=function(e,t){if(e){if(e[c]!==p)try{i(e,c,p)}catch(r){e[c]=p}if(e[u]||i(e,u,t),o[t])for(var n in a)if(e[n]!==a[n])try{i(e,n,a[n])}catch(r){e[n]=a[n]}}};for(var f in o)d(r[f]&&r[f].prototype,f);d(s,"DOMTokenList")},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t){e.exports=function(e){return"function"==typeof e}},function(e,t,n){var r=n(4),o=n(53),s=n(12),a=n(73),i=n(74),l=n(75),c=o("wks"),u=r.Symbol,p=u&&u["for"],d=l?u:u&&u.withoutSetter||a;e.exports=function(e){if(!s(c,e)||!i&&"string"!=typeof c[e]){var t="Symbol."+e;i&&s(u,e)?c[e]=u[e]:c[e]=l&&p?p(t):d(t)}return c[e]}},function(e,t,n){var r=n(4),o=n(16),s=r.String,a=r.TypeError;e.exports=function(e){if(o(e))return e;throw a(s(e)+" is not an object")}},function(e,t,n){var r=n(38),o=Function.prototype.call;e.exports=r?o.bind(o):function(){return o.apply(o,arguments)}},function(e,t,n){var r=n(5),o=n(32),s=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return s(o(e),t)}},function(e,t,n){var r=n(7);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t,n){var r=n(4),o=n(85).f,s=n(19),a=n(20),i=n(55),l=n(87),c=n(129);e.exports=function(e,t){var n,u,p,d,f,h,g=e.target,m=e.global,v=e.stat;if(u=m?r:v?r[g]||i(g,{}):(r[g]||{}).prototype,u)for(p in t){if(f=t[p],e.noTargetGet?(h=o(u,p),d=h&&h.value):d=u[p],n=c(m?p:g+(v?".":"#")+p,e.forced),!n&&void 0!==d){if(typeof f==typeof d)continue;l(f,d)}(e.sham||d&&d.sham)&&s(f,"sham",!0),a(u,p,f,e)}}},function(e,t,n){"use strict";var r=n(63),o=n(11),s=n(5),a=n(136),i=n(7),l=n(10),c=n(8),u=n(43),p=n(83),d=n(21),f=n(31),h=n(142),g=n(41),m=n(143),v=n(144),y=n(9),w=y("replace"),b=Math.max,S=Math.min,k=s([].concat),_=s([].push),x=s("".indexOf),U=s("".slice),C=function(e){return void 0===e?e:String(e)},T=function(){return"$0"==="a".replace(/./,"$0")}(),P=function(){return!!/./[w]&&""===/./[w]("a","$0")}(),A=!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));a("replace",(function(e,t,n){var s=P?"$":"$0";return[function(e,n){var r=f(this),s=void 0==e?void 0:g(e,w);return s?o(s,e,r,n):o(t,d(r),e,n)},function(e,o){var a=l(this),i=d(e);if("string"==typeof o&&-1===x(o,s)&&-1===x(o,"$<")){var f=n(t,a,i,o);if(f.done)return f.value}var g=c(o);g||(o=d(o));var y=a.global;if(y){var w=a.unicode;a.lastIndex=0}var T=[];while(1){var P=v(a,i);if(null===P)break;if(_(T,P),!y)break;var A=d(P[0]);""===A&&(a.lastIndex=h(i,p(a.lastIndex),w))}for(var O="",R=0,E=0;E<T.length;E++){P=T[E];for(var L=d(P[0]),j=b(S(u(P.index),i.length),0),I=[],M=1;M<P.length;M++)_(I,C(P[M]));var D=P.groups;if(g){var H=k([L],I,j,i);void 0!==D&&_(H,D);var $=d(r(o,void 0,H))}else $=m(L,i,j,I,D,o);j>=R&&(O+=U(i,R,j)+$,R=j+L.length)}return O+U(i,R)}]}),!A||!T||P)},function(e,t,n){var r=n(8);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},function(e,t,n){var r=n(4),o=n(8),s=function(e){return o(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?s(r[e]):r[e]&&r[e][t]}},function(e,t){const n=["udp://open.tracker.cl:1337/announce","udp://tracker.opentrackr.org:1337/announce","udp://9.rarbg.com:2810/announce","udp://tracker.openbittorrent.com:6969/announce","udp://exodus.desync.com:6969/announce","udp://www.torrent.eu.org:451/announce","udp://tracker1.bt.moack.co.kr:80/announce","udp://tracker.zerobytes.xyz:1337/announce","udp://tracker.torrent.eu.org:451/announce","udp://tracker.theoks.net:6969/announce","udp://tracker.srv00.com:6969/announce","udp://tracker.pomf.se:80/announce","udp://tracker.ololosh.space:6969/announce","udp://tracker.monitorit4.me:6969/announce","udp://tracker.moeking.me:6969/announce","udp://tracker.lelux.fi:6969/announce","udp://tracker.jordan.im:6969/announce","udp://tracker-udp.gbitt.info:80/announce","udp://retracker.sevstar.net:2710/announce","udp://retracker.netbynet.ru:2710/announce","udp://186.10.181.71:1337/announce","udp://93.158.213.92:1337/announce","udp://151.80.120.113:2810/announce","udp://45.154.253.6:6969/announce","udp://208.83.20.20:6969/announce","udp://91.216.110.52:451/announce","udp://156.234.201.18:80/announce","udp://62.210.217.207:1337/announce","udp://89.234.156.205:451/announce","udp://209.141.59.16:6969/announce","udp://62.109.31.95:6969/announce","udp://65.108.63.133:80/announce","udp://93.104.214.40:6969/announce","udp://163.172.170.127:6969/announce","udp://95.217.161.135:6969/announce","udp://213.108.105.23:6969/announce","udp://109.72.83.209:80/announce","udp://78.30.254.12:2710/announce","udp://212.1.226.176:2710/announce","udp://tracker.leechers-paradise.org:6969","udp://tracker.coppersurfer.tk:6969","udp://tracker.opentrackr.org:1337","udp://explodie.org:6969","udp://tracker.empire-js.us:1337","wss://tracker.btorrent.xyz","wss://tracker.openwebtorrent.com"],r=e=>n.indexOf(e),o=e=>n[e];e.exports={getTrackerById:o,getIdByTracker:r,trackerList:n}},function(e,t,n){var r=n(13),o=n(26),s=n(29);e.exports=r?function(e,t,n){return o.f(e,t,s(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(4),o=n(8),s=n(12),a=n(19),i=n(55),l=n(60),c=n(28),u=n(61).CONFIGURABLE,p=c.get,d=c.enforce,f=String(String).split("String");(e.exports=function(e,t,n,l){var c,p=!!l&&!!l.unsafe,h=!!l&&!!l.enumerable,g=!!l&&!!l.noTargetGet,m=l&&void 0!==l.name?l.name:t;o(n)&&("Symbol("===String(m).slice(0,7)&&(m="["+String(m).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!s(n,"name")||u&&n.name!==m)&&a(n,"name",m),c=d(n),c.source||(c.source=f.join("string"==typeof m?m:""))),e!==r?(p?!g&&e[t]&&(h=!0):delete e[t],h?e[t]=n:a(e,t,n)):h?e[t]=n:i(t,n)})(Function.prototype,"toString",(function(){return o(this)&&p(this).source||l(this)}))},function(e,t,n){var r=n(4),o=n(49),s=r.String;e.exports=function(e){if("Symbol"===o(e))throw TypeError("Cannot convert a Symbol value to a string");return s(e)}},function(e,t){e.exports=require("axios")},function(e,t){e.exports=require("semver")},function(e,t){function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t){e.exports=!1},function(e,t,n){var r=n(4),o=n(13),s=n(78),a=n(77),i=n(10),l=n(56),c=r.TypeError,u=Object.defineProperty,p=Object.getOwnPropertyDescriptor,d="enumerable",f="configurable",h="writable";t.f=o?a?function(e,t,n){if(i(e),t=l(t),i(n),"function"===typeof e&&"prototype"===t&&"value"in n&&h in n&&!n[h]){var r=p(e,t);r&&r[h]&&(e[t]=n.value,n={configurable:f in n?n[f]:r[f],enumerable:d in n?n[d]:r[d],writable:!1})}return u(e,t,n)}:u:function(e,t,n){if(i(e),t=l(t),i(n),s)try{return u(e,t,n)}catch(r){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t){e.exports=require("os")},function(e,t,n){var r,o,s,a=n(126),i=n(4),l=n(5),c=n(16),u=n(19),p=n(12),d=n(54),f=n(59),h=n(57),g="Object already initialized",m=i.TypeError,v=i.WeakMap,y=function(e){return s(e)?o(e):r(e,{})},w=function(e){return function(t){var n;if(!c(t)||(n=o(t)).type!==e)throw m("Incompatible receiver, "+e+" required");return n}};if(a||d.state){var b=d.state||(d.state=new v),S=l(b.get),k=l(b.has),_=l(b.set);r=function(e,t){if(k(b,e))throw new m(g);return t.facade=e,_(b,e,t),t},o=function(e){return S(b,e)||{}},s=function(e){return k(b,e)}}else{var x=f("state");h[x]=!0,r=function(e,t){if(p(e,x))throw new m(g);return t.facade=e,u(e,x,t),t},o=function(e){return p(e,x)?e[x]:{}},s=function(e){return p(e,x)}}e.exports={set:r,get:o,has:s,enforce:y,getterFor:w}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(71),o=n(31);e.exports=function(e){return r(o(e))}},function(e,t,n){var r=n(4),o=r.TypeError;e.exports=function(e){if(void 0==e)throw o("Can't call method on "+e);return e}},function(e,t,n){var r=n(4),o=n(31),s=r.Object;e.exports=function(e){return s(o(e))}},function(e,t,n){var r,o=n(10),s=n(76),a=n(58),i=n(57),l=n(125),c=n(52),u=n(59),p=">",d="<",f="prototype",h="script",g=u("IE_PROTO"),m=function(){},v=function(e){return d+h+p+e+d+"/"+h+p},y=function(e){e.write(v("")),e.close();var t=e.parentWindow.Object;return e=null,t},w=function(){var e,t=c("iframe"),n="java"+h+":";return t.style.display="none",l.appendChild(t),t.src=String(n),e=t.contentWindow.document,e.open(),e.write(v("document.F=Object")),e.close(),e.F},b=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}b="undefined"!=typeof document?document.domain&&r?y(r):w():y(r);var e=a.length;while(e--)delete b[f][a[e]];return b()};i[g]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(m[f]=o(e),n=new m,m[f]=null,n[g]=e):n=b(),void 0===t?n:s.f(n,t)}},function(e,t,n){var r=n(4),o=n(8),s=n(42),a=r.TypeError;e.exports=function(e){if(o(e))return e;throw a(s(e)+" is not a function")}},function(e,t){e.exports={}},function(e,t,n){var r=n(14),o=n(4),s=n(63),a=n(149),i="WebAssembly",l=o[i],c=7!==Error("e",{cause:7}).cause,u=function(e,t){var n={};n[e]=a(e,t,c),r({global:!0,forced:c},n)},p=function(e,t){if(l&&l[e]){var n={};n[e]=a(i+"."+e,t,c),r({target:i,stat:!0,forced:c},n)}};u("Error",(function(e){return function(t){return s(e,this,arguments)}})),u("EvalError",(function(e){return function(t){return s(e,this,arguments)}})),u("RangeError",(function(e){return function(t){return s(e,this,arguments)}})),u("ReferenceError",(function(e){return function(t){return s(e,this,arguments)}})),u("SyntaxError",(function(e){return function(t){return s(e,this,arguments)}})),u("TypeError",(function(e){return function(t){return s(e,this,arguments)}})),u("URIError",(function(e){return function(t){return s(e,this,arguments)}})),p("CompileError",(function(e){return function(t){return s(e,this,arguments)}})),p("LinkError",(function(e){return function(t){return s(e,this,arguments)}})),p("RuntimeError",(function(e){return function(t){return s(e,this,arguments)}}))},function(e,t){e.exports=function(e){try{if(Array.isArray(e))return console.log("array",e),!0;if(e[0])return console.log("arr",e),!0}catch(t){return console.error(t),!1}return!1}},function(e,t,n){var r=n(7);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},function(e,t,n){var r=n(5),o=r({}.toString),s=r("".slice);e.exports=function(e){return s(o(e),8,-1)}},function(e,t,n){var r=n(5);e.exports=r({}.isPrototypeOf)},function(e,t,n){var r=n(34);e.exports=function(e,t){var n=e[t];return null==n?void 0:r(n)}},function(e,t,n){var r=n(4),o=r.String;e.exports=function(e){try{return o(e)}catch(t){return"Object"}}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){var t=+e;return t!==t||0===t?0:(t>0?r:n)(t)}},function(e,t,n){var r=n(83);e.exports=function(e){return r(e.length)}},function(e,t,n){var r=n(26).f,o=n(12),s=n(9),a=s("toStringTag");e.exports=function(e,t,n){e&&!n&&(e=e.prototype),e&&!o(e,a)&&r(e,a,{configurable:!0,value:t})}},function(e,t,n){var r=n(14),o=n(4),s=n(17),a=n(63),i=n(5),l=n(7),c=o.Array,u=s("JSON","stringify"),p=i(/./.exec),d=i("".charAt),f=i("".charCodeAt),h=i("".replace),g=i(1..toString),m=/[\uD800-\uDFFF]/g,v=/^[\uD800-\uDBFF]$/,y=/^[\uDC00-\uDFFF]$/,w=function(e,t,n){var r=d(n,t-1),o=d(n,t+1);return p(v,e)&&!p(y,o)||p(y,e)&&!p(v,r)?"\\u"+g(f(e,0),16):e},b=l((function(){return'"\\udf06\\ud834"'!==u("\udf06\ud834")||'"\\udead"'!==u("\udead")}));u&&r({target:"JSON",stat:!0,forced:b},{stringify:function(e,t,n){for(var r=0,o=arguments.length,s=c(o);r<o;r++)s[r]=arguments[r];var i=a(u,null,s);return"string"==typeof i?h(i,m,w):i}})},function(e,t,n){var r=n(5),o=n(34),s=n(38),a=r(r.bind);e.exports=function(e,t){return o(e),void 0===t?e:s?a(e,t):function(){return e.apply(t,arguments)}}},function(e,t,n){var r=n(49),o=n(41),s=n(35),a=n(9),i=a("iterator");e.exports=function(e){if(void 0!=e)return o(e,i)||o(e,"@@iterator")||s[r(e)]}},function(e,t,n){var r=n(4),o=n(135),s=n(8),a=n(39),i=n(9),l=i("toStringTag"),c=r.Object,u="Arguments"==a(function(){return arguments}()),p=function(e,t){try{return e[t]}catch(n){}};e.exports=o?a:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=p(t=c(e),l))?n:u?a(t):"Object"==(r=a(t))&&s(t.callee)?"Arguments":r}},function(e,t){e.exports=require("worker_threads")},function(e,t){e.exports=require("url")},function(e,t,n){var r=n(4),o=n(16),s=r.document,a=o(s)&&o(s.createElement);e.exports=function(e){return a?s.createElement(e):{}}},function(e,t,n){var r=n(25),o=n(54);(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.21.1",mode:r?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(e,t,n){var r=n(4),o=n(55),s="__core-js_shared__",a=r[s]||o(s,{});e.exports=a},function(e,t,n){var r=n(4),o=Object.defineProperty;e.exports=function(e,t){try{o(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},function(e,t,n){var r=n(122),o=n(79);e.exports=function(e){var t=r(e,"string");return o(t)?t:t+""}},function(e,t){e.exports={}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t,n){var r=n(53),o=n(73),s=r("keys");e.exports=function(e){return s[e]||(s[e]=o(e))}},function(e,t,n){var r=n(5),o=n(8),s=n(54),a=r(Function.toString);o(s.inspectSource)||(s.inspectSource=function(e){return a(e)}),e.exports=s.inspectSource},function(e,t,n){var r=n(13),o=n(12),s=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,i=o(s,"name"),l=i&&"something"===function(){}.name,c=i&&(!r||r&&a(s,"name").configurable);e.exports={EXISTS:i,PROPER:l,CONFIGURABLE:c}},function(e,t,n){var r=n(5),o=n(10),s=n(131);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),e(n,[]),t=n instanceof Array}catch(a){}return function(n,r){return o(n),s(r),t?e(n,r):n.__proto__=r,n}}():void 0)},function(e,t,n){var r=n(38),o=Function.prototype,s=o.apply,a=o.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?a.bind(s):function(){return a.apply(s,arguments)})},function(e,t,n){var r=n(4),o=n(11),s=n(34),a=n(10),i=n(42),l=n(48),c=r.TypeError;e.exports=function(e,t){var n=arguments.length<2?l(e):t;if(s(n))return a(o(n,e));throw c(i(e)+" is not iterable")}},function(e,t,n){"use strict";var r=n(11),o=n(5),s=n(21),a=n(138),i=n(139),l=n(53),c=n(33),u=n(28).get,p=n(140),d=n(141),f=l("native-string-replace",String.prototype.replace),h=RegExp.prototype.exec,g=h,m=o("".charAt),v=o("".indexOf),y=o("".replace),w=o("".slice),b=function(){var e=/a/,t=/b*/g;return r(h,e,"a"),r(h,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),S=i.BROKEN_CARET,k=void 0!==/()??/.exec("")[1],_=b||k||S||p||d;_&&(g=function(e){var t,n,o,i,l,p,d,_=this,x=u(_),U=s(e),C=x.raw;if(C)return C.lastIndex=_.lastIndex,t=r(g,C,U),_.lastIndex=C.lastIndex,t;var T=x.groups,P=S&&_.sticky,A=r(a,_),O=_.source,R=0,E=U;if(P&&(A=y(A,"y",""),-1===v(A,"g")&&(A+="g"),E=w(U,_.lastIndex),_.lastIndex>0&&(!_.multiline||_.multiline&&"\n"!==m(U,_.lastIndex-1))&&(O="(?: "+O+")",E=" "+E,R++),n=new RegExp("^(?:"+O+")",A)),k&&(n=new RegExp("^"+O+"$(?!\\s)",A)),b&&(o=_.lastIndex),i=r(h,P?n:_,E),P?i?(i.input=w(i.input,R),i[0]=w(i[0],R),i.index=_.lastIndex,_.lastIndex+=i[0].length):_.lastIndex=0:b&&i&&(_.lastIndex=_.global?i.index+i[0].length:o),k&&i&&i.length>1&&r(f,i[0],n,(function(){for(l=1;l<arguments.length-2;l++)void 0===arguments[l]&&(i[l]=void 0)})),i&&T)for(i.groups=p=c(null),l=0;l<T.length;l++)d=T[l],p[d[0]]=i[d[1]];return i}),e.exports=g},function(e,t,n){var r=n(5),o=n(43),s=n(21),a=n(31),i=r("".charAt),l=r("".charCodeAt),c=r("".slice),u=function(e){return function(t,n){var r,u,p=s(a(t)),d=o(n),f=p.length;return d<0||d>=f?e?"":void 0:(r=l(p,d),r<55296||r>56319||d+1===f||(u=l(p,d+1))<56320||u>57343?e?i(p,d):r:e?c(p,d,d+2):u-56320+(r-55296<<10)+65536)}};e.exports={codeAt:u(!1),charAt:u(!0)}},function(e,t,n){"use strict";n(70);var r=n(14),o=n(4),s=n(17),a=n(11),i=n(5),l=n(99),c=n(20),u=n(167),p=n(45),d=n(89),f=n(28),h=n(100),g=n(8),m=n(12),v=n(47),y=n(49),w=n(10),b=n(16),S=n(21),k=n(33),_=n(29),x=n(64),U=n(48),C=n(103),T=n(9),P=n(168),A=T("iterator"),O="URLSearchParams",R=O+"Iterator",E=f.set,L=f.getterFor(O),j=f.getterFor(R),I=s("fetch"),M=s("Request"),D=s("Headers"),H=M&&M.prototype,$=D&&D.prototype,F=o.RegExp,z=o.TypeError,q=o.decodeURIComponent,B=o.encodeURIComponent,N=i("".charAt),W=i([].join),G=i([].push),K=i("".replace),V=i([].shift),J=i([].splice),Z=i("".split),Q=i("".slice),Y=/\+/g,X=Array(4),ee=function(e){return X[e-1]||(X[e-1]=F("((?:%[\\da-f]{2}){"+e+"})","gi"))},te=function(e){try{return q(e)}catch(t){return e}},ne=function(e){var t=K(e,Y," "),n=4;try{return q(t)}catch(r){while(n)t=K(t,ee(n--),te);return t}},re=/[!'()~]|%20/g,oe={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},se=function(e){return oe[e]},ae=function(e){return K(B(e),re,se)},ie=d((function(e,t){E(this,{type:R,iterator:x(L(e).entries),kind:t})}),"Iterator",(function(){var e=j(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n}),!0),le=function(e){this.entries=[],this.url=null,void 0!==e&&(b(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===N(e,0)?Q(e,1):e:S(e)))};le.prototype={type:O,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,r,o,s,i,l,c=U(e);if(c){t=x(e,c),n=t.next;while(!(r=a(n,t)).done){if(o=x(w(r.value)),s=o.next,(i=a(s,o)).done||(l=a(s,o)).done||!a(s,o).done)throw z("Expected sequence with length 2");G(this.entries,{key:S(i.value),value:S(l.value)})}}else for(var u in e)m(e,u)&&G(this.entries,{key:u,value:S(e[u])})},parseQuery:function(e){if(e){var t,n,r=Z(e,"&"),o=0;while(o<r.length)t=r[o++],t.length&&(n=Z(t,"="),G(this.entries,{key:ne(V(n)),value:ne(W(n,"="))}))}},serialize:function(){var e,t=this.entries,n=[],r=0;while(r<t.length)e=t[r++],G(n,ae(e.key)+"="+ae(e.value));return W(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var ce=function(){h(this,ue);var e=arguments.length>0?arguments[0]:void 0;E(this,new le(e))},ue=ce.prototype;if(u(ue,{append:function(e,t){C(arguments.length,2);var n=L(this);G(n.entries,{key:S(e),value:S(t)}),n.updateURL()},delete:function(e){C(arguments.length,1);var t=L(this),n=t.entries,r=S(e),o=0;while(o<n.length)n[o].key===r?J(n,o,1):o++;t.updateURL()},get:function(e){C(arguments.length,1);for(var t=L(this).entries,n=S(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){C(arguments.length,1);for(var t=L(this).entries,n=S(e),r=[],o=0;o<t.length;o++)t[o].key===n&&G(r,t[o].value);return r},has:function(e){C(arguments.length,1);var t=L(this).entries,n=S(e),r=0;while(r<t.length)if(t[r++].key===n)return!0;return!1},set:function(e,t){C(arguments.length,1);for(var n,r=L(this),o=r.entries,s=!1,a=S(e),i=S(t),l=0;l<o.length;l++)n=o[l],n.key===a&&(s?J(o,l--,1):(s=!0,n.value=i));s||G(o,{key:a,value:i}),r.updateURL()},sort:function(){var e=L(this);P(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){var t,n=L(this).entries,r=v(e,arguments.length>1?arguments[1]:void 0),o=0;while(o<n.length)t=n[o++],r(t.value,t.key,this)},keys:function(){return new ie(this,"keys")},values:function(){return new ie(this,"values")},entries:function(){return new ie(this,"entries")}},{enumerable:!0}),c(ue,A,ue.entries,{name:"entries"}),c(ue,"toString",(function(){return L(this).serialize()}),{enumerable:!0}),p(ce,O),r({global:!0,forced:!l},{URLSearchParams:ce}),!l&&g(D)){var pe=i($.has),de=i($.set),fe=function(e){if(b(e)){var t,n=e.body;if(y(n)===O)return t=e.headers?new D(e.headers):new D,pe(t,"content-type")||de(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),k(e,{body:_(0,S(n)),headers:_(0,t)})}return e};if(g(I)&&r({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return I(e,arguments.length>1?fe(arguments[1]):{})}}),g(M)){var he=function(e){return h(this,H),new M(e,arguments.length>1?fe(arguments[1]):{})};H.constructor=he,he.prototype=H,r({global:!0,forced:!0},{Request:he})}}e.exports={URLSearchParams:ce,getState:L}},function(e,t){e.exports=require("electron-store")},function(e,t){e.exports=require("ping")},function(e,t,n){"use strict";var r=n(30),o=n(72),s=n(35),a=n(28),i=n(26).f,l=n(84),c=n(25),u=n(13),p="Array Iterator",d=a.set,f=a.getterFor(p);e.exports=l(Array,"Array",(function(e,t){d(this,{type:p,target:r(e),index:0,kind:t})}),(function(){var e=f(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");var h=s.Arguments=s.Array;if(o("keys"),o("values"),o("entries"),!c&&u&&"values"!==h.name)try{i(h,"name",{value:"values"})}catch(g){}},function(e,t,n){var r=n(4),o=n(5),s=n(7),a=n(39),i=r.Object,l=o("".split);e.exports=s((function(){return!i("z").propertyIsEnumerable(0)}))?function(e){return"String"==a(e)?l(e,""):i(e)}:i},function(e,t,n){var r=n(9),o=n(33),s=n(26),a=r("unscopables"),i=Array.prototype;void 0==i[a]&&s.f(i,a,{configurable:!0,value:o(null)}),e.exports=function(e){i[a][e]=!0}},function(e,t,n){var r=n(5),o=0,s=Math.random(),a=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++o+s,36)}},function(e,t,n){var r=n(120),o=n(7);e.exports=!!Object.getOwnPropertySymbols&&!o((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},function(e,t,n){var r=n(74);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,n){var r=n(13),o=n(77),s=n(26),a=n(10),i=n(30),l=n(80);t.f=r&&!o?Object.defineProperties:function(e,t){a(e);var n,r=i(t),o=l(t),c=o.length,u=0;while(c>u)s.f(e,n=o[u++],r[n]);return e}},function(e,t,n){var r=n(13),o=n(7);e.exports=r&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(e,t,n){var r=n(13),o=n(7),s=n(52);e.exports=!r&&!o((function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(4),o=n(17),s=n(8),a=n(40),i=n(75),l=r.Object;e.exports=i?function(e){return"symbol"==typeof e}:function(e){var t=o("Symbol");return s(t)&&a(t.prototype,l(e))}},function(e,t,n){var r=n(81),o=n(58);e.exports=Object.keys||function(e){return r(e,o)}},function(e,t,n){var r=n(5),o=n(12),s=n(30),a=n(124).indexOf,i=n(57),l=r([].push);e.exports=function(e,t){var n,r=s(e),c=0,u=[];for(n in r)!o(i,n)&&o(r,n)&&l(u,n);while(t.length>c)o(r,n=t[c++])&&(~a(u,n)||l(u,n));return u}},function(e,t,n){var r=n(43),o=Math.max,s=Math.min;e.exports=function(e,t){var n=r(e);return n<0?o(n+t,0):s(n,t)}},function(e,t,n){var r=n(43),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},function(e,t,n){"use strict";var r=n(14),o=n(11),s=n(25),a=n(61),i=n(8),l=n(89),c=n(91),u=n(62),p=n(45),d=n(19),f=n(20),h=n(9),g=n(35),m=n(90),v=a.PROPER,y=a.CONFIGURABLE,w=m.IteratorPrototype,b=m.BUGGY_SAFARI_ITERATORS,S=h("iterator"),k="keys",_="values",x="entries",U=function(){return this};e.exports=function(e,t,n,a,h,m,C){l(n,t,a);var T,P,A,O=function(e){if(e===h&&I)return I;if(!b&&e in L)return L[e];switch(e){case k:return function(){return new n(this,e)};case _:return function(){return new n(this,e)};case x:return function(){return new n(this,e)}}return function(){return new n(this)}},R=t+" Iterator",E=!1,L=e.prototype,j=L[S]||L["@@iterator"]||h&&L[h],I=!b&&j||O(h),M="Array"==t&&L.entries||j;if(M&&(T=c(M.call(new e)),T!==Object.prototype&&T.next&&(s||c(T)===w||(u?u(T,w):i(T[S])||f(T,S,U)),p(T,R,!0,!0),s&&(g[R]=U))),v&&h==_&&j&&j.name!==_&&(!s&&y?d(L,"name",_):(E=!0,I=function(){return o(j,this)})),h)if(P={values:O(_),keys:m?I:O(k),entries:O(x)},C)for(A in P)(b||E||!(A in L))&&f(L,A,P[A]);else r({target:t,proto:!0,forced:b||E},P);return s&&!C||L[S]===I||f(L,S,I,{name:h}),g[t]=I,P}},function(e,t,n){var r=n(13),o=n(11),s=n(86),a=n(29),i=n(30),l=n(56),c=n(12),u=n(78),p=Object.getOwnPropertyDescriptor;t.f=r?p:function(e,t){if(e=i(e),t=l(t),u)try{return p(e,t)}catch(n){}if(c(e,t))return a(!o(s.f,e,t),e[t])}},function(e,t,n){"use strict";var r={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,s=o&&!r.call({1:2},1);t.f=s?function(e){var t=o(this,e);return!!t&&t.enumerable}:r},function(e,t,n){var r=n(12),o=n(127),s=n(85),a=n(26);e.exports=function(e,t,n){for(var i=o(t),l=a.f,c=s.f,u=0;u<i.length;u++){var p=i[u];r(e,p)||n&&r(n,p)||l(e,p,c(t,p))}}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){"use strict";var r=n(90).IteratorPrototype,o=n(33),s=n(29),a=n(45),i=n(35),l=function(){return this};e.exports=function(e,t,n,c){var u=t+" Iterator";return e.prototype=o(r,{next:s(+!c,n)}),a(e,u,!1,!0),i[u]=l,e}},function(e,t,n){"use strict";var r,o,s,a=n(7),i=n(8),l=n(33),c=n(91),u=n(20),p=n(9),d=n(25),f=p("iterator"),h=!1;[].keys&&(s=[].keys(),"next"in s?(o=c(c(s)),o!==Object.prototype&&(r=o)):h=!0);var g=void 0==r||a((function(){var e={};return r[f].call(e)!==e}));g?r={}:d&&(r=l(r)),i(r[f])||u(r,f,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:h}},function(e,t,n){var r=n(4),o=n(12),s=n(8),a=n(32),i=n(59),l=n(130),c=i("IE_PROTO"),u=r.Object,p=u.prototype;e.exports=l?u.getPrototypeOf:function(e){var t=a(e);if(o(t,c))return t[c];var n=t.constructor;return s(n)&&t instanceof n?n.prototype:t instanceof u?p:null}},function(e,t,n){"use strict";var r=n(34),o=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new o(e)}},function(e,t,n){var r=n(9),o=n(35),s=r("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||a[s]===e)}},function(e,t,n){var r=n(11),o=n(10),s=n(41);e.exports=function(e,t,n){var a,i;o(e);try{if(a=s(e,"return"),!a){if("throw"===t)throw n;return n}a=r(a,e)}catch(l){i=!0,a=l}if("throw"===t)throw n;if(i)throw a;return o(a),n}},function(e,t,n){"use strict";var r=n(14),o=n(145).trim,s=n(146);r({target:"String",proto:!0,forced:s("trim")},{trim:function(){return o(this)}})},function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},function(e,t,n){var r=n(5),o=n(7),s=n(8),a=n(49),i=n(17),l=n(60),c=function(){},u=[],p=i("Reflect","construct"),d=/^\s*(?:class|function)\b/,f=r(d.exec),h=!d.exec(c),g=function(e){if(!s(e))return!1;try{return p(c,u,e),!0}catch(t){return!1}},m=function(e){if(!s(e))return!1;switch(a(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return h||!!f(d,l(e))}catch(t){return!0}};m.sham=!0,e.exports=!p||o((function(){var e;return g(g.call)||!g(Object)||!g((function(){e=!0}))||e}))?m:g},function(e,t,n){"use strict";n(162);var r,o=n(14),s=n(13),a=n(99),i=n(4),l=n(47),c=n(5),u=n(76).f,p=n(20),d=n(100),f=n(12),h=n(163),g=n(164),m=n(102),v=n(66).codeAt,y=n(166),w=n(21),b=n(45),S=n(103),k=n(67),_=n(28),x=_.set,U=_.getterFor("URL"),C=k.URLSearchParams,T=k.getState,P=i.URL,A=i.TypeError,O=i.parseInt,R=Math.floor,E=Math.pow,L=c("".charAt),j=c(/./.exec),I=c([].join),M=c(1..toString),D=c([].pop),H=c([].push),$=c("".replace),F=c([].shift),z=c("".split),q=c("".slice),B=c("".toLowerCase),N=c([].unshift),W="Invalid authority",G="Invalid scheme",K="Invalid host",V="Invalid port",J=/[a-z]/i,Z=/[\d+-.a-z]/i,Q=/\d/,Y=/^0x/i,X=/^[0-7]+$/,ee=/^\d+$/,te=/^[\da-f]+$/i,ne=/[\0\t\n\r #%/:<>?@[\\\]^|]/,re=/[\0\t\n\r #/:<>?@[\\\]^|]/,oe=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,se=/[\t\n\r]/g,ae=function(e){var t,n,r,o,s,a,i,l=z(e,".");if(l.length&&""==l[l.length-1]&&l.length--,t=l.length,t>4)return e;for(n=[],r=0;r<t;r++){if(o=l[r],""==o)return e;if(s=10,o.length>1&&"0"==L(o,0)&&(s=j(Y,o)?16:8,o=q(o,8==s?1:2)),""===o)a=0;else{if(!j(10==s?ee:8==s?X:te,o))return e;a=O(o,s)}H(n,a)}for(r=0;r<t;r++)if(a=n[r],r==t-1){if(a>=E(256,5-t))return null}else if(a>255)return null;for(i=D(n),r=0;r<n.length;r++)i+=n[r]*E(256,3-r);return i},ie=function(e){var t,n,r,o,s,a,i,l=[0,0,0,0,0,0,0,0],c=0,u=null,p=0,d=function(){return L(e,p)};if(":"==d()){if(":"!=L(e,1))return;p+=2,c++,u=c}while(d()){if(8==c)return;if(":"!=d()){t=n=0;while(n<4&&j(te,d()))t=16*t+O(d(),16),p++,n++;if("."==d()){if(0==n)return;if(p-=n,c>6)return;r=0;while(d()){if(o=null,r>0){if(!("."==d()&&r<4))return;p++}if(!j(Q,d()))return;while(j(Q,d())){if(s=O(d(),10),null===o)o=s;else{if(0==o)return;o=10*o+s}if(o>255)return;p++}l[c]=256*l[c]+o,r++,2!=r&&4!=r||c++}if(4!=r)return;break}if(":"==d()){if(p++,!d())return}else if(d())return;l[c++]=t}else{if(null!==u)return;p++,c++,u=c}}if(null!==u){a=c-u,c=7;while(0!=c&&a>0)i=l[c],l[c--]=l[u+a-1],l[u+--a]=i}else if(8!=c)return;return l},le=function(e){for(var t=null,n=1,r=null,o=0,s=0;s<8;s++)0!==e[s]?(o>n&&(t=r,n=o),r=null,o=0):(null===r&&(r=s),++o);return o>n&&(t=r,n=o),t},ce=function(e){var t,n,r,o;if("number"==typeof e){for(t=[],n=0;n<4;n++)N(t,e%256),e=R(e/256);return I(t,".")}if("object"==typeof e){for(t="",r=le(e),n=0;n<8;n++)o&&0===e[n]||(o&&(o=!1),r===n?(t+=n?":":"::",o=!0):(t+=M(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},ue={},pe=h({},ue,{" ":1,'"':1,"<":1,">":1,"`":1}),de=h({},pe,{"#":1,"?":1,"{":1,"}":1}),fe=h({},de,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),he=function(e,t){var n=v(e,0);return n>32&&n<127&&!f(t,e)?e:encodeURIComponent(e)},ge={ftp:21,file:null,http:80,https:443,ws:80,wss:443},me=function(e,t){var n;return 2==e.length&&j(J,L(e,0))&&(":"==(n=L(e,1))||!t&&"|"==n)},ve=function(e){var t;return e.length>1&&me(q(e,0,2))&&(2==e.length||"/"===(t=L(e,2))||"\\"===t||"?"===t||"#"===t)},ye=function(e){return"."===e||"%2e"===B(e)},we=function(e){return e=B(e),".."===e||"%2e."===e||".%2e"===e||"%2e%2e"===e},be={},Se={},ke={},_e={},xe={},Ue={},Ce={},Te={},Pe={},Ae={},Oe={},Re={},Ee={},Le={},je={},Ie={},Me={},De={},He={},$e={},Fe={},ze=function(e,t,n){var r,o,s,a=w(e);if(t){if(o=this.parse(a),o)throw A(o);this.searchParams=null}else{if(void 0!==n&&(r=new ze(n,!0)),o=this.parse(a,null,r),o)throw A(o);s=T(new C),s.bindURL(this),this.searchParams=s}};ze.prototype={type:"URL",parse:function(e,t,n){var o,s,a,i,l=this,c=t||be,u=0,p="",d=!1,h=!1,v=!1;e=w(e),t||(l.scheme="",l.username="",l.password="",l.host=null,l.port=null,l.path=[],l.query=null,l.fragment=null,l.cannotBeABaseURL=!1,e=$(e,oe,"")),e=$(e,se,""),o=g(e);while(u<=o.length){switch(s=o[u],c){case be:if(!s||!j(J,s)){if(t)return G;c=ke;continue}p+=B(s),c=Se;break;case Se:if(s&&(j(Z,s)||"+"==s||"-"==s||"."==s))p+=B(s);else{if(":"!=s){if(t)return G;p="",c=ke,u=0;continue}if(t&&(l.isSpecial()!=f(ge,p)||"file"==p&&(l.includesCredentials()||null!==l.port)||"file"==l.scheme&&!l.host))return;if(l.scheme=p,t)return void(l.isSpecial()&&ge[l.scheme]==l.port&&(l.port=null));p="","file"==l.scheme?c=Le:l.isSpecial()&&n&&n.scheme==l.scheme?c=_e:l.isSpecial()?c=Te:"/"==o[u+1]?(c=xe,u++):(l.cannotBeABaseURL=!0,H(l.path,""),c=He)}break;case ke:if(!n||n.cannotBeABaseURL&&"#"!=s)return G;if(n.cannotBeABaseURL&&"#"==s){l.scheme=n.scheme,l.path=m(n.path),l.query=n.query,l.fragment="",l.cannotBeABaseURL=!0,c=Fe;break}c="file"==n.scheme?Le:Ue;continue;case _e:if("/"!=s||"/"!=o[u+1]){c=Ue;continue}c=Pe,u++;break;case xe:if("/"==s){c=Ae;break}c=De;continue;case Ue:if(l.scheme=n.scheme,s==r)l.username=n.username,l.password=n.password,l.host=n.host,l.port=n.port,l.path=m(n.path),l.query=n.query;else if("/"==s||"\\"==s&&l.isSpecial())c=Ce;else if("?"==s)l.username=n.username,l.password=n.password,l.host=n.host,l.port=n.port,l.path=m(n.path),l.query="",c=$e;else{if("#"!=s){l.username=n.username,l.password=n.password,l.host=n.host,l.port=n.port,l.path=m(n.path),l.path.length--,c=De;continue}l.username=n.username,l.password=n.password,l.host=n.host,l.port=n.port,l.path=m(n.path),l.query=n.query,l.fragment="",c=Fe}break;case Ce:if(!l.isSpecial()||"/"!=s&&"\\"!=s){if("/"!=s){l.username=n.username,l.password=n.password,l.host=n.host,l.port=n.port,c=De;continue}c=Ae}else c=Pe;break;case Te:if(c=Pe,"/"!=s||"/"!=L(p,u+1))continue;u++;break;case Pe:if("/"!=s&&"\\"!=s){c=Ae;continue}break;case Ae:if("@"==s){d&&(p="%40"+p),d=!0,a=g(p);for(var y=0;y<a.length;y++){var b=a[y];if(":"!=b||v){var S=he(b,fe);v?l.password+=S:l.username+=S}else v=!0}p=""}else if(s==r||"/"==s||"?"==s||"#"==s||"\\"==s&&l.isSpecial()){if(d&&""==p)return W;u-=g(p).length+1,p="",c=Oe}else p+=s;break;case Oe:case Re:if(t&&"file"==l.scheme){c=Ie;continue}if(":"!=s||h){if(s==r||"/"==s||"?"==s||"#"==s||"\\"==s&&l.isSpecial()){if(l.isSpecial()&&""==p)return K;if(t&&""==p&&(l.includesCredentials()||null!==l.port))return;if(i=l.parseHost(p),i)return i;if(p="",c=Me,t)return;continue}"["==s?h=!0:"]"==s&&(h=!1),p+=s}else{if(""==p)return K;if(i=l.parseHost(p),i)return i;if(p="",c=Ee,t==Re)return}break;case Ee:if(!j(Q,s)){if(s==r||"/"==s||"?"==s||"#"==s||"\\"==s&&l.isSpecial()||t){if(""!=p){var k=O(p,10);if(k>65535)return V;l.port=l.isSpecial()&&k===ge[l.scheme]?null:k,p=""}if(t)return;c=Me;continue}return V}p+=s;break;case Le:if(l.scheme="file","/"==s||"\\"==s)c=je;else{if(!n||"file"!=n.scheme){c=De;continue}if(s==r)l.host=n.host,l.path=m(n.path),l.query=n.query;else if("?"==s)l.host=n.host,l.path=m(n.path),l.query="",c=$e;else{if("#"!=s){ve(I(m(o,u),""))||(l.host=n.host,l.path=m(n.path),l.shortenPath()),c=De;continue}l.host=n.host,l.path=m(n.path),l.query=n.query,l.fragment="",c=Fe}}break;case je:if("/"==s||"\\"==s){c=Ie;break}n&&"file"==n.scheme&&!ve(I(m(o,u),""))&&(me(n.path[0],!0)?H(l.path,n.path[0]):l.host=n.host),c=De;continue;case Ie:if(s==r||"/"==s||"\\"==s||"?"==s||"#"==s){if(!t&&me(p))c=De;else if(""==p){if(l.host="",t)return;c=Me}else{if(i=l.parseHost(p),i)return i;if("localhost"==l.host&&(l.host=""),t)return;p="",c=Me}continue}p+=s;break;case Me:if(l.isSpecial()){if(c=De,"/"!=s&&"\\"!=s)continue}else if(t||"?"!=s)if(t||"#"!=s){if(s!=r&&(c=De,"/"!=s))continue}else l.fragment="",c=Fe;else l.query="",c=$e;break;case De:if(s==r||"/"==s||"\\"==s&&l.isSpecial()||!t&&("?"==s||"#"==s)){if(we(p)?(l.shortenPath(),"/"==s||"\\"==s&&l.isSpecial()||H(l.path,"")):ye(p)?"/"==s||"\\"==s&&l.isSpecial()||H(l.path,""):("file"==l.scheme&&!l.path.length&&me(p)&&(l.host&&(l.host=""),p=L(p,0)+":"),H(l.path,p)),p="","file"==l.scheme&&(s==r||"?"==s||"#"==s))while(l.path.length>1&&""===l.path[0])F(l.path);"?"==s?(l.query="",c=$e):"#"==s&&(l.fragment="",c=Fe)}else p+=he(s,de);break;case He:"?"==s?(l.query="",c=$e):"#"==s?(l.fragment="",c=Fe):s!=r&&(l.path[0]+=he(s,ue));break;case $e:t||"#"!=s?s!=r&&("'"==s&&l.isSpecial()?l.query+="%27":l.query+="#"==s?"%23":he(s,ue)):(l.fragment="",c=Fe);break;case Fe:s!=r&&(l.fragment+=he(s,pe));break}u++}},parseHost:function(e){var t,n,r;if("["==L(e,0)){if("]"!=L(e,e.length-1))return K;if(t=ie(q(e,1,-1)),!t)return K;this.host=t}else if(this.isSpecial()){if(e=y(e),j(ne,e))return K;if(t=ae(e),null===t)return K;this.host=t}else{if(j(re,e))return K;for(t="",n=g(e),r=0;r<n.length;r++)t+=he(n[r],ue);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return f(ge,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&me(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,r=e.password,o=e.host,s=e.port,a=e.path,i=e.query,l=e.fragment,c=t+":";return null!==o?(c+="//",e.includesCredentials()&&(c+=n+(r?":"+r:"")+"@"),c+=ce(o),null!==s&&(c+=":"+s)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+I(a,"/"):"",null!==i&&(c+="?"+i),null!==l&&(c+="#"+l),c},setHref:function(e){var t=this.parse(e);if(t)throw A(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new qe(e.path[0]).origin}catch(n){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+ce(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(w(e)+":",be)},getUsername:function(){return this.username},setUsername:function(e){var t=g(w(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=he(t[n],fe)}},getPassword:function(){return this.password},setPassword:function(e){var t=g(w(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=he(t[n],fe)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?ce(e):ce(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Oe)},getHostname:function(){var e=this.host;return null===e?"":ce(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Re)},getPort:function(){var e=this.port;return null===e?"":w(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(e=w(e),""==e?this.port=null:this.parse(e,Ee))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+I(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Me))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){e=w(e),""==e?this.query=null:("?"==L(e,0)&&(e=q(e,1)),this.query="",this.parse(e,$e)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){e=w(e),""!=e?("#"==L(e,0)&&(e=q(e,1)),this.fragment="",this.parse(e,Fe)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var qe=function(e){var t=d(this,Be),n=S(arguments.length,1)>1?arguments[1]:void 0,r=x(t,new ze(e,!1,n));s||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash())},Be=qe.prototype,Ne=function(e,t){return{get:function(){return U(this)[e]()},set:t&&function(e){return U(this)[t](e)},configurable:!0,enumerable:!0}};if(s&&u(Be,{href:Ne("serialize","setHref"),origin:Ne("getOrigin"),protocol:Ne("getProtocol","setProtocol"),username:Ne("getUsername","setUsername"),password:Ne("getPassword","setPassword"),host:Ne("getHost","setHost"),hostname:Ne("getHostname","setHostname"),port:Ne("getPort","setPort"),pathname:Ne("getPathname","setPathname"),search:Ne("getSearch","setSearch"),searchParams:Ne("getSearchParams"),hash:Ne("getHash","setHash")}),p(Be,"toJSON",(function(){return U(this).serialize()}),{enumerable:!0}),p(Be,"toString",(function(){return U(this).serialize()}),{enumerable:!0}),P){var We=P.createObjectURL,Ge=P.revokeObjectURL;We&&p(qe,"createObjectURL",l(We,P)),Ge&&p(qe,"revokeObjectURL",l(Ge,P))}b(qe,"URL"),o({global:!0,forced:!a,sham:!s},{URL:qe})},function(e,t,n){var r=n(7),o=n(9),s=n(25),a=o("iterator");e.exports=!r((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,r){t["delete"]("b"),n+=r+e})),s&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},function(e,t,n){var r=n(4),o=n(40),s=r.TypeError;e.exports=function(e,t){if(o(t,e))return e;throw s("Incorrect invocation")}},function(e,t,n){"use strict";var r=n(56),o=n(26),s=n(29);e.exports=function(e,t,n){var a=r(t);a in e?o.f(e,a,s(0,n)):e[a]=n}},function(e,t,n){var r=n(4),o=n(82),s=n(44),a=n(101),i=r.Array,l=Math.max;e.exports=function(e,t,n){for(var r=s(e),c=o(t,r),u=o(void 0===n?r:n,r),p=i(l(u-c,0)),d=0;c<u;c++,d++)a(p,d,e[c]);return p.length=d,p}},function(e,t,n){var r=n(4),o=r.TypeError;e.exports=function(e,t){if(e<t)throw o("Not enough arguments");return e}},function(e){e.exports=JSON.parse('{"about":"About","services":"Services","hide":"Hide","hide_others":"Hide Others","show_all":"Show All","quit":"Quit","file":"File","open_file":"Open File ...","edit":"Edit","undo":"Undo","redo":"Redo","cut":"Cut","copy":"Copy","paste":"Paste","select_all":"Select All","view":"View","reload":"Reload","toggle_full_screen":"Toggle Full Screen","toggle_developer_tools":"Toogle Developer Tools","window":"Window","minimize":"Minimize","close":"Close","bring_all_to_front":"Bring All to Front","help":"Help","github_repo":"Github Repo","issues":"Issues","learn_more":"Learn More","official_site":"Official Site","check_for_update":"Check For Update","learn_spelling":"Learn Spelling","lookup_selection":"Look Up \\"{selection}\\"","search_with_google":"Search with Google","save_as":"Save As","save_image":"Save Image","save_image_as":"Save Image As ...","copy_link":"Copy Link","save_link_as":"Save Link As ...","copy_image":"Copy Image","copy_image_as":"Copy Image As ...","copy_image_address":"Copy Image Address","download_complete":"Download complete","download_complete_message":"{0} is downloaded","is_running":"{0} is running","open":"Open {0}","launch_problem":"Launch problem","ask_clear_data":"It seems you are trying to launch Alphabiz but failed for several times.\\nDo you want to clear all app data and try launch later?","launch_directly":"Launch directly","clear_all_data":"Clear all data","confirm":"Confirm","ask_clear_confirm":"This will remove all configs, logs and user data!\\nAfter this you may need to launch Alphabiz again.\\nAre you sure to clear data?","confirm_launch":"No, launch directly","confirm_clear":"Yes, clear all data"}')},function(e){e.exports=JSON.parse('{"about":"关于","services":"服务","hide":"隐藏","hide_others":"隐藏其他","show_all":"显示全部","quit":"退出","file":"文件","open_file":"打开文件 ...","edit":"编辑","undo":"撤销","redo":"重做","cut":"剪切","copy":"复制","paste":"粘贴","select_all":"全选","view":"显示","reload":"重载","toggle_full_screen":"切换全屏","toggle_developer_tools":"切换开发者工具","window":"窗口","minimize":"最小化","close":"关闭","bring_all_to_front":"前置全部窗口","help":"帮助","github_repo":"Github 仓库","issues":"Issues","learn_more":"更多","official_site":"官方网站","check_for_update":"检查更新","learn_spelling":"学习拼写","lookup_selection":"查询“{selection}”","search_with_google":"用 Google 搜素","save_as":"保存为","save_image":"保存图片","save_image_as":"将图片另存为 ...","copy_link":"复制链接","save_link_as":"将链接复制为 ...","copy_image":"复制图片","copy_image_as":"将图片复制为 ...","copy_image_address":"复制图片地址","download_complete":"下载完成","download_complete_message":"{0} 已下载完成","is_running":"{0} 正在运行","open":"打开 {0}","launch_problem":"启动异常","ask_clear_data":"您似乎在短时间内多次尝试启动 Alphabiz。\\n如果遇到问题，您可以清除所有数据后重试","launch_directly":"直接启动","clear_all_data":"清除所有数据","confirm":"二次确认","ask_clear_confirm":"此操作将清除所有用户配置和数据！\\n清除数据后需要手动启动 Alphabiz。\\n是否仍要继续？","confirm_launch":"否，直接启动","confirm_clear":"是，清除所有数据"}')},function(e){e.exports=JSON.parse('{"about":"關於","services":"服務","hide":"隱藏","hide_others":"隱藏其他","show_all":"顯示全部","quit":"退出","file":"文檔","open_file":"打開文檔 ...","edit":"編輯","undo":"撤銷","redo":"重做","cut":"剪切","copy":"複製","paste":"粘貼","select_all":"全選","view":"顯示","reload":"重載","toggle_full_screen":"切換全螢幕","toggle_developer_tools":"切換開發者工具","window":"窗口","minimize":"最小化","close":"關閉","bring_all_to_front":"前置全部窗口","help":"幫助","github_repo":"Github 倉庫","issues":"Issues","learn_more":"更多","official_site":"官方網站","check_for_update":"檢索更新","learn_spelling":"學習拼寫","lookup_selection":"查詢“{selection}”","search_with_google":"用 Google 檢索","save_as":"保存為","save_image":"保存圖片","save_image_as":"將圖片另存為 ...","copy_link":"複製連結","save_link_as":"將連結複製為 ...","copy_image":"複製圖片","copy_image_as":"將圖片複製為 ...","copy_image_address":"複製圖片地址","download_complete":"下載完成","download_complete_message":"{0} 已下載完成","is_running":"{0} 正在運行","open":"打開 {0}","launch_problem":"啟動異常","ask_clear_data":"您似乎在短時間內多次嘗試啟動 Alphabiz。\\n如果遇到問題，您可以清除所有數據後重試","launch_directly":"直接啟動","clear_all_data":"清除所有數據","confirm":"二次確認","ask_clear_confirm":"此操作將清除所有用戶配置和數據！\\n清除數據後需要手動啟動 Alphabiz。\\n是否仍要繼續？","confirm_launch":"否，直接啟動","confirm_clear":"是，清除所有數據"}')},function(e,t){e.exports=require("parse-torrent")},function(e,t){e.exports=require("electron-is")},function(e,t){e.exports=require("diskusage")},function(e,t){e.exports=require("node-schedule")},function(e,t){e.exports=require("events")},function(e,t){e.exports=require("dns")},function(e,t){e.exports=require("bittorrent-tracker")},function(e,t){e.exports=require("webtorrent")},function(e,t){e.exports=require("electron-default-menu")},function(e,t){e.exports=require("electron-context-menu")},function(e,t,n){e.exports=n(172)},function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(e,t,n){var r=n(52),o=r("span").classList,s=o&&o.constructor&&o.constructor.prototype;e.exports=s===Object.prototype?void 0:s},function(e,t,n){var r,o,s=n(4),a=n(121),i=s.process,l=s.Deno,c=i&&i.versions||l&&l.version,u=c&&c.v8;u&&(r=u.split("."),o=r[0]>0&&r[0]<4?1:+(r[0]+r[1])),!o&&a&&(r=a.match(/Edge\/(\d+)/),(!r||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/),r&&(o=+r[1]))),e.exports=o},function(e,t,n){var r=n(17);e.exports=r("navigator","userAgent")||""},function(e,t,n){var r=n(4),o=n(11),s=n(16),a=n(79),i=n(41),l=n(123),c=n(9),u=r.TypeError,p=c("toPrimitive");e.exports=function(e,t){if(!s(e)||a(e))return e;var n,r=i(e,p);if(r){if(void 0===t&&(t="default"),n=o(r,e,t),!s(n)||a(n))return n;throw u("Can't convert object to primitive value")}return void 0===t&&(t="number"),l(e,t)}},function(e,t,n){var r=n(4),o=n(11),s=n(8),a=n(16),i=r.TypeError;e.exports=function(e,t){var n,r;if("string"===t&&s(n=e.toString)&&!a(r=o(n,e)))return r;if(s(n=e.valueOf)&&!a(r=o(n,e)))return r;if("string"!==t&&s(n=e.toString)&&!a(r=o(n,e)))return r;throw i("Can't convert object to primitive value")}},function(e,t,n){var r=n(30),o=n(82),s=n(44),a=function(e){return function(t,n,a){var i,l=r(t),c=s(l),u=o(a,c);if(e&&n!=n){while(c>u)if(i=l[u++],i!=i)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},function(e,t,n){var r=n(17);e.exports=r("document","documentElement")},function(e,t,n){var r=n(4),o=n(8),s=n(60),a=r.WeakMap;e.exports=o(a)&&/native code/.test(s(a))},function(e,t,n){var r=n(17),o=n(5),s=n(128),a=n(88),i=n(10),l=o([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=s.f(i(e)),n=a.f;return n?l(t,n(e)):t}},function(e,t,n){var r=n(81),o=n(58),s=o.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,s)}},function(e,t,n){var r=n(7),o=n(8),s=/#|\.prototype\./,a=function(e,t){var n=l[i(e)];return n==u||n!=c&&(o(t)?r(t):!!t)},i=a.normalize=function(e){return String(e).replace(s,".").toLowerCase()},l=a.data={},c=a.NATIVE="N",u=a.POLYFILL="P";e.exports=a},function(e,t,n){var r=n(7);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t,n){var r=n(4),o=n(8),s=r.String,a=r.TypeError;e.exports=function(e){if("object"==typeof e||o(e))return e;throw a("Can't set "+s(e)+" as a prototype")}},function(e,t,n){"use strict";var r=n(14),o=n(11),s=n(34),a=n(92),i=n(133),l=n(134);r({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=a.f(t),r=n.resolve,c=n.reject,u=i((function(){var n=s(t.resolve),a=[],i=0,c=1;l(e,(function(e){var s=i++,l=!1;c++,o(n,t,e).then((function(e){l||(l=!0,a[s]={status:"fulfilled",value:e},--c||r(a))}),(function(e){l||(l=!0,a[s]={status:"rejected",reason:e},--c||r(a))}))})),--c||r(a)}));return u.error&&c(u.value),n.promise}})},function(e,t){e.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}},function(e,t,n){var r=n(4),o=n(47),s=n(11),a=n(10),i=n(42),l=n(93),c=n(44),u=n(40),p=n(64),d=n(48),f=n(94),h=r.TypeError,g=function(e,t){this.stopped=e,this.result=t},m=g.prototype;e.exports=function(e,t,n){var r,v,y,w,b,S,k,_=n&&n.that,x=!(!n||!n.AS_ENTRIES),U=!(!n||!n.IS_ITERATOR),C=!(!n||!n.INTERRUPTED),T=o(t,_),P=function(e){return r&&f(r,"normal",e),new g(!0,e)},A=function(e){return x?(a(e),C?T(e[0],e[1],P):T(e[0],e[1])):C?T(e,P):T(e)};if(U)r=e;else{if(v=d(e),!v)throw h(i(e)+" is not iterable");if(l(v)){for(y=0,w=c(e);w>y;y++)if(b=A(e[y]),b&&u(m,b))return b;return new g(!1)}r=p(e,v)}S=r.next;while(!(k=s(S,r)).done){try{b=A(k.value)}catch(O){f(r,"throw",O)}if("object"==typeof b&&b&&u(m,b))return b}return new g(!1)}},function(e,t,n){var r=n(9),o=r("toStringTag"),s={};s[o]="z",e.exports="[object z]"===String(s)},function(e,t,n){"use strict";n(137);var r=n(5),o=n(20),s=n(65),a=n(7),i=n(9),l=n(19),c=i("species"),u=RegExp.prototype;e.exports=function(e,t,n,p){var d=i(e),f=!a((function(){var t={};return t[d]=function(){return 7},7!=""[e](t)})),h=f&&!a((function(){var t=!1,n=/a/;return"split"===e&&(n={},n.constructor={},n.constructor[c]=function(){return n},n.flags="",n[d]=/./[d]),n.exec=function(){return t=!0,null},n[d](""),!t}));if(!f||!h||n){var g=r(/./[d]),m=t(d,""[e],(function(e,t,n,o,a){var i=r(e),l=t.exec;return l===s||l===u.exec?f&&!a?{done:!0,value:g(t,n,o)}:{done:!0,value:i(n,t,o)}:{done:!1}}));o(String.prototype,e,m[0]),o(u,d,m[1])}p&&l(u[d],"sham",!0)}},function(e,t,n){"use strict";var r=n(14),o=n(65);r({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},function(e,t,n){"use strict";var r=n(10);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){var r=n(7),o=n(4),s=o.RegExp,a=r((function(){var e=s("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),i=a||r((function(){return!s("a","y").sticky})),l=a||r((function(){var e=s("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:l,MISSED_STICKY:i,UNSUPPORTED_Y:a}},function(e,t,n){var r=n(7),o=n(4),s=o.RegExp;e.exports=r((function(){var e=s(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},function(e,t,n){var r=n(7),o=n(4),s=o.RegExp;e.exports=r((function(){var e=s("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},function(e,t,n){"use strict";var r=n(66).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){var r=n(5),o=n(32),s=Math.floor,a=r("".charAt),i=r("".replace),l=r("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,p,d){var f=n+e.length,h=r.length,g=u;return void 0!==p&&(p=o(p),g=c),i(d,g,(function(o,i){var c;switch(a(i,0)){case"$":return"$";case"&":return e;case"`":return l(t,0,n);case"'":return l(t,f);case"<":c=p[l(i,1,-1)];break;default:var u=+i;if(0===u)return o;if(u>h){var d=s(u/10);return 0===d?o:d<=h?void 0===r[d-1]?a(i,1):r[d-1]+a(i,1):o}c=r[u-1]}return void 0===c?"":c}))}},function(e,t,n){var r=n(4),o=n(11),s=n(10),a=n(8),i=n(39),l=n(65),c=r.TypeError;e.exports=function(e,t){var n=e.exec;if(a(n)){var r=o(n,e,t);return null!==r&&s(r),r}if("RegExp"===i(e))return o(l,e,t);throw c("RegExp#exec called on incompatible receiver")}},function(e,t,n){var r=n(5),o=n(31),s=n(21),a=n(96),i=r("".replace),l="["+a+"]",c=RegExp("^"+l+l+"*"),u=RegExp(l+l+"*$"),p=function(e){return function(t){var n=s(o(t));return 1&e&&(n=i(n,c,"")),2&e&&(n=i(n,u,"")),n}};e.exports={start:p(1),end:p(2),trim:p(3)}},function(e,t,n){var r=n(61).PROPER,o=n(7),s=n(96),a="​᠎";e.exports=function(e){return o((function(){return!!s[e]()||a[e]()!==a||r&&s[e].name!==e}))}},function(e,t,n){"use strict";var r=n(14),o=n(5),s=n(148),a=o([].reverse),i=[1,2];r({target:"Array",proto:!0,forced:String(i)===String(i.reverse())},{reverse:function(){return s(this)&&(this.length=this.length),a(this)}})},function(e,t,n){var r=n(39);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){"use strict";var r=n(17),o=n(12),s=n(19),a=n(40),i=n(62),l=n(87),c=n(150),u=n(151),p=n(152),d=n(153),f=n(154),h=n(25);e.exports=function(e,t,n,g){var m=g?2:1,v=e.split("."),y=v[v.length-1],w=r.apply(null,v);if(w){var b=w.prototype;if(!h&&o(b,"cause")&&delete b.cause,!n)return w;var S=r("Error"),k=t((function(e,t){var n=u(g?t:e,void 0),r=g?new w(e):new w;return void 0!==n&&s(r,"message",n),f&&s(r,"stack",d(r.stack,2)),this&&a(b,this)&&c(r,this,k),arguments.length>m&&p(r,arguments[m]),r}));if(k.prototype=b,"Error"!==y&&(i?i(k,S):l(k,S,{name:!0})),l(k,w),!h)try{b.name!==y&&s(b,"name",y),b.constructor=k}catch(_){}return k}}},function(e,t,n){var r=n(8),o=n(16),s=n(62);e.exports=function(e,t,n){var a,i;return s&&r(a=t.constructor)&&a!==n&&o(i=a.prototype)&&i!==n.prototype&&s(e,i),e}},function(e,t,n){var r=n(21);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},function(e,t,n){var r=n(16),o=n(19);e.exports=function(e,t){r(t)&&"cause"in t&&o(e,"cause",t.cause)}},function(e,t,n){var r=n(5),o=r("".replace),s=function(e){return String(Error(e).stack)}("zxcasd"),a=/\n\s*at [^:]*:[^\n]*/,i=a.test(s);e.exports=function(e,t){if(i&&"string"==typeof e)while(t--)e=o(e,a,"");return e}},function(e,t,n){var r=n(7),o=n(29);e.exports=!r((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",o(1,7)),7!==e.stack)}))},function(e,t,n){"use strict";var r=n(14),o=n(25),s=n(156),a=n(7),i=n(17),l=n(8),c=n(157),u=n(159),p=n(20),d=!!s&&a((function(){s.prototype["finally"].call({then:function(){}},(function(){}))}));if(r({target:"Promise",proto:!0,real:!0,forced:d},{finally:function(e){var t=c(this,i("Promise")),n=l(e);return this.then(n?function(n){return u(t,e()).then((function(){return n}))}:e,n?function(n){return u(t,e()).then((function(){throw n}))}:e)}}),!o&&l(s)){var f=i("Promise").prototype["finally"];s.prototype["finally"]!==f&&p(s.prototype,"finally",f,{unsafe:!0})}},function(e,t,n){var r=n(4);e.exports=r.Promise},function(e,t,n){var r=n(10),o=n(158),s=n(9),a=s("species");e.exports=function(e,t){var n,s=r(e).constructor;return void 0===s||void 0==(n=r(s)[a])?t:o(n)}},function(e,t,n){var r=n(4),o=n(97),s=n(42),a=r.TypeError;e.exports=function(e){if(o(e))return e;throw a(s(e)+" is not a constructor")}},function(e,t,n){var r=n(10),o=n(16),s=n(92);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=s.f(e),a=n.resolve;return a(t),n.promise}},function(e,t){e.exports=require("lzma-native")},function(e,t){e.exports=require("lzma-web")},function(e,t,n){"use strict";var r=n(66).charAt,o=n(21),s=n(28),a=n(84),i="String Iterator",l=s.set,c=s.getterFor(i);a(String,"String",(function(e){l(this,{type:i,string:o(e),index:0})}),(function(){var e,t=c(this),n=t.string,o=t.index;return o>=n.length?{value:void 0,done:!0}:(e=r(n,o),t.index+=e.length,{value:e,done:!1})}))},function(e,t,n){"use strict";var r=n(13),o=n(5),s=n(11),a=n(7),i=n(80),l=n(88),c=n(86),u=n(32),p=n(71),d=Object.assign,f=Object.defineProperty,h=o([].concat);e.exports=!d||a((function(){if(r&&1!==d({b:1},d(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),o="abcdefghijklmnopqrst";return e[n]=7,o.split("").forEach((function(e){t[e]=e})),7!=d({},e)[n]||i(d({},t)).join("")!=o}))?function(e,t){var n=u(e),o=arguments.length,a=1,d=l.f,f=c.f;while(o>a){var g,m=p(arguments[a++]),v=d?h(i(m),d(m)):i(m),y=v.length,w=0;while(y>w)g=v[w++],r&&!s(f,m,g)||(n[g]=m[g])}return n}:d},function(e,t,n){"use strict";var r=n(4),o=n(47),s=n(11),a=n(32),i=n(165),l=n(93),c=n(97),u=n(44),p=n(101),d=n(64),f=n(48),h=r.Array;e.exports=function(e){var t=a(e),n=c(this),r=arguments.length,g=r>1?arguments[1]:void 0,m=void 0!==g;m&&(g=o(g,r>2?arguments[2]:void 0));var v,y,w,b,S,k,_=f(t),x=0;if(!_||this==h&&l(_))for(v=u(t),y=n?new this(v):h(v);v>x;x++)k=m?g(t[x],x):t[x],p(y,x,k);else for(b=d(t,_),S=b.next,y=n?new this:[];!(w=s(S,b)).done;x++)k=m?i(b,g,[w.value,x],!0):w.value,p(y,x,k);return y.length=x,y}},function(e,t,n){var r=n(10),o=n(94);e.exports=function(e,t,n,s){try{return s?t(r(n)[0],n[1]):t(n)}catch(a){o(e,"throw",a)}}},function(e,t,n){"use strict";var r=n(4),o=n(5),s=2147483647,a=36,i=1,l=26,c=38,u=700,p=72,d=128,f="-",h=/[^\0-\u007E]/,g=/[.\u3002\uFF0E\uFF61]/g,m="Overflow: input needs wider integers to process",v=a-i,y=r.RangeError,w=o(g.exec),b=Math.floor,S=String.fromCharCode,k=o("".charCodeAt),_=o([].join),x=o([].push),U=o("".replace),C=o("".split),T=o("".toLowerCase),P=function(e){var t=[],n=0,r=e.length;while(n<r){var o=k(e,n++);if(o>=55296&&o<=56319&&n<r){var s=k(e,n++);56320==(64512&s)?x(t,((1023&o)<<10)+(1023&s)+65536):(x(t,o),n--)}else x(t,o)}return t},A=function(e){return e+22+75*(e<26)},O=function(e,t,n){var r=0;e=n?b(e/u):e>>1,e+=b(e/t);while(e>v*l>>1)e=b(e/v),r+=a;return b(r+(v+1)*e/(e+c))},R=function(e){var t=[];e=P(e);var n,r,o=e.length,c=d,u=0,h=p;for(n=0;n<e.length;n++)r=e[n],r<128&&x(t,S(r));var g=t.length,v=g;g&&x(t,f);while(v<o){var w=s;for(n=0;n<e.length;n++)r=e[n],r>=c&&r<w&&(w=r);var k=v+1;if(w-c>b((s-u)/k))throw y(m);for(u+=(w-c)*k,c=w,n=0;n<e.length;n++){if(r=e[n],r<c&&++u>s)throw y(m);if(r==c){var U=u,C=a;while(1){var T=C<=h?i:C>=h+l?l:C-h;if(U<T)break;var R=U-T,E=a-T;x(t,S(A(T+R%E))),U=b(R/E),C+=a}x(t,S(A(U))),h=O(u,k,v==g),u=0,v++}}u++,c++}return _(t,"")};e.exports=function(e){var t,n,r=[],o=C(U(T(e),g,"."),".");for(t=0;t<o.length;t++)n=o[t],x(r,w(h,n)?"xn--"+R(n):n);return _(r,".")}},function(e,t,n){var r=n(20);e.exports=function(e,t,n){for(var o in t)r(e,o,t[o],n);return e}},function(e,t,n){var r=n(102),o=Math.floor,s=function(e,t){var n=e.length,l=o(n/2);return n<8?a(e,t):i(e,s(r(e,0,l),t),s(r(e,l),t),t)},a=function(e,t){var n,r,o=e.length,s=1;while(s<o){r=s,n=e[s];while(r&&t(e[r-1],n)>0)e[r]=e[--r];r!==s++&&(e[r]=n)}return e},i=function(e,t,n,r){var o=t.length,s=n.length,a=0,i=0;while(a<o||i<s)e[a+i]=a<o&&i<s?r(t[a],n[i])<=0?t[a++]:n[i++]:a<o?t[a++]:n[i++];return e};e.exports=s},function(e,t,n){var r=n(72);r("flat")},function(e,t){e.exports=require("electron-squirrel-startup")},function(e,t){e.exports=require("child_process")},function(e,t,n){"use strict";n.r(t),n.d(t,"mainWindowReady",(function(){return Xn})),n.d(t,"getMainWindow",(function(){return or})),n.d(t,"checkForUpdate",(function(){return ar}));n(6),n(46);var r=n(0),o=n(3),s=n.n(o),a=n(1),i=n.n(a),l=n(68),c=n.n(l),u=n(22),p=n.n(u);async function d(e){const{data:t}=await p.a.get(e);return t.split("\n").filter((e=>e.length))}async function f(e){const t={success:[],failure:[],data:[],time:(new Date).toLocaleString()};for(const r of e)try{const e=await d(r.value);t.data.push(...e),t.success.push(r.label)}catch(n){t.failure.push(r.label)}return t}n(132);var h=n(2),g=n.n(h);const m="win32"===process.platform,v=[process.execPath,"--"];const y=v.map((e=>`"${e}"`)).join(" "),w="Alphabiz",b=async e=>new Promise((t=>{const n=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${e}`});n.get("",((n,r)=>{if(n)return t(!1);const o=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${e}\\shell\\open\\command`});o.get("",((e,n)=>{if(e||!n)return t(!1);t(n.value===`${y} "%1"`)}))}))})),S=async e=>new Promise((t=>{if(!m)return t(!0);const n=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${w+e}`});n.get("",((n,r)=>{if(n)return t(!1);const o=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${e}`});o.get("",((n,r)=>{if(n||!r||!r.value)return t(!1);if(r.value!==w+e)return t(!1);const o=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${e}\\OpenWithProgids`});o.valueExists(w+e,((e,n)=>{if(e)return t(!1);t(n)}))}))}))})),k=({magnet:e=!0}={})=>{e?r["app"].setAsDefaultProtocolClient("magnet"):r["app"].removeAsDefaultProtocolClient("magnet")},_=(__dirname,Object(o["resolve"])(process.resourcesPath,"favicon.ico")),x=(e,t)=>{const n=new g.a({hive:g.a.HKCU,key:"\\Software\\Classes\\"+e}),r=e=>e&&console.log(e);n.set("",g.a.REG_SZ,t,(t=>{t&&console.log(t),n.set("URL Protocol",g.a.REG_SZ,"",r);const o=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${e}\\DefaultIcon`});o.set("",g.a.REG_SZ,_,r);const s=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${e}\\shell\\open\\command`});s.set("",g.a.REG_SZ,`${y} "%1"`,r)}))},U=(e,t=y)=>{if("win32"!==process.platform)return;const n=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${e}\\shell\\open\\command`});n.get("",((n,r)=>{if(!n&&r.value.includes(t.split('" "')[0])){const t=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${e}`});t.destroy((()=>{}))}}))},C=async(e,t)=>new Promise((n=>{if(!m)return n(!0);const r=e=>e&&console.log(e),o=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${e}`});o.set("",g.a.REG_SZ,w+e,(o=>{const s=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${e}\\OpenWithProgids`});s.set(w+e,g.a.REG_SZ,"",(o=>{r(o);const s=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${w+e}`});s.set("",g.a.REG_SZ,t,(t=>{r(t);const o=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${w+e}\\DefaultIcon`});o.set("",g.a.REG_SZ,_,r);const s=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${w+e}\\shell\\open\\command`});s.set("",g.a.REG_SZ,`${y} "%1"`,r),n(!0)}))}))}))})),T=async e=>new Promise((t=>{if(!m)return t(!0);const n=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${e}\\OpenWithProgids`});n.remove(w+e,(n=>{if(n)return t(!1);const r=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${e}`});r.get("",((n,o)=>{if(n)return t(!1);o.value===w+e&&r.remove("",(e=>t(!e)))}));const o=new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${w+e}`});o.destroy((e=>{e&&console.error(e)}))}))})),P=(()=>{const e="abk",t=`.${e.toLowerCase()}`,n=`${e.toUpperCase()} File (${w})`,r=e=>S(e),o=async(e,t)=>{if("win32"!==process.platform)return!0;const n=()=>new Promise(((t,n)=>{new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${e}`}).set("",g.a.REG_SZ,w+e,(e=>e?n(e):t()))})),r=()=>new Promise(((t,n)=>{new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${e}\\OpenWithProgids`}).set(w+e,g.a.REG_SZ,"",(e=>e?n(e):t()))})),o=()=>new Promise(((n,r)=>{new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${w+e}`}).set("",g.a.REG_SZ,t,(e=>e?r(e):n()))})),s=()=>new Promise(((t,n)=>{new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${w+e}\\DefaultIcon`}).set("",g.a.REG_SZ,_,(e=>e?n(e):t()))})),a=()=>new Promise(((t,n)=>{new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${w+e}\\shell\\open\\command`}).set("",g.a.REG_SZ,`${y} "%1"`,(e=>e?n(e):t()))})),i=e=>console.error(e);return await n().catch(i),await r().catch(i),await o().catch(i),await s().catch(i),await a().catch(i),!0},s=async e=>{if("win32"!==process.platform)return!0;const t=()=>new Promise(((t,n)=>{new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${e}\\OpenWithProgids`}).remove(w+e,(e=>e?n(e):t()))})),n=()=>new Promise(((t,n)=>{new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${e}`}).remove("",(e=>e?n(e):t()))})),r=()=>new Promise(((t,n)=>{new g.a({hive:g.a.HKCU,key:`\\Software\\Classes\\${w+e}`}).destroy()}));await t().then((()=>Promise.allSettled([n(),r()])))};return{isRegistered:()=>r(t),register:()=>o(t,n),unregister:()=>s(t)}})();P.isRegistered().then((async e=>(console.log("ABK File Association:","commandArg =",y),e&&(console.log("ABK File Association:","unregistering..."),await P.unregister()),console.log("ABK File Association:","registering..."),await P.register(),!0)),(e=>(console.log("ABK File Association:","failed:",e.message),!1))).then((e=>{console.log("ABK File Association:",e?"registered":"unregistered")}));const A=async e=>{console.log("associate",Object.keys(e),e);const t=[];for(const n in e){const r="."+n,o=e[n]||!1;console.log("set",r,o),o?t.push(C(r,`${n.toUpperCase()} File (${w})`)):t.push(T(r))}return Promise.all(t)},O=async({magnet:e,torrent:t,video:n,audio:r}={})=>{e?await x("magnet","URL:BitTorrent Magnet URL"):!1===e&&await U("magnet","URL:BitTorrent Magnet URL"),!0===t?await C(".torrent","BitTorrent Document"):!1===t&&await T(".torrent")};var R=e=>{switch(process.platform){case"darwin":return console.log("Setup association for darwin",e),k(e);case"win32":return console.log("Setup association for win32",e),O(e)}},E=(n(15),n(104)),L=n(105),j=n(106);const I={"en-US":E,"zh-CN":L,"zh-TW":j};class M{constructor(e="en-US"){this.locale=e,this._messages={},this.setLocale(e)}setLocale(e){e in I?(this.locale=e,this._messages={...I[e]}):(this.locale="en-US",this._messages={...I[e]})}rawText(e){return this._messages[e]||I["en-US"][e]||e}$t(e,t={}){return this.rawText(e).replace(/{(.+)?}/g,((e,n)=>t[n]?t[n]:`{${n}}`))}}var D=n(23),H=n.n(D);const $=n(1),F=n(3),z=e=>{{const t="alphabiz"===process.env.REPO?F.resolve(process.cwd(),"public"):process.resourcesPath,n="version.json",r=$.readFileSync(F.resolve(t,n)),o=JSON.parse(r);return o[e]}};var q=z,B=(n(95),n(147),n(51)),N=n(107),W=n.n(N);const G=[],K=new Map,V={on(e,t){K.has(e)||K.set(e,[]),K.get(e).push(t)},emit(e,...t){G.push({name:e,data:JSON.stringify(t)})},emitSingle(e,...t){for(let n=0;n<G.length;n++)G[n].name===e&&(G.splice(n,1),n--);G.push({name:e,data:JSON.stringify(t)})},off(e,t){const n=K.get(e);if(!n)return;const r=n.indexOf(t);-1!==r&&n.splice(r,1)}};r["ipcMain"].on("_io_fetch",(e=>{e.reply("_io_response",G),G.length=0})),r["ipcMain"].on("_io_send",((e,t)=>{const{name:n,data:r}=t,o=K.get(n);o&&o.forEach((e=>e(...r)))}));var J=V,Z=n(50),Q=n(27),Y=n.n(Q);const X=Math.ceil(Object(Q["cpus"])().length/2)||3,ee=10*X;function te(e,t){const n=new Array(X);console.log(`Init workers for ${t}`),console.log(`Workers num: ${X}`);const r=[];function o(e,t,n,s){if(t.busy)return console.log("busy"),r.push({workerData:e,resolve:n,reject:s});function a(){if(r.length){const{workerData:e,resolve:n,reject:s}=r.shift();return o(e,t,n,s)}}function i(e){t.busy=!1,n(e),a()}t.busy=!0,t.worker.once("message",i),e||console.error("not workerdata found"),t.worker.postMessage(e)}const s=()=>n.map((e=>e&&e.busy?1:0));async function a(a){return new Promise(((i,l)=>{for(let r=0;r<X;r++){n[r]||(n[r]={busy:!1,worker:new Z["Worker"](e,{eval:!0})},console.log(`Init worker#${r} for ${t}`),n[r].worker.on("error",console.error));const s=n[r];if(!s.busy)return o(a,s,i,l)}s();r.push({workerData:a,resolve:i,reject:l}),r.length>ee&&console.warn("Warning: Max queue length exceeded",r.length,t)}))}return{workerStatus:s,queueTask:a}}const ne=e=>{try{if(Array.isArray(e))return!0;if(e[0])return!0}catch(t){return!1}return!1},re=(e,t,{removeSpeeds:n,removeSessionData:r}={})=>{if(!e)return t;if(!t)return e;if(ne(t))return console.log("cur is array",t),e;if(e.infoHash!==t.infoHash)return t;const o={};for(const u in t){var s;if("trackers"!==u)if(["downloadSpeed","uploadSpeed"].includes(u))n||(o[u]=t[u]);else if(!r||!["peersNum","hasMetadata","ready","timeRemaining","connections","byteMap","pieceMap","trackerList","verifyStatus","waiting"].includes(u))if(u in e)if("pauseByApp"!==u||t.paused)if("progress"!==u&&"downloaded"!==u)if("object"!==typeof t[u]||["connections","customTrackers","verifiedPieces"].includes(u))o[u]=null!==(s=t[u])&&void 0!==s?s:e[u];else if(o[u]=[],Array.isArray(t[u]))for(let n=0;n<Math.max(null===(a=t[u])||void 0===a?void 0:a.length,null===e||void 0===e||null===(i=e[u])||void 0===i?void 0:i.length);n++){var a,i,l,c;null!==(l=t[u])&&void 0!==l&&l[n]?o[u].push(t[u][n]):null!==e&&void 0!==e&&null!==(c=e[u])&&void 0!==c&&c[n]&&o[u].push(e[u][n])}else o[u]=re(e[u],t[u],{removeSpeeds:n,removeSessionData:r});else t.hasMetadata&&t.ready?o[u]=t[u]:o[u]=e[u];else delete o[u];else o[u]=t[u]}for(const u in e)u in t||"trackers"===u||(o[u]=e[u]);return o.trackers&&delete o.trackers,o};new Map;function oe(e,t,n){if(!e)return t;if(!t)return e;const r=re(e,t,n);return r}var se=n(37),ae=n.n(se);const ie=n(68),le=n(3),{existsSync:ce,unlinkSync:ue}=n(1);class pe extends ie{constructor(...e){super(...e),this._hashMap=new Map,this.get("torrents").forEach((e=>this._hashMap.set(e.infoHash,e)))}delTorrent(e){const t=this.get("torrents");if(e&&t){const n=t.findIndex((t=>t.infoHash===e||t.token===e));-1!==n&&(t.splice(n,1),this.set("torrents",t.filter((e=>!ae()(e))))),this._hashMap.delete(e)}}async updateTorrent(e){if(e&&e.isAutoUpload)return;let t=[];this.get("torrents")&&(t=this.get("torrents"));let n=!0;t=(await Promise.all(t.map((t=>t.infoHash===e.infoHash?(n=!1,oe(t,e,{removeSpeeds:!0,removeSessionData:!0})):t)))).filter((e=>e.infoHash)),n?this.setTorrent(e):this.set("torrents",t.filter((e=>!ae()(e))))}async updateTorrents(e){if(!e.length)return;const t=this.get("torrents");for(const r of e){let e=!0;for(const n in t){const o=t[n];o.infoHash===r.infoHash&&(e=!1,t[n]=oe(o,r,{removeSpeeds:!0,removeSessionData:!0}),this._hashMap.set(r.infoHash,t[n]))}e&&(t.push(r),this._hashMap.set(r.infoHash,r))}const n=t.filter((e=>!e.isAutoUpload&&!ae()(e)));this.set("torrents",n)}getTorrent(e){return e?this._hashMap.has(e)?this._hashMap.get(e):this.get("torrents").find((t=>t.infoHash===e)):this.get("torrents")||[]}setTorrent(e){let t=[];this.get("torrents")&&(t=this.get("torrents")),t.push(e),this.set("torrents",t.map((e=>({...e,downloadSpeed:0,uploadSpeed:0}))).filter((e=>!ae()(e))))}setConfig(e){this.set("settings",e)}getConfig(){return this.get("settings")}setOrders(e){return this.set("orders",e)}getOrders(){return this.get("orders")}clear({destroyStore:e=!1}={}){if(e){const e=super.get("torrents");e.forEach((e=>{e.files.forEach((({path:e})=>{ce(e)&&ue(e)}))}))}super.clear()}}var de=new pe({cwd:le.join(r["app"].getPath("userData"),"config"),defaults:{torrents:[],orders:[]}}),fe="const { parentPort, workerData } = require('worker_threads')\n\nconst statusSortFn = (a, b) => {\n  if (a.paused && !b.paused) return 1\n  if (b.paused && !a.paused) return -1\n  if (a.pending && !b.pending) return 1\n  if (b.pending && !a.pending) return -1\n  if (a.hasMetadata && !b.hasMetadata) return -1\n  if (b.hasMetadata && !a.hasMetadata) return 1\n  if (a.ready && !b.ready) return -1\n  if (b.ready && !a.ready) return 1\n  if (a.done && !b.done) return 1\n  if (b.done && !a.done) return -1\n  if (a.waiting && !b.waiting) return 1\n  if (b.waiting && !a.waiting) return -1\n  return -1\n}\n\n/**\n * @typedef { {\n *   sequence: boolean,\n *   key: string,\n *   list: Array<import('../../../src/types').TorrentInfo>\n * } } WorkerData\n */\n/** @param { WorkerData } workerData */\nconst sortTorrents = (workerData) => {\n  const torrents = workerData.list\n  const key = workerData.key\n  if (key === 'status') {\n    return torrents.sort((a, b) => {\n      return statusSortFn(a, b) * workerData.sequence\n    })\n  }\n  switch (key) {\n    case 'downloadSpeed':\n    case 'downloaded':\n    case 'uploadSpeed':\n    case 'uploaded':\n    case 'timeRemaining':\n    case 'progress':\n    case 'usedTime':\n      return torrents.sort((a, b) => {\n        if (typeof a[key] !== 'number') {\n          if (typeof b[key] !== 'number') return 0\n          return 1\n        } else if (typeof b[key] !== 'number') {\n          return -1\n        }\n        if (a.waiting) {\n          if (!b.waiting) return 1\n        }\n        if (!a.hasMetadata) {\n          if (!b.hasMetadata) return 0\n          return 1\n        } else if (!b.hasMetadata) {\n          return -1\n        }\n        if (a.paused) {\n          if (b.paused) return 0\n          return 1\n        } else if (b.paused) {\n          return -1\n        }\n        return (a[key] - b[key]) * workerData.sequence\n      })\n    case 'length':\n      return torrents.sort((a, b) => {\n        if (!a[key] && !b[key]) return 0\n        if (!b[key]) return -1\n        if (!a[key]) return 1\n        return (a[key] - b[key]) * workerData.sequence\n      })\n    case 'createdTime':\n    case 'completedTime':\n      return torrents.sort((a, b) => {\n        if (!b || !b[key]) return 1\n        if (!a || !a[key]) return -1\n        if (typeof a[key] !== 'number') {\n          if (typeof b[key] !== 'number') return 1\n          return -1\n        }\n        if (typeof b[key] !== 'number') return 1\n        return -(a[key] - b[key]) * workerData.sequence\n      })\n    case 'name':\n      return torrents.sort((a, b) => {\n        if (!a[key]) return -1\n        if (!b[key]) return 1\n        return a[key].localeCompare(b[key]) * workerData.sequence\n      })\n    default:\n      return torrents\n  }\n}\n\n// parentPort.postMessage(sortAll(workerData.list))\nparentPort.on('message', data => {\n  parentPort.postMessage(sortTorrents(data))\n})\n";const{queueTask:he}=te(fe,"sortTorrent");async function ge(e,t,n){return await Promise.all(Object.keys(e).map((async r=>Array.isArray(e[r])?(e[r]=await he({list:e[r],key:t,sequence:n}),r):r))),e}n(36),n(155);var me=n(108),ve=n.n(me);let ye;if(ve.a.main())ye=n(160),Object.defineProperty(global,"lzma",{get(){return ye}});else{const e=n(161).default;ye=new e,Object.defineProperty(window,"lzma",{get(){return ye}})}var we=ye,be=(n(98),n(67),n(18)),Se=n.n(be);const ke=e=>{const t="magnet:?xt=urn:btih:"+e.hash+"&dn="+(encodeURIComponent(e.name)||e.origin||e.hash).replace("alphabiz:///","");let n="";if(e.trackers&&(n+=e.trackers.filter((e=>e.length)).map((e=>`&tr=${encodeURIComponent(e)}`)).join("")),e.data)for(const o in e.data){var r;null!==(r=e.data[o])&&void 0!==r&&r.length&&(n+=e.data[o].map((e=>`&${o}=${encodeURIComponent(e)}`)).join(""))}return t+n},_e=e=>{var t;const n=new URL(e);if("magnet:"!==n.protocol)throw new Error("Input is not a magnet uri");const r=n.searchParams.get("xt"),o=null===(t=r.match(/[^:]+$/))||void 0===t?void 0:t[0];if(!o)throw new Error("Cannot parse magnet infoHash");const s=n.searchParams.get("dn")||"",a=n.searchParams.getAll("tr").map((e=>{const t=Se.a.getIdByTracker(e);return-1!==t?t:e})),i={};return n.searchParams.forEach(((e,t)=>{["xt","dn","tr"].includes(t)||(i[t]||(i[t]=[]),i[t].push(e))})),{protocolType:"01",hash:o,name:s,trackers:a,data:i}};var xe={fromObject:ke,toObject:_e};function Ue(e){return Buffer.from(e,"utf-8").toString("hex")}function Ce(e){return Buffer.from(e,"hex").toString("utf-8")}var Te={fromObject(e){const{protocolType:t,name:n,hash:r,data:o}=e,s=o.type||"channel";return"02"!==t?null:`ab-library://${s}/${decodeURIComponent(n)}/${Ce(r)}`},toObject(e){if(console.log("lib toObj",e),!e.startsWith("ab-library://"))return null;const[t,n,r]=e.replace("ab-library://","").split("/"),o={};return"channel"!==t&&(o.type=t),{protocolType:"02",name:encodeURIComponent(n),hash:Ue(r),data:o}}};const Pe={type:"03",prefix:"ab-blockchain"},Ae={encode:e=>Buffer.from(e,"utf-8").toString("hex"),decode:e=>Buffer.from(e,"hex").toString("utf-8")},Oe={encode:e=>Buffer.from(e,"utf-8").toString("base64"),decode:e=>Buffer.from(e,"base64").toString("utf-8")},Re={stringifyProtocolObject(e){const t=JSON.parse(Ae.decode(e.hash)),n=e.data,r={to_address:t.to_address,coin_type:n.coin_type,amount:n.amount,expiration:n.expiration},o=Oe.encode(JSON.stringify(r));return[t.action,o].join("/")},parseProtocolObject(e){const t=`Transfer to ${e.to_address.substr(2,10)}`,n=JSON.stringify({action:"transfer",to_address:e.to_address}),r={};return["coin_type","amount","expiration"].forEach((t=>{r[t]=e[t]})),{name:t,id:n,data:r}}},Ee={transfer:Re},Le=e=>{if(!e.startsWith(`${Pe.prefix}://`))return null;const[t,n]=e.replace(`${Pe.prefix}://`,"").split("/");if(!Ee[t])throw new Error("Unexpected action: "+t);const r=JSON.parse(Oe.decode(n));return{action:t,actionArgs:r}},je=(e,t)=>{const n=Oe.encode(JSON.stringify(t));return`${Pe.prefix}://${[e,n].join("/")}`};var Ie={config:Pe,parseAction:Le,stringifyAction:je,fromObject(e){if(e.protocolType!==Pe.type)return null;const{action:t}=JSON.parse(Ae.decode(e.hash));if(!Ee[t])throw new Error("Unexpected action: "+t);return`${Pe.prefix}://${Ee[t].stringifyProtocolObject(e)}`},toObject(e){const{action:t,actionArgs:n}=Le(e),{name:r,id:o,data:s}=Ee[t].parseProtocolObject(n);return{protocolType:Pe.type,name:encodeURIComponent(r),hash:Ae.encode(o),data:s}}};const Me=e=>encodeURIComponent(e.trim().replace(/\s+/g," ")),De=async e=>{const t=Me(e.name||"alphabiz_task"),n=Buffer.from(e.protocolType+e.hash,"hex").toString("base64").replace(/\//g,"_"),r=t.replace(/\s/g,"+").replace(/_/g,"+d;").replace(/\//g,"_").replace(/&/g,"+amp;")+"/"+n,o=[],s=[];for(const l of e.trackers||[])"number"===typeof l?o.push(l.toString(16)):s.push(l);let a=o.map((e=>("0000"+e).slice(-4))).join("");s.length&&(a=a+"&tr="+s.join("&"));for(const l in e.data)Array.isArray(e.data[l])?a=a+"&"+l+"="+e.data[l].join(""):"string"===typeof e.data[l]&&(a=a+"&"+l+"="+e.data[l]);const i=(await we.compress(a,9)).toString("base64");return a=Buffer.from(a).toString("base64"),a.length>1.1*i.length&&(a=i),a.length?"alphabiz://"+r+"&"+a.replace(/\//g,"_"):"alphabiz://"+r},He=async e=>{if(!e.startsWith("alphabiz://"))return null;const t=e.replace("alphabiz://","").replace(/\/+$/,"").split("&");t.length>2&&console.error("str is invalid alphabiz uri");const[n,r]=t,o=n.lastIndexOf("/");if(-1===o)return null;const s=n.substring(0,o).replace(/\+amp;/g,"&").replace(/_/g,"/").replace(/\+d;/g,"_").replace(/\+/g," ")||"",a=n.substring(o+1),i=Buffer.from(a.replace(/_/g,"/"),"base64").toString("hex"),l=i.substring(0,2),c=i.substring(2);let u="";try{const e=Buffer.from(r.replace(/_/g,"/"),"base64");console.log("buffer",e);const t=await we.decompress(e);t&&(u=t.toString("base64"))}catch(m){console.log("LZMA decompress failed.",m.message),u=r||""}const p=Buffer.from(u,"base64").toString().split("&"),[d,...f]=p,h=[];if(d.includes("="))f.unshift(d);else for(let v=0;v<d.length;v+=4){const e=parseInt(d.substring(v,v+4),16),t=Se.a.getTrackerById(e);t&&h.push(t)}const g={};for(const v of f)if(v.startsWith("tr="))h.push(v.substring(3));else if(v.includes("=")){const[e,t]=v.split("=");g[e]||(g[e]=[]),g[e].push(t)}else h.push(v);return{protocolType:l,name:decodeURIComponent(s),hash:c,trackers:h,data:g,origin:e}},$e=[],Fe=new Map;let ze=!1;const qe=()=>{if(!$e.length)return Fe.clear(),void(ze=!1);const e=$e.shift();if(!e||!Fe.has(e))return qe();ze=!0;const t=Fe.get(e);Fe.delete(e),De(xe.toObject(t.url)).then((e=>{"function"===typeof t.cb&&t.cb(null,e),Array.isArray(t.cb)&&t.cb.forEach((t=>{"function"===typeof t&&t(null,e)}))})).catch((e=>{console.error(e),t.cb(e)})).finally((()=>{ze=!1,qe()}))},Be=async(e,t)=>{const{hash:n,url:r}=e;if(!r)return console.log("error encoding",e),t(new Error(n),r);if(r.startsWith("magnet")){const e=Date.now();if($e.includes(n)){const r=Fe.get(n);if(r){if(e-r.timestamp<5)return void(Array.isArray(r.cb)?r.cb.push(t):r.cb=[r.cb,t]);"function"===typeof r.cb?r.cb(new Error(`Cannot encode ${r.url}`)):Array.isArray(r.cb)&&r.cb.forEach((e=>{"function"===typeof e&&e(new Error(`Cannot encode ${r.url}`))})),Fe.delete(n)}else $e.splice($e.indexOf(n),1)}return Fe.set(n,{url:r,timestamp:e,cb:t}),$e.push(n),void(ze||qe())}if(r.startsWith("ab-library")){const e=await De(Te.toObject(r));return t(null,e)}if(r.startsWith(Ie.config.prefix)){const e=await De(Ie.toObject(r));return t(null,e)}return console.log("error encoding",e),t(new Error(n),r)},Ne=async e=>{const t=await He(e.startsWith("ab:")?e.replace("ab://","alphabiz://-/"):e);switch(t.protocolType){case"01":return xe.fromObject(t);case"02":return Te.fromObject(t);case Ie.config.type:return Ie.fromObject(t)}throw console.log(t),new Error(`Unsupported protocol type ${t.protocolType}`)};var We={encode:Be,decode:Ne};const Ge=[".DS_Store","Thumbs.db"];function Ke(e){if(Ge.includes(Object(o["basename"])(e)))return!0;if(Object(a["statSync"])(e).isDirectory()){const t=Object(a["readdirSync"])(e);return!t.length||t.every((t=>Ke(Object(o["resolve"])(e,t))))}return!1}const Ve=e=>{if(!e)return null;try{let t=s.a.dirname(e[0]);for(let n=1;n<e.length;n++)while(!e[n].includes(t)&&t.length>1)t=s.a.dirname(t);return t}catch(t){return null}};class Je extends Map{push(...e){for(const t of e){if(!t)continue;if(!t||"object"!==typeof t)continue;if(!t.infoHash&&t.token&&([...super.values()].some((e=>!!(e.name&&e.name===t.name||e.token&&e.token===t.token||e.origin&&e.origin===t.origin)))&&console.log("may duplicate!"),super.set(t.token,t)),!t.infoHash)continue;if(Array.isArray(t)||t[0])throw new Error("find array");const e=super.get(t.token);e&&e.token&&e.token===t.token?(super.delete(t.token),super.set(t.infoHash,t)):super.set(t.infoHash,t)}return super.size}get length(){return this.size}}function Ze({io:e,win:t,max:n=5}){return{max:n,downloading:new Je,uploading:new Je,pending:new Je,paused:new Je,downloaded:new Je,clear(){this.downloading.clear(),this.uploading.clear(),this.pending.clear(),this.paused.clear(),this.downloaded.clear()},isMax(){return this.downloading.length>=this.max},findIndex(e,t){return-1},find(e,t){return t.get(e)},findAll(e){for(const t of this.torrents()){const n=this.find(e,t);if(n)return n}return null},pop(e,t){if(t.has(e)){const n=t.get(e);return t.delete(e),n}return null},popFromAll(e){let t=null;for(const n of this.torrents()){const r=this.pop(e,n);r&&(t=r)}return t},isPaused(e){return!!e&&("string"!==typeof e?this.paused.has(e.infoHash||e.token):this.paused.has(e))},isPending(e){return"string"!==typeof e?this.pending.has((null===e||void 0===e?void 0:e.infoHash)||(null===e||void 0===e?void 0:e.token)):this.pending.has(e)},isDownloading(e){return this.downloading.has(e)},has(e){return this.torrents().some((t=>t.has(e)))},pend(e){const n=this.popFromAll(null===e||void 0===e?void 0:e.infoHash);n?(n.pending=!0,this.pending.push(n)):(e.pending=!0,this.pending.push(e)),t.webContents.send("pend-torrent",e)},async download(e,n=!1){let r=e.infoHash||e.token||e.origin;if(r.startsWith("alphabiz://")&&(r=await We.decode(r)),i.a.existsSync(r)?e.torrentPath=r:i.a.existsSync(e.origin)&&(e.torrentPath=e.origin),e.trackers?e.trackers=[...new Set((e.trackers||[]).concat(Ft.getUserSettings("trackerList")))]:e.trackers=Ft.userSettings.get("trackerList"),this.isPaused(e.infoHash)||this.isPending(e.infoHash)){const t=this.pop(e.infoHash,this.paused)||this.pop(e.infoHash,this.pending);return t.paused=!1,t.pending=!1,de.updateTorrent(t),this.downloading.push(t),this.download(e)}e.createdTime||(e.createdTime=Date.now()),t.webContents.send("add-torrent",r,e),n||this.next()},async downloadAll(e,t){let n=0;for(const o of e){var r;console.log(n++,o),await this.download({infoHash:(null===(r=o.match(/([0-9a-fA-F]{40})/))||void 0===r?void 0:r[1])||o,path:(null===t||void 0===t?void 0:t.path)||t.downloadDirectory,token:o,origin:o,trackers:t.trackers},!0)}console.log("Add all torrents"),this.next()},upload(n,r=!1,o=!1,a=!1){console.log("upload",n);const l=n.missFile;n.missFile=!1,n.missAllFile=!0,n.trackers=[...new Set((n.trackers||[]).concat(Ft.getUserSettings("trackerList")))];const c=[];if(this.pop(n.infoHash,this.paused),this.pop(n.infoHash,this.downloaded),this.findAll(n.infoHash)&&(console.warn("Torrent may add duplicating",n.infoHash),this.popFromAll(n.infoHash)),r)for(const e of this.torrents());if(c.push("---"),n.files)for(const e of n.files)i.a.existsSync(e.path)||1!==e.progress?n.missAllFile=!1:(n.missFile=!0,n.upload=!1,n.isSeeding=!1,n.download=!1,e.missing=!0,c.push(e.path));if(n.missFile&&!l){if(this.downloaded.push(n),console.log("miss file",o),o)return;return e.emit("torrent_seed_error",n,c)}if(n.file&&(!n.files||!n.files.length)){if(!n.file.length||n.file.every((e=>Ke(e))))return e.emit("torrent_error",{token:n.token,torrent:n,message:"empty_files"});if(n.file.length&&(n.path||(n.path=Ve(n.file),console.log("add conf.path",n.path)),!n.name))if(1===n.file.length){if(n.name=s.a.basename(n.file[0]),r)for(const t of[...this.uploading.values(),...this.downloaded.values()])if(t.file&&1===t.file.length&&t.file.includes(n.file[0]))return e.emit("torrent_error",{token:n.token,torrent:n,message:"duplicate_task"})}else n.name=s.a.basename(n.path),n.path=s.a.dirname(n.path)}n.token||(n.token=n.name);const u=this.uploading.push(n);if(!1!==u){if(n.isSeeding=!0,a)return n;t.webContents.send("seed-torrent",n)}else console.log("Upload duplicate",u),e.emit("torrent_error",{token:n.token,torrent:n,message:"duplicate_task"})},pause(n,r=!1){console.log("Pause",n);const o=this.popFromAll(n);e.emit("pause_torrent",n),t.webContents.send("stop-torrent",n),o&&(o.pending=!1,o.paused=!0,o.infoHash?this.paused.push(o):this.downloaded.push(o),r||this.next())},pendSlowest(){let e,t;for(const[n,r]of this.downloading){if(!r.ready&&!r.hasMetadata){e=n,t=r;break}e&&t?r.timeRemaining>t.timeRemaining&&(e=n,t=r):(e=n,t=r)}return t&&(this.pend(t),console.log("pendSlowest",e,t.timeRemaining)),t},delete(e,n=!1){de.delTorrent(e),console.log("To delete:",e,n&&"destroy store");const o=this.popFromAll(e);if(!o)return de.delTorrent(e);if(!o.torrentPath||Ft.getUserSettings("saveLinkSeed")&&!o.torrentPath.includes(r["app"].getPath("userData"))||i.a.existsSync(o.torrentPath)&&i.a.rmSync(o.torrentPath),t.webContents.send("delete-torrent",e,n),!n)return de.delTorrent(e);if(o.paused||o.pending&&!o.isSeeding||o.done&&!o.isSeeding){var s,a;null===(s=o.files)||void 0===s||s.forEach((e=>{const t=(null===e||void 0===e?void 0:e.path)||e;i.a.existsSync(t)&&i.a.unlinkSync(t)}));const e=Ve((null===(a=o.files)||void 0===a?void 0:a.map((e=>e.path||e)))||[]);if(i.a.existsSync(e)&&Ft.getUserSettings("downloadDirectory")!==e&&Ft.getUserSettings("uploadDirectory")!==e&&0===i.a.readdirSync(e).filter((e=>![".DS_Store","Thumbs.db"].includes(e))).length)try{i.a.rmSync(e,{recursive:!0}),console.log("Unlink",e)}catch(l){}de.delTorrent(o.infoHash)}},remove(e){for(const t of this.torrents())t.has(e)&&t.delete(e)},next(){for(const[e,t]of this.downloading.entries())t?t.isSeeding?(this.downloading.delete(e),this.uploading.push(t)):t.done&&(this.downloading.delete(e),this.downloaded.push(t)):this.downloading.delete(e);for(const[e,t]of this.downloaded.entries())t?t.missFile||t.paused||(console.log("move to uploading",e,t.name,t.paused),this.downloaded.delete(e),this.uploading.push(t)):this.downloaded.delete(e);for(const[e,t]of this.uploading.entries())t?t.isAutoUpload||t.missFile||(t.paused||t.missFile?(console.log("move to downloaded",e,t.name,t.paused,t.missFile),this.uploading.delete(e),this.downloaded.push(t)):t.isSeeding||t.upload||!t.ready||(this.uploading.delete(e),console.log("add to downloading",t),this.downloading.push(t))):(this.uploading.delete(e),console.log("slice"));for(const[e,t]of this.paused.entries())t?(t.done||1===t.progress)&&(this.paused.delete(e),this.downloaded.push(t)):this.paused.delete(e);if(this.isMax()){if(this.downloading.size===this.max)return;const e=[];let t=0;for(const[n,r]of this.downloading.entries())t++,t>this.max&&(e.push(r),this.downloading.delete(r));console.log("Maximun task, rests:",e.length),e.forEach((e=>{e.done||e.upload||e.isSeeding?this.upload(e):this.pend(e)}))}else{if(!this.pending.length)return;const e=[...this.pending.keys()][0];if(!e)return;const t=this.pending.get(e);t&&(this.pending.delete(e),t.upload?this.upload(t):(this.downloading.push(t),this.download(t,!0)))}},torrentList(){return{downloading:[...this.downloading.values()],pending:[...this.pending.values()],paused:[...this.paused.values()],uploading:[...this.uploading.values()],downloaded:[...this.downloaded.values()]}},torrentDisplayList(){const e=this.torrentList(),t=[].concat(e.downloading,e.pending,e.paused.filter((e=>!e.isSeeding)));let n=0,r=!1;const o=[0,0];t.forEach((e=>{if(!e.pending&&(e.paused||!e.ready)||!e.length){if(!e.download||!e.downloaded||e.paused||!e.downloadSpeed)return;n-=e.downloadSpeed}o[0]+=e.downloaded,o[1]+=e.length,"number"!==typeof e.downloadSpeed||e.pending||e.paused||(n+=e.downloadSpeed),r=!0}));const s=o[1]?o[0]/o[1]:0,a=e.uploading,l=a.reduce(((e,t)=>t.paused||t.uploadSpeed<=0||isNaN(Number(t.uploadSpeed))?e:e+Number(t.uploadSpeed)),0)||0;e.downloaded.forEach((e=>{if(e.missFile=!1,e.missAllFile=!0,e.file&&e.file.length){e.path||(e.path=Ve(e.file));for(const t of e.file)i.a.existsSync(t)?e.missAllFile=!1:e.missFile=!0}if(e.files)for(const t of e.files)i.a.existsSync(t.path)?e.missAllFile=!1:(e.missFile=!0,e.upload=!1,e.isSeeding=!1,e.download=!1,t.missing=!0)}));const c={downloading:t,totalDownloadProgress:s,totalDownloadSpeed:n,uploading:a,totalUploadSpeed:l,downloaded:[...e.downloaded,...e.paused.filter((e=>e.isSeeding))]};try{r?global.win.setProgressBar(s):global.win.setProgressBar(-1)}catch(u){}return c},torrents(){return[this.downloading,this.uploading,this.paused,this.pending,this.downloaded]}}}async function Qe({ipcMain:e,win:t,io:n}){const r=[],o=e=>{try{var n;null===t||void 0===t||null===(n=t.webContents)||void 0===n||n.send("set-user",e)}catch(r){}};n.on("set_user",o),r.push((()=>n.off("set_user",o)));const s=(e,t)=>{n.emit("request-provident-payment",t)};e.on("request-provident-payment",s),r.push((()=>e.off("request-provident-payment",s)));const a=e=>{try{var n;null===t||void 0===t||null===(n=t.webContents)||void 0===n||n.send("payment-info",e)}catch(r){}};n.on("credit_payment_created",a),r.push((()=>n.off("credit_payment_created",a)));const i=e=>{var n;return null===t||void 0===t||null===(n=t.webContents)||void 0===n?void 0:n.send("restart-payment",e)};n.on("restart_payment",i),r.push((()=>n.off("restart_payment",i)));const l=e=>{try{var n;null===t||void 0===t||null===(n=t.webContents)||void 0===n||n.send("payment-verified",e)}catch(r){}};n.on("payment_verified",l),r.push((()=>n.off("payment_verified",l)));const c=(e,t)=>{n.emit("request_renew",t)};e.on("webtorrent-request-renew",c),r.push((()=>e.off("webtorrent-request-renew",c)));const u=(e,t)=>{console.log("Finished",t.id),n.emit("payment_finished",t)};e.on("webtorrent-payment-finished",u),r.push((()=>e.off("webtorrent-payment-finished",u)));const p=(e,t)=>{if(null===t||void 0===t||!t.connections)return;const r=t.connections;r.forEach((e=>{e.transactions&&e.transactions.forEach((e=>{console.log("finish pending pament",e),n.emit("payment_finished",{id:e})}))}))};e.on("webtorrent-finish-all-payments",p),r.push((()=>e.off("webtorrent-finish-all-payments",p)));const d=(e,t)=>{0!==t.code&&n.emit("client_error",t.message)};e.on("webtorrent-set-throttle",d),r.push((()=>e.off("webtorrent-set-throttle",d)));const f=(e,t)=>{n.emit("verify_payment",t)};e.on("webtorrent-verify-payment",f),r.push((()=>e.off("webtorrent-verify-payment",f)));const h=(e,t)=>{n.emit("payment_completed",t)};e.on("webtorrent-payment-completed",h),r.push((()=>e.off("webtorrent-payment-completed",h)));const g=e=>{try{var n;null===t||void 0===t||null===(n=t.webContents)||void 0===n||n.send("complete-payment",e)}catch(r){}};n.on("complete_payment",g),r.push((()=>n.off("complete_payment",g)));const m=e=>{try{var n;null===t||void 0===t||null===(n=t.webContents)||void 0===n||n.send("finish-payment",e)}catch(r){}};n.on("finish_payment",m),r.push((()=>n.off("finish_payment",m)));const v=e=>{try{var n;null===t||void 0===t||null===(n=t.webContents)||void 0===n||n.send("close-payment",e)}catch(r){}};n.on("payment_closed",v),r.push((()=>n.off("payment_closed",v)));const y=({infoHash:e,id:n,subId:r,level:o})=>{try{var s;null===t||void 0===t||null===(s=t.webContents)||void 0===s||s.send("set-throttle-group",{infoHash:e,peerId:n,subId:r,level:o})}catch(a){}};return n.on("set_throttle_group",y),r.push((()=>n.off("set_throttle_group",y))),function(){r.forEach((e=>{"function"===typeof e&&e()}))}}n(169);const Ye=e=>!e.startsWith(".")&&(![".ini",".tmp",".log",".torrent",".db"].some((t=>e.endsWith(t)))&&!(e.includes("$RECYCLE.BIN")||e.includes(".thumbs.db")||e.includes("Thumbs.db")));function Xe(e){const t=Object(a["readdirSync"])(e);for(let n=0;n<t.length;n++){if(!Ye(t[n])){t.splice(n--,1);continue}const r=Object(o["resolve"])(e,t[n]);Object(a["statSync"])(r).isDirectory()?t[n]=Xe(r):t[n]=r}return console.log("read",t,e),t.flat(1/0)}const et=()=>{const e=process.resourcesPath,t="darwin"===process.platform?"trayiconTemplate.png":"alphabiz-icon-1024.png",n=r["nativeImage"].createFromPath(Object(o["resolve"])(e,t)).resize({width:16,height:16});return"darwin"===process.platform&&n.setTemplateImage(Object(o["resolve"])(e,t)),n};let tt=null;const nt=async()=>{await r["app"].whenReady(),tt&&tt.destroy(),console.log("set Tray");__dirname;tt=new r["Tray"](et());const e=r["Menu"].buildFromTemplate([{label:Dt.$t("open",["Alphabiz"]),click(){global.win&&global.win.show()}},{label:Dt.$t("quit"),click(){r["app"].isQuitting=!0,r["app"].quit()}}]);tt.setContextMenu(e),tt.setTitle(""),tt.setToolTip(Dt.$t("is_running",["Alphabiz"])),tt.on("click",(()=>{global.win&&global.win.show()})),tt.on("double-click",(()=>{global.win&&global.win.show()})),tt.on("right-click",(()=>{tt.popUpContextMenu()}))},rt=({title:e,tooltip:t})=>{tt&&!tt.isDestroyed()&&(void 0!==e&&tt.setTitle(e),void 0!==t&&tt.setToolTip(t))};function ot(e,{byte:t=!0,gb:n=!0}={}){if("number"!==typeof e)return"-";if(e<1e3&&t)return e.toFixed(2)+" Byte";const r=e/1e3;if(isNaN(r))return"0 Byte";if(r<1e3)return r.toFixed(2)+" KB";const o=r/1e3;if(o<1e3||!n)return o.toFixed(2)+" MB";const s=o/1e3;return s.toFixed(2)+" GB"}r["app"].whenReady().then((()=>{Ft.onLocaleChange(nt)})),r["app"].on("before-quit",(()=>{r["app"].isQuitting&&tt&&!tt.isDestroyed()&&tt.destroy()}));var st=n(109);const at=async(e,t,n)=>{const{free:r}=await Object(st["check"])(e),o=t.reduce(((e,t)=>{if(!t.ready||isNaN(t.length)||isNaN(t.downloaded))return e;const n=t.length-t.downloaded;return e+n}),0);return{free:r,need:o,minSpace:n,needMoreSpace:o>=r-n}};function it({torrentManager:e,configManager:t}){let n={},r=!1;const o=async()=>{if(!r){r=!0;try{const r=!n.needMoreSpace;var o;if(n=await at(t.getUserSettings("downloadDirectory"),[...e.downloading.values()],t.getUserSettings("minDiskSpace")||512e6),n.needMoreSpace&&r)null===(o=global.win)||void 0===o||o.webContents.send("need-more-space",n)}catch(s){console.log("Error @ check disk usage",s)}setTimeout((()=>{r=!1}),5e3)}},s=setInterval((()=>{o()}),6e4);return{cancel:function(){clearInterval(s)},check:function(){o()}}}const lt=n(1),ct=e=>!!lt.existsSync(e)&&lt.statSync(e).isDirectory(),ut=["mp3","wav","aac","flac","m4a","wma"],pt=["mp4","mkv","flv","avi","mov","wmv","rmvb","flv","webm"];function dt(e){if(!e)return!1;if(console.log("not empty",e),ct(e))return!1;console.log("not directory");const t=e.match(/\.[^.]+?$/);if(console.log("ext",t),!t)return!1;const n=t[0].substr(1);return!!n.length&&(ut.includes(n)||pt.includes(n))}"win32"===process.platform&&r["app"].setAppUserModelId("Alphabiz"),global.__statics=__dirname;let ft=null;const ht={ready:new Promise((e=>ft=e))};var gt=ht;let mt=null,vt=null,yt=null,wt=null,bt=!1;const St={enabled:!1,ready:!1,addressSent:!1,file:"",fileindex:0,address:"",infoHash:"",filepath:""},kt=e=>{St.infoHash===e&&(Object.assign(St,{enabled:!1,ready:!1,addressSent:!1,file:"",fileindex:0,address:"",infoHash:"",filepath:""}),mt&&mt.webContents.send("stop-server"))};let _t=null,xt=process.env.DISABLE_FORCE_LOGIN||process.argv.includes("--disable-force-login");const Ut=(e=Ft.getUserSettings("uploadDirectory"))=>{if(console.log("watch upload directory",e),_t&&(_t.close(),_t=null),!i.a.existsSync(e))return console.log("cannot find upload dir",e);if(e===Ft.getUserSettings("downloadDirectory"))return console.log("Cannot set same directory for download and upload");const t=e=>{console.log("trigger auto upload",e),mt?mt.webContents.send("autoupload-files",e):setTimeout((()=>t(e)),1e3)},n=(e,t)=>{let n=null;return(...r)=>{clearTimeout(n);n=setTimeout((()=>e(...r)),t)}};let r=!1;const o=n((()=>{if(!Ft.getUserSettings("autoUpload"))return t([]),console.log("skip autoUpload");const n=Xe(e).filter((e=>{try{return i.a.accessSync(e,i.a.constants.R_OK|i.a.constants.W_OK),!0}catch(t){return!1}}));if(n.length>10&&!Ft.getUserSettings("unlimitUploadAmount")){if(t([]),r)return;J.emit("request_unlimit_upload"),r=!0}else r=!1,t(n)}),1e3);if(!xt)return console.log("User is not logged in, skip auto upload"),t([]);_t=i.a.watch(e,{recursive:!0},o),o()};r["app"].whenReady().then((()=>{Ft.getUserSettings("forceLogin")||(xt=!0),r["protocol"].registerFileProtocol("play",((e,t)=>{kt(St.infoHash);const[n]=e.url.replace(/^play/,"file").split("?"),r=decodeURI(n);console.log("Play:",Object(B["fileURLToPath"])(r)),t(Object(B["fileURLToPath"])(r))}))}));const Ct=e=>{try{return decodeURIComponent(e)}catch(t){return"alphabiz-task"}},Tt=async()=>{var e;if(!await Bt)return void console.log("dont create webtorrent",await Bt);if(null!==mt)return;mt=new r["BrowserWindow"]({show:!1,width:200,height:200,skipTaskbar:!0,x:0,y:0,title:"webtorrent-hidden",webPreferences:{webSecurity:!1,nodeIntegration:!0,nodeIntegrationInWorker:!0,contextIsolation:!1,v8CacheOptions:"none",enableRemoteModule:!0,backgroundThrottling:!1}});const t="file://"+__dirname+"/index.html";mt.loadURL(t.replace("index","webtorrent")),mt.on("close",(e=>{r["app"].isQuitting?mt=null:(e.preventDefault(),mt.hide())})),mt.on("ready-to-show",(()=>{const e=Ft.getUserSettings();mt.webContents.send("set-client",{downloadLimit:e.downloadSpeed,uploadLimit:e.uploadSpeed,maximumConnectionsNum:e.maximumConnectionsNum})})),vt=Ze({io:J,win:mt,max:Ft.getUserSettings("maximumDownloadNum")||5}),global.torrentManager=vt,"function"===typeof yt&&yt(),yt=Qe({ipcMain:r["ipcMain"],win:mt,io:J}),"function"===typeof(null===(e=wt)||void 0===e?void 0:e.cancel)&&wt.cancel(),wt=it({torrentManager:vt,configManager:Ft}),mt.on("ready-to-show",(async()=>{bt||(bt=!0)}));const n=()=>{bt=!1,console.log("Webtorrent window crashed. Restarting..."),mt=null,Tt(),console.log("loadurl")};return mt.webContents.on("render-process-gone",((e,t)=>(console.log(`Render process gone with code ${t.exitCode}. Reason: ${t.reason}`),n(),!1))),mt.webContents.on("unresponsive",(()=>{console.log("Torrent window is unresponsive. Reload."),n()})),mt},Pt={key:"createTime",sequence:1};r["app"].on("ready",(()=>{Tt(),r["ipcMain"].on("open-webtorrent-devtools",(()=>{var e,t;mt.show(),null===(e=mt)||void 0===e||null===(t=e.webContents)||void 0===t||t.openDevTools({mode:"detach"})})),r["ipcMain"].on("reset-torrent",(()=>{mt.webContents.send("reset-torrent")})),r["ipcMain"].on("reload-webtorrent-window",(()=>{mt.webContents.send("force-exit")})),r["ipcMain"].on("webtorrent-client-info",((e,t)=>{J.emit("client_info",t)})),r["ipcMain"].on("webtorrent-infohash",((e,t,n)=>{J.emit("torrent_infohash",t,n);const r=vt.findAll(t);if(r&&!r.isSeeding)return n||(n={}),r.paused=!1,void J.emit("torrent_download",{...n,...r,infoHash:t});n.done||n.upload||n.isSeeding||vt.downloading.push({...n,infoHash:t})})),r["ipcMain"].on("webtorrent-metadata",((e,t)=>{J.emit("torrent_metadata",t)})),r["ipcMain"].on("webtorrent-seed",((e,t)=>{t.infoHash&&(vt.pop(t.infoHash,vt.paused),vt.pop(t.infoHash,vt.downloaded)),vt.uploading.push(t),de.updateTorrent(t),J.emit("torrent_seed",t)})),r["ipcMain"].on("webtorrent-torrents",(async(e,t)=>{const n=[];t.forEach((e=>{const t=e.upload||e.isSeeding||e.done,r=t?"uploading":e.pending?"pending":"downloading";if(!e.infoHash){if(e.magnetURI){var o;const t=null===(o=e.magnetURI.match(/btih:([a-fA-F0-9]{40})/))||void 0===o?void 0:o[1];t&&(e.infoHash=t)}if(vt[r].push(e),!e.infoHash)return console.log("skip no infoHash",e.name||e.origin)}const s=vt.pop(e.infoHash,vt.paused);if(s)return s.paused=!1,t?vt.uploading.push(s):vt.downloading.push(s),n.push(s),console.log("skip paused",s.name);const a=de.getTorrent(e.infoHash)||e,i=oe(a,e);if((!i.alphabizURI||e.name&&e.name!==a.name||i.alphabizURI.startsWith("alphabiz:///")||i.alphabizURI.startsWith("alphabiz://alphabiztask"))&&i.magnetURI){if(i.magnetURI.includes("&dn=")||(i.magnetURI+=`&dn=${encodeURI(i.name||"alphabiztask")}`),e.magnetURI.includes("&dn=")||(e.magnetURI+=`&dn=${encodeURI(e.name||"alphabiztask")}`),e.magnetURI&&e.magnetURI!==a.magnetURI)console.log("magnetURI changed",e.magnetURI,a.magnetURI);else if(i.alphabizURI)return vt[r].push(e),n.push(i);We.encode({hash:i.infoHash,url:i.magnetURI},((e,t)=>{e||"string"!==typeof t||(i.alphabizURI=t,console.log("encoded",t),de.updateTorrents([i]))}))}const l=vt[r].get(e.infoHash);l||vt.popFromAll(i.infoHash),vt[r].push(i),i.paused||(i.pausedByUser=!1),n.push(i)})),vt.next(),de.updateTorrents(n);const r=await ge(vt.torrentDisplayList(),Pt.key,Pt.sequence);"darwin"===process.platform&&(r.downloading.some((e=>e.ready&&!e.paused))?rt({title:ot(r.totalDownloadSpeed,{byte:!1,gb:!1})+" / s"}):rt({title:""})),J.emitSingle("torrent_list",r)})),r["ipcMain"].on("webtorrent-pending",(async(e,t)=>{t.ready=!0,t.paused=!1,t.pending=!0;const n=vt.popFromAll(t.infoHash);n&&vt.pending.push(n);const r=await oe(n,t);r.name&&r.name!==(null===n||void 0===n?void 0:n.name)&&r.magnetURI&&We.encode({hash:r.infoHash,url:r.magnetURI},((e,t)=>{e||(r.magnetURI=t,de.updateTorrent(r),vt.pending.push(r))})),J.emit("torrent_download",t)})),r["ipcMain"].on("webtorrent-stop",(async(e,t,n)=>{if(vt.has(t)){J.emit("pause_torrent",t);const e=vt.findAll(t);e&&(e.connections=[],vt.popFromAll(t),n?(e.completed=!0,vt.downloaded.push(e)):vt.paused.push(e),e.paused=!0,e.pending=!1,e.trackerList&&delete e.trackerList,de.updateTorrent(e)),console.log("Paused",t,n),J.emit("clear_player",{infoHash:t,status:"paused"})}else de.delTorrent(t),console.log("(Pause)Deleted",t),J.emit("torrent_delete",t);J.emitSingle("torrent_list",await ge(vt.torrentDisplayList(),Pt.key,Pt.sequence))})),r["ipcMain"].on("webtorrent-delete",((e,t,n,r)=>{if(console.log("ipc deleted",t,n),n&&Ft.getUserSettings("downloadDirectory")!==n&&Ft.getUserSettings("uploadDirectory")!==n){for(const t of r)try{i.a.existsSync(t)&&i.a.rmSync(t)}catch(e){console.log("Failed to delete",t),console.error(e)}try{0===i.a.readdirSync(n).filter((e=>![".DS_Store","Thumbs.db"].includes(e))).length?(i.a.rmdirSync(n),console.log("[delete] remove",n)):Ke(n)&&(i.a.rmSync(n,{recursive:!0}),console.log("[delete] remove pure directories"));const e=[];r.forEach((t=>{i.a.existsSync(t)&&e.push(t)})),e.length&&J.emit("delete-files-failed",t,e)}catch(o){}}vt.popFromAll(t),J.emit("torrent_delete",t)})),r["ipcMain"].on("webtorrent-existed",((e,t)=>{if(vt.findAll(t)){if(St.infoHash===t)return;J.emit("torrent_exists",t)}})),r["ipcMain"].on("webtorrent-done",((e,t)=>{if(J.emit("torrent_done",t),vt.find(t.infoHash,vt.uploading))return;if(!Ft.getUserSettings("notifyAfterDownloaded"))return;const n=new r["Notification"]({title:Dt.$t("download_complete"),body:Dt.$t("download_complete_message",[t.postTitle||t.name])});n.on("click",(()=>{const e=Ve((t.files||t.file).map((e=>e.path||e)));console.log(e),r["shell"].openExternal("file://"+e)})),n.show()})),r["ipcMain"].on("notify-test",(()=>{const e=new r["Notification"]({title:"test title",body:"test body"});e.show()})),r["ipcMain"].on("webtorrent-save-torrent",((e,t)=>{if(0!==t.code)return J.emit("client_error",t.message);const n=vt.findAll(t.infoHash);n&&(n.torrentPath=t.torrentPath,de.updateTorrent(n))})),r["ipcMain"].on("update_torrent_settings",((e,t)=>{mt.webContents.send("set-client",t),t.maximumConnectionsNum&&(vt.max=t.maximumDownloadNum),vt.next()})),r["ipcMain"].on("webtorrent-initted",(async()=>{ft&&ft(),console.log("Webtorrent Init Ready"),J.emit("info","Webtorrent Window is ready"),await ht.ready,vt.clear();const e=de.getTorrent(),t=Ft.getUserSettings("autoStartUnfinished");e.sort(((e,t)=>e.progress?t.progress?t.progress-e.progress:-1:1)).forEach((e=>{e.isAutoUpload||(e.pending&&!e.isSeeding?t&&xt?vt.pending.push(e):(e.paused=!0,vt.paused.push(e)):e.paused?(e.pending=!1,e.completed||e.isSeeding?vt.downloaded.push(e):vt.paused.push(e)):!e.isSeeding&&!e.upload||e.origin?e.done?!e.paused&&t&&xt?e.paused?vt.downloaded.push(e):vt.upload(e,!1,!0):(e.paused=!0,vt.downloaded.push(e)):t&&xt?(vt.downloading.push(e),vt.download(e)):(e.paused=!0,vt.paused.push(e)):t&&xt?vt.upload(e,!1,!0):(e.paused=!0,vt.downloaded.push(e)))}));const n=Ft.getUserSettings("uploadDirectory");Ut(n),vt.next(),J.emitSingle("torrent_list",await ge(vt.torrentDisplayList(),Pt.key,Pt.sequence),de.getOrders())})),r["ipcMain"].on("webtorrent-server-ready",((e,t,n)=>{console.log("server ready"),St.infoHash=t;const r=vt.findAll(t);if((r.paused||r.pending)&&(console.log("should start server",t),vt.pendSlowest(),vt.download(r)),!r||!r.files){if(!global.win)return;const{addressSent:e,...t}=St;return e&&console.log("addressSent"),global.win.webContents.send("stream-address",t)}for(let i=0;i<r.files.length;i++){var o;const e=null===(o=r.files[i])||void 0===o?void 0:o.path;if(null!==e&&void 0!==e&&e.includes(St.filepath)&&dt(e)){console.log(`Streamming video ${i} - ${r.files[i].name} via torrent server`),St.file=r.files[i].name,St.filepath=e,St.fileindex=i;break}}if(St.address=`http://localhost:${n.port}/${St.fileindex}/${St.file}?wait=0`,St.ready=!0,!St.enabled)return console.log("server disabled");const{addressSent:s,...a}=St;console.log("[Stream] Send by server",a),global.win&&global.win.webContents.send("stream-address",a)})),r["ipcMain"].on("webtorrent-server-progress",((e,t,n)=>{t===St.infoHash&&J.emit("server_progress",n)})),r["ipcMain"].on("get-stream-address",(e=>{if(St.enabled=!0,St.ready){const{addressSent:t,...n}=St;e.reply("stream-address",n)}})),r["ipcMain"].on("webtorrent-error",((e,t,n)=>{const r=vt.findAll(t.infoHash);J.emit("torrent_error",{token:t.token||t.origin,torrent:r||t,message:n&&n.startsWith("Cannot add duplicate torrent")?"duplicate_task":n}),t.token&&!r&&vt.popFromAll(t.token)})),r["ipcMain"].on("webtorrent-reset",(async()=>{vt.clear(),de.clear(),console.log("webtorrent reset"),J.emitSingle("torrent_list",await ge(vt.torrentDisplayList(),Pt.key,Pt.sequence)),J.emit("notify","Successfully reset torrents")})),r["ipcMain"].on("webtorrent-restart",((e,t)=>{console.log(`[${t}] WebTorrent Restart`)})),r["ipcMain"].on("autoupload-complete",(()=>{J.emit("autoupload-complete")})),r["ipcMain"].on("webtorrent-ready",(()=>{wt&&wt.check()})),r["ipcMain"].on("add-tracker",((e,{infoHash:t,url:n})=>{const r=vt.findAll(t);r&&(r.customTrackers||(r.customTrackers=[]),r.customTrackers.includes(n)||(r.customTrackers.push(n),de.updateTorrent(r))),mt.send("add-tracker",{infoHash:t,url:n})})),r["ipcMain"].on("remove-tracker",((e,{infoHash:t,url:n})=>{const r=vt.findAll(t);r&&r.customTrackers&&r.customTrackers.includes(n)&&(r.customTrackers.splice(r.customTrackers.indexOf(n),1),de.updateTorrent(r)),mt.send("remove-tracker",{infoHash:t,url:n})}));const e=async(e,t=!1)=>{var n,r,o;if(!xt)return;if("url"===e.type&&e.url.includes("\n")){const t=[],n=(await Promise.all(e.url.split("\n").filter((e=>!!e.length&&(e.startsWith("alphabiz")||e.startsWith("magnet")))).map((async e=>e.startsWith("alphabiz")?await We.decode(e):e)))).filter((e=>{var n;const r=null===(n=e.match(/([0-9a-fA-F]{40})/))||void 0===n?void 0:n[1];return!r||!vt.has(r)||(t.push(e),!1)}));console.log("download",n.length,t);const r=n.map((t=>{var n;return{infoHash:(null===(n=t.match(/([0-9a-fA-F]{40})/))||void 0===n?void 0:n[1])||t,path:(null===e||void 0===e?void 0:e.path)||e.downloadDirectory,token:t,origin:t,trackers:e.trackers}}));return de.updateTorrents(r),vt.downloadAll(n,e)}const l="url"===e.type?e.url:Object(a["existsSync"])(e.file)?null===(n=W()(Object(a["readFileSync"])(e.file)))||void 0===n?void 0:n.infoHash:e.file||e.url,c={infoHash:l,path:(null===e||void 0===e?void 0:e.path)||e.downloadDirectory,token:l,origin:l,trackers:e.trackers};var u,p,d;if(l.startsWith("alphabiz"))c.alphabizURI=l,c.magnetURI=await We.decode(l),c.name=Ct((null===(u=c.magnetURI.match(/&dn=([^&]+)/))||void 0===u?void 0:u[1])||"alphabiz-task"),c.infoHash=(null===(p=c.magnetURI.match(/:([0-9a-fA-F]{40})/))||void 0===p||null===(d=p[1])||void 0===d?void 0:d.toLowerCase())||c.magnetURI;else if(l.startsWith("magnet")){var f,h,g;c.magnetURI=l,c.infoHash=(null===(f=l.match(/:([0-9a-fA-F]{40})/))||void 0===f||null===(h=f[1])||void 0===h?void 0:h.toLowerCase())||l,c.name=Ct((null===(g=c.magnetURI.match(/&dn=([^&]+)/))||void 0===g?void 0:g[1])||"alphabiz-task")}if(i.a.existsSync(c.infoHash)&&i.a.statSync(c.infoHash).isDirectory()){const t=i.a.readdirSync(c.infoHash);return t.forEach((t=>{if(t.endsWith(".torrent")){const n=s.a.resolve(c.infoHash,t);if(vt.torrents().some((e=>{for(const[t,r]of e.entries())if(r.token===n||r.origin===n||r.torrentPath===n)return!0})))return;const r={infoHash:n,path:(null===e||void 0===e?void 0:e.path)||e.downloadDirectory,token:n,origin:n,trackers:e.trackers};return(e.postTitle||e.name)&&(r.name=e.postTitle||e.name),vt.download(r)}}))}null!==(r=e.url)&&void 0!==r&&r.startsWith("magnet")&&(c.magnetURI=e.url),e.fromPost&&(c.fromPost=e.fromPost),e.postTitle&&(c.postTitle=e.postTitle),(e.name||e.postTitle)&&(c.name=e.name||e.postTitle);const m=c.infoHash.startsWith("magnet")?null===(o=c.infoHash.toLowerCase().match(/[a-z0-9]{40}/))||void 0===o?void 0:o[0]:c.infoHash;if(!m)return console.log("Cannot get hashOrId from config",c.infoHash),void J.emit("torrent_error",{message:"invalid_download_url",token:c.infoHash});const v=vt.torrents().reduce(((e,t)=>(e.push(...t.values()),e)),[]),y=v.find((e=>e.infoHash===m||e.alphabizURI===m||e.origin===m));if(y){if(!t)return J.emit("torrent_exists",""),console.log("exist",m,y),c;{const e=vt.findAll(m);c.path=e.path||c.path}}return t&&vt.isMax()&&vt.pendSlowest(),console.log("[torrent manager] download",c),vt.isDownloading(c.infoHash)||(vt.downloading.push(c),vt.download(c),de.updateTorrents([c])),c};J.on("download_torrent",(t=>{if("magnet"===t.type&&t.url.startsWith("magnet")&&!t.url.includes("\n"))if(t.title)t.name||(t.name=t.title);else{const e=t.url.match(/&dn=([^&]+)/);e&&e[1]&&(t.name=decodeURI(e[1]))}const n=vt.torrents();let r=0;n.forEach((e=>{e.forEach((e=>{var n,o;if(e.path===t.downloadDirectory&&(null!==(n=e.postTitle)&&void 0!==n&&n.includes(t.postTitle)||null!==(o=e.name)&&void 0!==o&&o.includes(t.postTitle))){var s;const n=null===(s=(e.postTitle||e.name).replace(t.postTitle,"").trim().match(/\((\d+)\)/))||void 0===s?void 0:s[1];if(n){const e=parseInt(n);e&&e>=r&&(r=e+1)}else r||(r=1)}}))})),console.log("num",r,t.postTitle),r&&(t.postTitle+=` (${r})`),e(t)})),J.on("seed_torrent",(e=>{xt&&vt.upload(e,!0)})),J.on("seed_torrents",(e=>{console.log("seed torrents",e.length);const t=e.map((e=>vt.upload(e,!0,!1,!0)));console.log("seed torrents",e.length,t.length),mt.webContents.send("seed-torrents",t)})),J.on("pause_torrent",(e=>{kt(e);const t=vt.findAll(e);return t&&(t.pausedByUser=!0,de.updateTorrents([t])),vt.pause(e)})),J.on("pause_all",((e=!1)=>{console.log("pause all");const t=[];for(const n of["pending","downloading"]){const r=vt[n];for(const[n,o]of[...r.entries()].reverse())vt.pause(n,!0),o.pausedByApp=e,o.pausedByUser=!e,t.push(o)}vt.next(),de.updateTorrents(t)})),J.on("pause_all_uploading",(e=>{console.log("pause all uploading");const t=[];vt.uploading.forEach((n=>{n.isAutoUpload||(n.paused=!0,n.pausedByApp=e,n.pausedByUser=!e,t.push(n))})),mt.webContents.send("stop-all-uploading",t),vt.downloaded.push(...t),t.forEach((e=>vt.uploading.delete(e.infoHash))),de.updateTorrents(t)}));const t=e=>xt?(kt(e.infoHash),e.isSeeding||e.upload||e.done||!e.infoHash&&e.file&&e.file.length?vt.upload(e):vt.download(e)):console.log("skip since is not logged in");J.on("resume_torrent",t),J.on("resume-all",(e=>{if(!xt)return console.log("Skip since not logged in");e.forEach(t),J.emit("resume-all")})),J.on("delete_torrent",((e,t=!1)=>{if(!xt)return;console.log("destroyStore:",t);const n=vt.findAll(e);return!t&&n.done||J.emit("clear_player",{infoHash:e}),vt.delete(e,t)})),J.on("delete_all",((e,t,n)=>{xt&&(mt.webContents.send("delete-all",e,t,n),"upload"===e&&vt.uploading.forEach((e=>{if(!e.isAutoUpload||n)return vt.delete(e.infoHash||e.token,t)})))})),J.on("torrent_list",(async()=>J.emitSingle("torrent_list",await ge(vt.torrentDisplayList(),Pt.key,Pt.sequence),de.getOrders()))),J.on("update_torrent_settings",(e=>{mt.webContents.send("set-client",e),e.maximumDownloadNum&&(vt.max=e.maximumDownloadNum),vt.next()})),J.on("torrent_order",(e=>{if(!e)return J.emit("torrent_order",de.getOrders());de.setOrders(e)})),J.on("set_sort_option",(async e=>{Pt.key=e,J.emitSingle("torrent_list",await ge(vt.torrentDisplayList(),Pt.key,Pt.sequence))})),J.on("set_sort_sequence",(async e=>{Pt.sequence=e,J.emitSingle("torrent_list",await ge(vt.torrentDisplayList(),Pt.key,Pt.sequence))})),J.on("play-torrent",(({infoHash:e,filepath:t})=>{if(!xt)return;console.log("Play",e,t),St.infoHash=e;const n=vt.findAll(e);if(!n||!n.files)return J.emit("play-torrent-error",e);J.emit("play-torrent-enabled",e),St.addressSent=!1,St.enabled=!1,St.ready=!1,St.filepath=t;for(let i=0;i<n.files.length;i++){var r,o,s;if(null!==(r=n.files[i])&&void 0!==r&&null!==(o=r.path)&&void 0!==o&&o.includes(t)&&dt(null===(s=n.files[i])||void 0===s?void 0:s.path)&&(console.log(`Streamming video ${i} - ${n.files[i].name}`),St.file=n.files[i].name,St.fileindex=i,n.files[i].progress&&1===n.files[i].progress)){var a;console.log("file done. use default"),kt(St.infoHash);const e=Object(B["pathToFileURL"])(null===(a=n.files[i])||void 0===a?void 0:a.path).href.replace(/^file/,"play");if(St.address=e,"Alphabiz"===Ft.getUserSettings("defaultVideoPlayer"))return St.ready=!0,void J.emit("jump-to-player");if(/play:\/\//.test(St.address)&&"Alphabiz"!==Ft.getUserSettings("defaultVideoPlayer"))return St.file="",St.fileindex=0,St.filepath="",J.emit("open-default-player",t)}}if(n.paused||n.pending){const t=vt.pop(e,vt.paused)||vt.pop(e,vt.pending);vt.isMax()&&vt.pendSlowest(),vt.downloading.push(t||n),vt.download(t||n)}J.emit("jump-to-player"),mt.webContents.send("start-server",{infoHash:e,conf:n})})),J.on("play-video",(e=>{"string"===typeof e&&e.length&&e!==St.infoHash&&kt(St.infoHash)})),J.on("download-and-play",(async t=>{const n=await e(t,!0);n&&n.infoHash?(kt(St.infoHash),St.filepath="",St.addressSent=!1,St.ready=!1,St.enabled=!1,St.file="",St.infoHash=n.infoHash,mt.webContents.send("start-server",{infoHash:n.infoHash,conf:n}),J.emit("jump-to-player"),console.log("start server")):console.log("not result!")})),J.on("torrent_progress",(e=>{if(!e)return J.emit("torrent_progress",{});if(St.file){const t=vt.findAll(e);if(!t||!t.files)return;for(const n of t.files)if(null!==n&&void 0!==n&&n.path.includes(St.file))return J.emit("torrent_progress",{name:n.name,path:n.path,progress:n.progress,infoHash:e})}return J.emit("torrent_progress",{})})),J.on("show_torrent_file",(e=>{r["shell"].showItemInFolder(e)})),J.on("save_torrent_file",(e=>{const t=vt.findAll(e),n=Ft.getUserSettings("saveLinkSeed")?t&&t.path:s.a.resolve(r["app"].getPath("userData"),"torrents");n?mt.webContents.send("save-torrent-file",e,n):(console.log(t),J.emit("client-error","Torrent Not Found"))})),J.on("unlimit_upload_amount",(()=>{Ft.setUserSettings({unlimitUploadAmount:!0}),Ut(Ft.getUserSettings("uploadDirectory"))})),J.on("user_login",(()=>{if(console.log("login"),xt=!0,Ft.getUserSettings("autoUpload")&&Ut(),!Ft.getUserSettings("autoStartUnfinished"))return console.log("skip auto resumes");const e=[];vt.downloaded.forEach((t=>{t.pausedByUser||(t.pausedByApp=!1,t.paused=!1,e.push(t))}));const t=e=>{const t=e.map((e=>vt.upload(e,!1,!1,!0)));console.log("[UserLogin] seed torrents",e.length,t.length),mt.webContents.send("seed-torrents",t)};t(e),de.updateTorrents(e)})),J.on("user_logout",(()=>{console.log("logout"),xt=!Ft.getUserSettings("forceLogin"),Ut()})),J.on("open-external-file",(e=>{r["shell"].openPath(e)}))}));const At=(e,...t)=>{if(mt)return mt.webContents.send(e,...t)};var Ot,Rt,Et={hideMenu:!0,autoHide:!1,language:"en-US",darkMode:"system",defaultVideoPlayer:"Alphabiz",videoCacheTime:1,autoLaunch:!1,restore:!0,autoStartUnfinished:!0,seedSharingRate:!0,seedTime:!1,maximumDownloadNum:5,maximumConnectionsNum:20,saveLinkSeed:!1,unlimited:!0,continuousSeeding:!0,breakpointContinuation:!1,autoJumpToDownload:!0,notifyAfterDownloaded:!1,deleteConfirm:!1,defaultDeleteFiles:!1,uploadSpeed:-1,downloadSpeed:-1,payedUserShareRate:.7,downloadDirectory:"",autoUpload:!1,uploadDirectory:"",unlimitUploadAmount:!1,autoCheckUpdate:!0,useProxyService:!0,trackerSource:[{value:"https://raw.githubusercontent.com/ngosang/trackerslist/master/trackers_best.txt",label:"ngosang_best",cdn:!1},{value:"https://raw.githubusercontent.com/ngosang/trackerslist/master/trackers_best_ip.txt",label:"ngosang_best_ip",cdn:!1}],trackerList:Se.a.trackerList,autoUpdateTrackerServiceList:!0,trackerLastUpdateTime:"",listenPort:!1,BTlistenPort:21303,DHTlistenPort:26701,secureOption:"auto",bindMagnetUrl:!1,bindTorrentFile:!1,bindVideoFile:!1,bindVideoExts:{mp4:!1,mkv:!1,avi:!1,mov:!1,wmv:!1,rmvb:!1,flv:!1,webm:!1},bindAudioExts:{mp3:!1,wav:!1,aac:!1,flac:!1,m4a:!1,wma:!1},bindAudioFile:!1,dontAskForAssociate:!1,dontAskForPlayer:!1,userAgent:"",RPCauthorizationkey:"",versionChannel:"stable",githubPAT:"",lastUpdateCheckTime:Date.now(),disableDevTools:!0,minDiskSpace:512e6,autoDownload:!0,forceLogin:!0,libraryShowExplore:!1,libraryRate:"G",libraryShowAllChannels:!1};const Lt=q("version"),jt=H.a.prerelease(Lt),It=!Lt.endsWith("internal-dev"),Mt=null===jt||void 0===jt||null===(Ot=jt[0])||void 0===Ot||null===(Rt=Ot.split("-"))||void 0===Rt?void 0:Rt[0],Dt=new M("en-US");let Ht=null;try{if(Ht=r["app"].getPath("downloads"),!Ht)throw""}catch(cr){Ht=Object(o["resolve"])(homedir(),"Downloads"),Object(a["existsSync"])(Ht)||(Ht=Object(o["resolve"])(homedir(),"downloads"))}class $t{constructor(){this.userSettings={},this.init()}init(){if(this.initUserSettings(),this.userSettings.get("autoUpdateTrackerServiceList")){const e=new Date(this.userSettings.get("trackerLastUpdateTime")),t=new Date;if(t.valueOf()-e.valueOf()<864e5&&t.getDate()===e.getDate())return;console.log("Update trackers"),this.updateTrackers()}process.env.DISABLE_FORCE_LOGIN||process.argv.includes("--disable-force-login")?(console.log("Disabled force login"),this.userSettings.set("forceLogin",!1)):this.userSettings.set("forceLogin",!0)}initUserSettings(){this.checkInit(),this.userSettings=new c.a({name:"alphabiz-config",defaults:Object.assign(Et,{locale:r["app"].getLocale()||"en-US",downloadDirectory:Ht,uploadDirectory:Object(o["resolve"])(Ht,"auto-upload"),versionChannel:Mt||"stable",disableDevTools:It}),migrations:{[Lt]:e=>{const t=e.get("language");"string"===typeof t.value&&e.set("language",t.value),"number"===typeof e.get("payedUserShareRadix")&&(e.set("payedUserShareRate",e.get("payedUserShareRadix")),e.delete("payedUserShareRadix"));const n=e.get("trackerBt");n&&n.length&&(e.set("trackerList",n.split("\n")),e.delete("trackerBt")),e.get("trackerList").trackerList&&e.set("trackerList",e.get("trackerList").trackerList)}},projectVersion:Lt}),this.userSettings.set("autoLaunch",r["app"].getLoginItemSettings().openAtLogin);const e=this.userSettings.get("language");e&&(this.localeDeps=[],this.updateLocales(e.value||e))}checkInit(){const e=Object(o["resolve"])(r["app"].getPath("userData"),"alphabiz-config.json");Object(a["existsSync"])(e)||setTimeout((async()=>{await Xn;const e=or();e?e.webContents.send("app-init"):console.log("Cannot get main window")}),5e3)}set locale(e){Dt.setLocale(e)}get locale(){return Dt.locale}$t(e,t){return Dt.$t(e,t)}updateLocales(e){this.locale=e,this.localeDeps.forEach((e=>e()))}onLocaleChange(e){"function"===typeof e&&(e(),this.localeDeps.push(e))}getUserSettings(e,t){return"undefined"===typeof e&&"undefined"===typeof t?this.userSettings.store:this.userSettings.get(e,t)}getLanguage(){return this.getUserSettings("language")||r["app"].getLocale()}setUserSettings(e){const t={};Object.keys(e).forEach((n=>{const o=e[n];switch(this.userSettings.set(n,o),n){case"language":return this.updateLocales(o);case"autoLaunch":return r["app"].setLoginItemSettings({openAtLogin:o});case"uploadSpeed":case"downloadSpeed":case"maximumDownloadNum":case"maximumConnectionsNum":case"payedUserShareRate":case"DHTlistenPort":case"BTlistenPort":case"secureOption":t[n]=o;break}})),Object.keys(t).length&&(console.log("update torrent setting",t),At("update-settings",t))}resetSettings(){this.userSettings.clear()}async isMagnetRegistered(){const e=await b("magnet");return this.userSettings.set("bindMagnetUrl",!!e),!!e}async isTorrentAssociated(){const e=await S(".torrent");return this.userSettings.set("bindTorrentFile",!!e),!!e}async isVideoAssociated(){let e=!0;const t=this.userSettings.get("bindVideoExts");for(const n in t){const r=await S("."+n);t[n]=r,r||(e=!1)}return this.userSettings.set("bindVideoExts",t),e}async isAudioAssociated(){let e=!0;const t=this.userSettings.get("bindAudioExts");for(const n in t){const r=await S("."+n);t[n]=r,r||(e=!1)}return this.userSettings.set("bindAudioExts",t),e}async updateAssociateInfo(){return Promise.resolve([])}async updateTrackers(){const e=this.userSettings.get("trackerSource");if(Array.isArray(e)){const t=await f(e);return t.data.length&&(this.userSettings.set("trackerList",t.data),this.userSettings.set("trackerLastUpdateTime",t.time)),t}}clear(){this.userSettings.clear()}get path(){return this.userSettings.path}}const Ft=new $t;const zt=async()=>{const e=r["app"].requestSingleInstanceLock();if(!e)return!1;await r["app"].whenReady();const t=Object(o["resolve"])(r["app"].getPath("userData"),"launch.log");Object(a["existsSync"])(Object(o["dirname"])(t))||Object(a["mkdirSync"])(Object(o["dirname"])(t),{recursive:!0});const n=Object(a["existsSync"])(t)?Object(a["readFileSync"])(t).toString().split("\n").map((e=>parseInt(e))).filter((e=>e)):[];console.log("launch logs:",t,n);const s=Date.now();if(n.length>=2){if(s-n[0]<18e4){console.log("oops!",n[0],s,s-n[0]);const e=r["dialog"].showMessageBoxSync({type:"question",message:Dt.$t("ask_clear_data"),buttons:[Dt.$t("launch_directly"),Dt.$t("clear_all_data")]});if(1===e){const e=r["dialog"].showMessageBoxSync({type:"warning",title:Dt.$t("confirm"),message:Dt.$t("ask_clear_confirm"),buttons:[Dt.$t("confirm_launch"),Dt.$t("confirm_clear")]});e&&(console.log("should clear"),Object(a["rmSync"])(r["app"].getPath("userData"),{recursive:!0}),r["app"].exit(0))}}while(n.length>2)n.shift()}return n.push(s),Object(a["writeFileSync"])(t,n.join("\n")),!0},qt=zt();var Bt=qt,Nt=n(110),Wt=n.n(Nt),Gt=n(24),Kt=n.n(Gt);const{platform:Vt,arch:Jt}=process,Zt="win32"===Vt?".msi":"darwin"===Vt?".dmg":".deb";class Qt{constructor({version:e,channel:t="stable",pre:n=!1}){this.apiUrl="internal"===t?"https://api.github.com/repos/tanshuai/alphabiz-app/releases":"stable"===t?"https://api.github.com/repos/tanshuai/alphabiz/releases/latest":"https://api.github.com/repos/tanshuai/alphabiz/releases";const r={Accept:"application/vnd.github.v3+json"},o=process.env.GITHUB_PAT||Ft.getUserSettings("githubPAT");o&&(r.Authorization=`token ${o}`),this.headers=r,this.version=e,this.channel=t,this.pre=n,this.downloadProgress=new Map,this.cancel=null}async getReleases(){try{const{data:e}=await p.a.get(this.apiUrl,{headers:this.headers,responseType:"json"});return Array.isArray(e)?e:[e]}catch(cr){return console.error("Cannot get releases. Error:",cr.message||cr),[]}}async downloadAsset(e,t,n,r={}){const o=p.a.CancelToken.source();return this.cancel=o,p.a.get(e,Object.assign({},r,{responseType:"stream",cancelToken:o.token})).then((({data:e})=>new Promise(((r,s)=>{const i=Object(a["createWriteStream"])(t);e.pipe(i);const l=()=>{if(o.canceled)return s("Canceled");o.cancel("Timeout"),s("Timeout")};let c=setTimeout(l,5e3);e.on("data",(e=>{clearTimeout(c),c=setTimeout(l,3e3);const t=this.downloadProgress.get(n);t&&(t.downloaded+=e.length,this.downloadProgress.set(n,t))})),i.on("finish",(()=>{const e=this.downloadProgress.get(n);if(e.downloaded<e.length)return o.cancel("Terminated"),s("Download Error: Terminated");r()})),i.on("error",s)}))))}async downloadUpdate(e){const t=Object(o["resolve"])(Y.a.tmpdir(),"alphabiz-updates");Object(a["mkdirSync"])(t,{recursive:!0});const n=[];for(const r of e){const{url:e,name:s}=r,a=Object(o["resolve"])(t,s);this.downloadProgress.set(s,{length:r.size,downloaded:0});try{await this.downloadAsset(e,a,s,{headers:Object.assign({},this.headers,{Accept:"application/octet-stream"})}),n.push(a)}catch(cr){if(console.log(`Cannot download ${s} from ${e}`,cr.message||cr),"Timeout"===cr)throw"update_timeout"}}return n}async checkForUpdate(){const e=await this.getReleases(),t=e.find((e=>{if(e.draft)return!1;if(e.prerelease&&!this.pre)return!1;if(!H.a.valid(e.tag_name))return!1;const t=H.a.prerelease(e.tag_name);if(t&&1===t.length){const e=t.pop();t.push(...e.split("-"))}if("stable"===this.channel)return!t;if(t&&t[0]===this.channel){if(e.assets)return e.assets.some((e=>e.name.endsWith(Zt)));console.log("no available asset")}return!1}));if(!t||!t.assets||!Array.isArray(t.assets))return{shouldUpdate:!1,reason:"no_available_release"};if(!H.a.gt(t.tag_name,this.version))return{shouldUpdate:!1,reason:"already_latest"};const n=t.assets.filter((e=>e.name.endsWith(Zt)));return n.length?{shouldUpdate:!0,version:t.tag_name,detail:t.body,assets:n}:{shouldUpdate:!1,reason:"no_available_installer"}}}Kt()(Qt,"isBusy",!1);q("version"),q("version");function Yt(){if(n(170))return r["app"].quit();if(e())return r["app"].quit();function e(){if(1===process.argv.length)return!1;const e=n(171),t=n(3),o=t.resolve(process.execPath,".."),s=t.resolve(o,".."),a=t.resolve(t.join(s,"Update.exe")),i=t.basename(process.execPath),l=function(t,n){let r;try{r=e.spawn(t,n,{detached:!0})}catch(o){}return r},c=function(e){return l(a,e)},u=process.argv[1];switch(u){case"--squirrel-install":case"--squirrel-updated":return c(["--createShortcut",i]),setTimeout(r["app"].quit,1e3),!0;case"--squirrel-uninstall":return c(["--removeShortcut",i]),setTimeout(r["app"].quit,1e3),!0;case"--squirrel-obsolete":return r["app"].quit(),!0;case"--squirrel-firstrun":return r["app"].quit(),!0}}}var Xt=n(111),en=n.n(Xt);const tn="alphabiz";function nn(){cn(tn),cn("ab",!0),r["app"].whenReady().then((()=>{{const e="file://"+__dirname+"/index.html",t=s.a.basename(e);pn(tn,t)}}))}process.env.APP_SCHEME=tn,r["protocol"].registerSchemesAsPrivileged([{scheme:process.env.APP_SCHEME,privileges:{standard:!0,secure:!0,supportFetchAPI:!0}}]),nn();const rn=["file://",tn+"://","ab://","magnet:","ab-library://",`${Ie.config.prefix}://`];function on(e){return e&&rn.some((t=>e.startsWith(t)))}function sn(e){return e.match(/^[^:]+?:[^//]/)?e.replace(/^\S+?:/,(e=>e+"//")):e}function an(e){r["app"].removeAsDefaultProtocolClient(e),U(e)}async function ln(e){console.log("onOpenUrl",e);const t=e.startsWith("ab:")||e.startsWith("alphabiz:")?await We.decode(e.replace(/\/+$/,"")):e;if(!t||t.startsWith("magnet"))return or().webContents.send("open-file",e);if(t.startsWith("ab-library"))return J.emit("open-library",t);if(t.startsWith(Ie.config.prefix)){var n;const{action:e,actionArgs:r}=Ie.parseAction(t);null===(n=global.win.webContents)||void 0===n||n.send(`${Ie.config.prefix}-action`,e,r)}else console.log("Unknown url",e,t)}function cn(e,t=!1){if("win32"===process.platform){const t=[];0,t.push("--"),x(e,`Alphabiz ${e} protocol`)}else"darwin"===process.platform&&r["app"].setAsDefaultProtocolClient(e)}r["app"].on("second-instance",(async(e,t,n,r)=>{if(console.log("on second"),await Xn,"win32"===process.platform){if(!t)return;const e=t.find(on);if("string"!==typeof e)return;un.dispatch(e),e.startsWith("alphabiz://$oauth")||ln(e)}})),r["app"].on("open-url",(async(e,t)=>{console.log("on open-url"),await Xn;const n=sn(t);"string"===typeof n&&on(n)&&(un.dispatch(n),n.startsWith("alphabiz://$oauth")||(console.log("openurl",t),ln(n)))}));class un{static dispatch(e){const{event:t,pathname:n,params:r}=this.parseUrl(e);t&&this.emitter.emit(t,n,r,e)}static parseUrl(e){let{searchParams:t,host:n,pathname:r}=new URL(e);const o={};for(const[s,a]of t.entries())o[decodeURIComponent(s)]=decodeURIComponent(a);return n=decodeURIComponent(n),r=decodeURIComponent(r),{event:n,pathname:r,params:o}}static subscribe(e,t){this.emitter.addListener(e,t)}}function pn(e,t){const n=n=>{if(n===`${e}://${t}/`||n===`${e}://${t}/favicon.ico`||0===n.indexOf(`${e}://${t}/#`))return s.a.join(__dirname,t);{const r=n.replace(`${e}://${t}/`,"");return s.a.join(__dirname,r)}},o=e=>{const t=s.a.extname(e).toLowerCase();return{js:"text/javascript",html:"text/html",css:"text/css",svg:"image/svg+xml",svgz:"image/svg+xml",json:"application/json",wasm:"application/wasm"}[t.substring(1,t.length)]};r["protocol"].registerBufferProtocol(e,((e,t)=>{const r=n(e.url),s=i.a.readFileSync(r),a=o(r);t({mimeType:a,data:s})}))}Kt()(un,"emitter",new en.a.EventEmitter);const dn=(e,t)=>{un.subscribe(e,t)};var fn=n(112),hn=n.n(fn),gn=n(69),mn=n.n(gn),vn=n(113);const yn=n(18).trackerList.filter((e=>!e.startsWith("ws")));function wn(e,t){let n=null;"function"!==typeof e&&(n=new Promise((t=>{e=t})));const r=new vn["Client"]({infoHash:Buffer.from("61b3b8856c4839edf51f5c2346599b6bec524145"),peerId:Buffer.from("-WT0000-123456789012"),announce:yn,port:6881}),o=new Map;yn.forEach((e=>o.set(e,"connecting")));const s=new Set(yn),a=e=>{const t=[...o.entries()],[n,r]=t.reduce(((e,t)=>{const[n,r]=t;return"connected"===r?e[0].push(n):e[1].push(n),e}),[[],[]]);e({success:n,fail:r})},i=setTimeout(a,3e4),l=(n,l,c)=>{o.set(n+"@"+c,l),s.delete(n),"function"===typeof t&&t(n,l),0===s.size&&(clearTimeout(i),a(e),r.stop(),r.destroy())};return r.on("warning",((e,t,n=4)=>{if(!t)return console.error(e);l(t,"error",n)})),r.on("update",((e,t,n=4)=>{if(!t)return console.log(e);l(t,"connected",n)})),r.start(),n}var bn=n(114),Sn=n.n(bn);const kn="magnet:?xt=urn:btih:61b3b8856c4839edf51f5c2346599b6bec524145";function _n(e,t){let n=null;"function"!==typeof e&&(n=new Promise((t=>{e=t})));const s=(...t)=>{if(!s.called)return s.called=!0,e(...t)},i=Object(o["resolve"])(r["app"].getPath("temp"),"alphabiz"+Math.random().toString().substring(2));Object(a["mkdirSync"])(i,{recursive:!0});const l=new Sn.a,c=()=>{l.destroy((()=>Object(a["rmSync"])(i,{recursive:!0})))},u=Date.now(),p=l.add(kn,{path:i,announce:be["trackerList"]}),d=setTimeout((()=>{const e=p.ready&&p.downloaded;p.ready?p.downloaded?console.log(p.downloaded/1e6):console.log("[TorrentCheck] No downloaded"):console.log("[TorrentCheck] Not ready"),c(),e?s(null,Math.floor((Date.now()-u)/1e3)):s(new Error("Timeout"))}),6e4);return p.on("ready",(()=>{"function"===typeof t&&t(p)})),p.on("done",(()=>{clearTimeout(d),c(),s(null,Math.floor((Date.now()-u)/1e3))})),n}const xn=["DynamoDB","AppSync","Lambda","SNS"],Un="us-east-1";async function Cn(){const e=[],t=[],n=Date.now();return await Promise.all(xn.map((async r=>{const o=`https://status.aws.amazon.com/rss/${r.toLowerCase()}-${Un}.rss`;try{var s;const{data:a}=await p.a.get(o),i=Date.now()-n;if(!a||"string"!==typeof a)return t.push({name:r});const l=null===(s=a.replace(/\n/g,"").match(/<item>\s*<title>(.*?)<\/title/))||void 0===s?void 0:s[1];if(console.log(r,l),!l||!l.includes("operating normally"))return t.push({name:r});e.push({name:r,avgTime:i})}catch(cr){t.push({name:r})}}))),{successServices:e,errorServices:t}}const Tn="check-network-end",Pn="check-network-result",An="alpha.biz",On="us-east-1",Rn=[`dynamodb.${On}.amazonaws.com`,`sms.${On}.amazonaws.com`,`lambda.${On}.amazonaws.com`,`appsync.${On}.amazonaws.com`],En=e=>{const t=e.includes(".")?e.substring(0,e.indexOf(".")):e;switch(t){case"dynamodb":return"DynamoDB";case"sms":return"SNS";case"lambda":return"Lambda";case"appsync":return"AppSync"}return t},Ln=async(e,t)=>{const n=[];for(const r of e){const e=await mn.a.promise.probe(r).then((e=>({url:r,alive:!!e.alive,avgTime:"unknown"===e.avg?"-":e.avg||"-",packetLoss:Number(e.packetLoss).toFixed(1)})));n.push(e),"function"===typeof t&&t(e)}return n};let jn=!1;function In(e,t){return-1!==Object.prototype.toString.call(e).indexOf(t)}function Mn(e,t,n){const r={};return Object.keys(e).forEach((n=>{t.find((t=>In(e[n],t)))&&(r[n]=e[n])})),Object.assign(r,{...n})}function Dn(e,t={},n=!1){try{if(n)return void global.win.send("send_error",{eventName:e,data:t});global.win.send("send_result",{eventName:e,data:t})}catch(r){const o=Mn(t,["Number","String","Boolean"],{received:t.received,downloaded:t.downloaded,downloadSpeed:t.downloadSpeed,uploaded:t.uploaded,uploadSpeed:t.uploadSpeed});if(n)return void global.win.send("send_error",{eventName:e,data:o});global.win.send("send_result",{eventName:e,data:o})}}r["ipcMain"].on("check-network",(()=>{if(!global.win||jn)return;const e=global.win.webContents;jn=!0;const t=r["net"].isOnline();if(!t)return jn=!1,e.send(Tn,{isOnline:t});e.send(Pn,{type:"isOnline",result:t});const n=Promise.all(Rn.map((e=>new Promise((t=>{const n=Date.now();hn.a.lookup(e,(r=>{const o=En(e);if(r)return t({error:r,name:o});const s=Date.now()-n;t({error:null,name:o,time:s})}))}))))).then((t=>{const n={success:[],fail:[],avgTime:0};t.forEach((({error:e,name:t,time:r})=>{e?n.fail.push({name:t}):(n.success.push({name:t,time:r}),n.avgTime+=r)})),n.success.length&&(n.avgTime=Math.floor(n.avgTime/n.success.length)),e.send(Pn,{type:"dnsCheckResult",result:n})})),o=["example.com","google.com","www.microsoft.com","github.com"];"zh-CN"===Ft.getUserSettings("language")&&o.push("baidu.com");const s=Ln(o,(t=>{e.send(Pn,{type:"publicPingResult",result:t})})).then((t=>{const n=`${t.filter((e=>e.alive)).length} / ${t.length}`;e.send(Pn,{type:"publicPingEnd",result:n})})),a=mn.a.promise.probe(An).then((t=>{e.send(Pn,{type:"privatePingEnd",result:{url:An,alive:!!t.alive,avgTime:"unknown"===t.avg?"-":t.avg||"-",packetLoss:Number(t.packetLoss).toFixed(1)}})})),i=Cn().then((({successServices:t,errorServices:n})=>{e.send(Pn,{type:"pingAwsEnd",error:!!n.length,successServices:t,errorServices:n})})),l=new Promise((t=>{wn((n=>{e.send(Pn,{type:"trackerCheckEnd",result:n}),t()}),((t,n)=>{e.send(Pn,{type:"trackerCheckResult",result:{url:t,result:n}})}))})),c=new Promise((t=>{_n(((n,r)=>{e.send(Pn,{type:"torrentCheckResult",result:{error:!!n,time:r||-1}}),t()}))}));Promise.all([n,s,a,i,l,c]).then((()=>{setTimeout((()=>{jn=!1,e.send(Tn,{isOnline:t})}),1e3)}))})),r["ipcMain"].on("select_file",(e=>{r["dialog"].showOpenDialog({properties:["openFile"]}).then((e=>{e.filePaths.length&&Dn("select_file",e)}))})),r["ipcMain"].on("select_directory",(e=>{r["dialog"].showOpenDialog(or(),{properties:["openDirectory"]}).then((e=>{or().webContents.send("select_directory",e)}))})),r["ipcMain"].on("select_file_or_directory",((e,t=[])=>{console.log("select file or directory"),r["dialog"].showOpenDialog(or(),{properties:["openDirectory","openFile"],filters:t}).then((e=>{or().webContents.send("select_file_or_directory",e)}))})),r["ipcMain"].on("to_browserurl",((e,t)=>{r["shell"].openExternal(t)})),r["ipcMain"].on("set_setting",((e,t)=>{console.log(t),de.setConfig(t),console.log(de.getConfig()),Dn("set_setting",{})})),r["ipcMain"].handle("deleteConfig",(async()=>{const e=Ft.userSettings;try{return i.a.unlinkSync(e.path),"Successfully deleted: "+e.path}catch(t){return"Error: "+t}})),r["ipcMain"].handle("get-app-settings",(async(e={})=>{const t=Ft.getUserSettings(e),n={...t};return n})),r["ipcMain"].on("get-item-settings",((e,t)=>{const n=Ft.getUserSettings(t),r={...n};return r})),r["ipcMain"].on("set_settings",(async(e,t)=>{var n;console.log("set settings",t),"bindTorrentFile"in t&&await A({torrent:t.bindTorrentFile}),t.bindVideoExts&&await A(t.bindVideoExts),t.bindAudioExts&&await A(t.bindAudioExts),"bindMagnetUrl"in t&&(t.bindMagnetUrl?cn("magnet",!0):an("magnet")),Ft.setUserSettings(t),t.uploadDirectory&&(console.log(t.uploadDirectory),Ut(t.uploadDirectory)),null===(n=global.win)||void 0===n||n.webContents.send("set_settings_success")})),r["ipcMain"].on("get_setting",(async e=>{const t=de.getConfig()||{};t.downloadDirectory||(t.downloadDirectory=r["app"].getPath("downloads")),Dn("get_setting",t)})),r["ipcMain"].on("reset_settings",(async e=>{Ft.resetSettings(),await Ft.updateAssociateInfo(),console.log("resetted"),e.reply("reset_settings",Ft.getUserSettings())})),r["ipcMain"].on("update_tracker",((e,t)=>{Array.isArray(t)&&Ft.setUserSettings({trackerSource:t}),Ft.updateTrackers().then((e=>{Dn("update_tracker",e)}))})),r["ipcMain"].on("setup_file_association",(()=>R())),r["ipcMain"].on("app_window_control",((e,t)=>{const n={isMaximized:()=>global.win.isMaximized(),minimize:()=>global.win.minimize(),maximize:()=>global.win.maximize(),unmaximize:()=>global.win.unmaximize(),close:()=>global.win.close()};e.returnValue=n[t]()})),r["ipcMain"].on("enable_devtools",(()=>{console.log("enable devtools"),Ft.setUserSettings({disableDevTools:!1}),J.emit("enable_devtools")})),r["ipcMain"].on("disable_devtools",(()=>{console.log("disable devtools"),Ft.setUserSettings({disableDevTools:!0})})),r["ipcMain"].on("convert-url",(async(e,t)=>{if(t.startsWith("alphabiz://")||t.startsWith("ab://")){const e=t.startsWith("alphabiz")?t:t.replace("ab://","alphabiz:///"),n=await We.decode(e);global.win.webContents.send("convert-url",n)}else We.encode({hash:t,url:t},((e,t)=>{e||(console.log("encoded url:",t),global.win.webContents.send("convert-url",t))}))})),r["ipcMain"].handle("convert-aburl",(async(e,t)=>{if(t.startsWith("alphabiz://")||t.startsWith("ab://")){const e=t.startsWith("alphabiz")?t:t.replace("ab://","alphabiz:///"),n=await We.decode(e);return n}{const e=new Promise(((e,n)=>{We.encode({hash:t,url:t},((t,r)=>{if(t)return n(t);console.log("encoded url:",r),e(r)}))}));return e}}));const Hn=s.a.resolve(r["app"].getPath("userData"),"library.db");J.on("library-db",(()=>{if(console.log("get library db"),i.a.existsSync(Hn)){console.log("db exists");const e=JSON.parse(i.a.readFileSync(Hn));J.emit("library-db",e)}})),J.on("save-library-db",(e=>{if(!e||"object"!==typeof e||!Object.keys(e).length)return;const t=JSON.stringify(e),n=i.a.existsSync(Hn)?i.a.statSync(Hn).size:-1;n>1.1*t.length?console.log(`Skip saving libdb. Old file size: ${n}. To save size: ${t.length}`):i.a.writeFile(Hn,t,(()=>{}))})),r["ipcMain"].handle("read-abk",((e,t)=>{if(![".abk"].includes(s.a.extname(t).toLowerCase()))return;if(!i.a.existsSync(t))return;const n=i.a.readFileSync(t);return n.toString()}));class $n{static start(){this.interval=setInterval((()=>{const e=this.attemptGetWebContents();e&&this.onGotWebContents()}),500)}static attemptGetWebContents(){let e;return global.win&&global.win.webContents?(this.webContents=global.win.webContents,e=!0):e=!1,e}static onGotWebContents(){clearInterval(this.interval),this.interval=null,this.messages.forEach((e=>{this.sendMessage(...e)})),this.messages=[]}static sendMessage(...e){this.webContents?this.webContents.send("oauth-log",...e):(this.messages.push(e),this.interval||this.start())}}Kt()($n,"messages",[]),Kt()($n,"webContents",null),Kt()($n,"interval",null),dn("$oauth",((e,t,n)=>{"alphabiz://$oauth/"!==n&&global.win.webContents.send("oauth_event",t,n)}));var Fn=n(115),zn=n.n(Fn);const qn=e=>{e.forEach((e=>{e.label&&(e.label=Dt.$t(e.label.toLowerCase().replace(/\s/g,"_"))),e.submenu&&qn(e.submenu)}))},Bn=()=>{const e=zn()(r["app"],r["shell"]);qn(e);const t=e.find((e=>"help"===e.role)).submenu,n="https://github.com/tanshuai/alphabiz";if(t.splice(0,1,{label:Dt.$t("github_repo"),click:()=>r["shell"].openExternal(n)},{label:Dt.$t("issues"),click:()=>r["shell"].openExternal(n+"/issues")},{label:Dt.$t("official_site"),click:()=>r["shell"].openExternal("https://alpha.biz")}),"darwin"===process.platform){var o;const t=null===(o=e[0])||void 0===o?void 0:o.submenu;t[0]={label:`${Dt.$t("about")} ${r["app"].name}`,click(){global.win.send("about-dialog")}},t.find((e=>"hide"===e.role)).label=Dt.$t("hide")+" "+r["app"].name}else t.unshift({label:Dt.$t("about"),click:()=>{global.win.send("about-dialog")}},{label:Dt.$t("check_for_update"),click(){checkForUpdate(!0)}},{type:"separator"});const s=e.findIndex((e=>e.label===Dt.$t("edit"))),a=[{label:Dt.$t("open_file"),accelerator:"CmdOrCtrl+O",click:()=>{r["dialog"].showOpenDialog({properties:["openFile"]}).then((e=>{var t;!e.canceled&&null!==(t=e.filePaths)&&void 0!==t&&t.length&&global.win.webContents.send("open-file",e.filePaths[0])}))}}];"darwin"!==process.platform&&a.push({label:Dt.$t("quit"),click:()=>{r["app"].isQuitting=!0,r["app"].quit()}}),e.splice(s,0,{label:Dt.$t("file"),submenu:a});const i=e.findIndex((e=>e.label===Dt.$t("view")));i&&e.splice(i,1),r["Menu"].setApplicationMenu(r["Menu"].buildFromTemplate(e))};r["app"].whenReady().then((()=>{Ft.onLocaleChange(Bn)}));var Nn=n(116),Wn=n.n(Nn);let Gn=null;const Kn=()=>{"function"===typeof Gn&&Gn(),Gn=Wn()({showInspectElement:!1,labels:{learnSpelling:Dt.$t("learn_spelling"),lookUpSelection:Dt.$t("lookup_selection"),searchWithGoogle:Dt.$t("search_with_google"),cut:Dt.$t("cut"),copy:Dt.$t("copy"),paste:Dt.$t("paste"),saveImage:Dt.$t("save_image"),saveImageAs:Dt.$t("save_image_as"),copyLink:Dt.$t("copy_link"),saveLinkAs:Dt.$t("save_link_as"),copyImage:Dt.$t("copy_image"),copyImageAddress:Dt.$t("copy_image_address"),services:Dt.$t("services")}})};r["app"].whenReady().then((()=>{Ft.onLocaleChange(Kn)}));const Vn=()=>{r["app"].isQuitting=!0,r["app"].quit(),r["app"].quit()};r["app"].commandLine.appendSwitch("js-flags","--expose_gc --optimize-for-size"),r["app"].on("before-quit",(e=>{r["app"].isQuitting||(r["app"].isQuitting=!0,r["app"].quit())})),Yt(r["app"]);const Jn=q("version"),Zn=q("version");console.log("version:"+Jn+",appVersion:"+Zn);const Qn=!H.a.prerelease(Zn);try{"win32"===process.platform&&!0===r["nativeTheme"].shouldUseDarkColors&&n(1).unlinkSync(n(3).join(r["app"].getPath("userData"),"DevTools Extensions"))}catch(ur){}process.argv.includes("--reset-all")?(Ft.clear(),de.clear({destroyStore:!0})):(process.argv.includes("--reset-settings")&&Ft.clear(),process.argv.includes("--reset-tasks-with-files")&&de.clear({destroyStore:!0}),process.argv.includes("--reset-tasks")&&de.clear()),r["ipcMain"].on("dev-info",(e=>{e.reply("dev-info",{torrentStore:de.path,settingStore:Ft.path,electronVer:process.versions.electron,chromeVer:process.versions.chrome,nodeVer:process.versions.node,osVer:Y.a.version(),osPlatform:Y.a.platform(),osRelease:process.getSystemVersion(),argv:process.argv})}));let Yn=null;const Xn=new Promise((e=>{Yn=e}));let er=!1;r["ipcMain"].on("main-window-ready",(()=>{console.log("App created"),Yn(),er||(er=!0,r["app"].setPath("crashDumps",s.a.resolve(r["app"].getPath("userData"),"CrashLogs")),r["crashReporter"].start({uploadToServer:!1,submitURL:""}))}));const tr=[],nr=process.argv.includes("--")?process.argv[process.argv.indexOf("--")+1]:"";let rr;Bt.then((e=>{e||Vn()}));const or=()=>rr;function sr(){r["app"].on("second-instance",((e,t,n,r)=>{if(console.log("on second instance"),rr&&(rr.isMinimized()&&rr.restore(),rr.isVisible()||rr.show(),rr.focus(),null!==t&&void 0!==t&&t.includes("--"))){const e=t[t.indexOf("--")+1];if(e.startsWith("alphabiz://")||e.startsWith("ab://"))return void console.log("Skip ab url",e);e&&e.length&&rr.webContents.send("open-file",e)}})),console.log("Creating main window"),console.log(__dirname);const e={frame:!1,titleBarStyle:"hidden",width:1248,height:798,minHeight:480,minWidth:640,useContentSize:!0,backgroundThrottling:!1,webPreferences:{spellcheck:!0,enableRemoteModule:!0,nodeIntegration:!0,contextIsolation:!1,nodeIntegrationInWorker:!0,backgroundThrottling:!1,webSecurity:!1},show:!1};"darwin"===process.platform&&(e.trafficLightPosition={x:12,y:8}),rr=new r["BrowserWindow"](e),rr.webContents.session.webRequest.onBeforeSendHeaders(((e,t)=>{t({requestHeaders:{...e.requestHeaders,Origin:"*",Referer:""}})})),rr.webContents.session.on("will-download",((e,t)=>{var n;const r=t.getFilename(),o=null===(n=r.match(/\.([^.]+)/))||void 0===n?void 0:n[1];let s=o;switch(o){case"abk":s="Alphabiz Key";break;case"json":s="JSON Database";break}const a={title:Dt.$t("save_as")};o&&(a.filters=[{name:s,extensions:[o]}]),t.setSaveDialogOptions(a)}));{const e=process.env.APP_SCHEME,t=s.a.basename("file://"+__dirname+"/index.html");rr.loadURL(`${e}://${t}/#/library`)}rr.on("close",(e=>{r["app"].isQuitting||(e.preventDefault(),rr.hide())})),rr.on("closed",(()=>{rr=null,Vn()})),rr.webContents.on("new-window",((e,t,n,o,s,a,i,l)=>{e.preventDefault(),r["shell"].openExternal(t)})),rr.once("ready-to-show",(async()=>{rr.show(),await Xn,nr&&rr.webContents.send("open-file",nr),tr.length&&rr.webContents.send("open-file",...tr),Ft.updateAssociateInfo().then((e=>{e.every((e=>e))||Ft.getUserSettings("dontAskForAssociate")||setTimeout((()=>{rr.webContents.send("ask-for-associate")}),3e3)}))})),rr.on("enter-full-screen",(()=>{rr.setMenuBarVisibility(!1)})),rr.on("leave-full-screen",(()=>{rr.setMenuBarVisibility(!0)})),rr.on("blur",(()=>{r["globalShortcut"].unregisterAll()})),rr.on("focus",(()=>{["F5","CommandOrControl+R","CommandOrControl+Shift+R"].forEach((e=>{r["globalShortcut"].register(e,(()=>{}))})),["Control+Shift+I","Command+Alt+I","CommandOrControl+Shift+C","F12"].forEach((e=>{r["globalShortcut"].register(e,(()=>{if(!Qn||!Ft.getUserSettings("disableDevTools"))return rr.webContents.openDevTools()}))}))})),rr.webContents.on("did-finish-load",(()=>{console.log("Main window loaded"),Qt.isBusy=!1})),global.win=rr}r["app"].on("window-all-closed",(()=>{"darwin"!==process.platform&&Vn()})),r["app"].on("activate",(()=>{null===rr?sr():rr.isVisible()||rr.show()})),r["app"].on("open-file",((e,...t)=>{e.preventDefault(),rr?rr.webContents.send("open-file",...t):tr.push(...t)})),r["ipcMain"].on("request-ask-for-player",(()=>{Ft.getUserSettings("dontAskForPlayer")||setTimeout((()=>{rr.webContents.send("ask-for-player")}),4e3)})),r["ipcMain"].on("dismiss-update",(()=>{Qt.isBusy=!1}));const ar=async(e=!1)=>{const t=Ft.getUserSettings("versionChannel")||"stable";if(console.log("checkForUpdate:appVersion:"+Zn),Qt.isBusy)return console.log("MU busy");Qt.isBusy=!0;const n=new Qt({version:Zn,channel:t||"stable",pre:"stable"!==t});e&&rr.webContents.send("start-checking-update");const o=await n.checkForUpdate();if(Ft.setUserSettings({lastUpdateCheckTime:Date.now()}),o.shouldUpdate){rr.webContents.send("update-available",{version:o.version,detail:o.detail}),r["ipcMain"].removeAllListeners("confirm-update"),r["ipcMain"].removeAllListeners("abort-update"),r["ipcMain"].removeAllListeners("install-update");let e,t=null;r["ipcMain"].on("confirm-update",(()=>{if(Qt.isBusy)return console.log("confirm: MU busy");Qt.isBusy=!0,rr.webContents.send("update-downloading");const s=()=>{if(n.cancel.canceled)return Qt.isBusy=!1,clearInterval(e);Qt.isBusy=!0;const t={};for(const[e,r]of n.downloadProgress.entries())t[e]=r;rr.webContents.send("update-progress",t)};clearInterval(e),e=setInterval(s,1e3),n.downloadUpdate(o.assets).then((n=>{if(clearInterval(e),s(),!n.length)return rr.webContents.send("update-not-available");rr.webContents.send("ready-to-restart");const o=()=>{"darwin"===process.platform||"win32"===process.platform?r["shell"].openExternal("file://"+n[0]).then((()=>{Vn()})):(r["shell"].showItemInFolder(n[0]),setTimeout((()=>{Vn()}),1e3))};r["ipcMain"].once("install-update",(()=>{console.log("install..."),o()})),t=setTimeout(o,1e4)})).catch((t=>{clearInterval(e),console.log("Failed",t),setTimeout((()=>{rr.webContents.send("update-failed",{reason:t.message||t})}),1e3)})).then((()=>{Qt.isBusy=!1}))})),r["ipcMain"].on("abort-update",(()=>{if(console.log("Got abort"),clearInterval(e),t)return console.log("clear timer"),clearTimeout(t),void rr.webContents.send("install-aborted");n.cancel.canceled=!0,n.cancel.cancel("aborted"),rr.webContents.send("update-aborted")}))}else console.log("No new version available. Reason:",o.reason),rr.webContents.send("update-not-available",{reason:"already_latest",showDialog:e});Qt.isBusy=!1};r["ipcMain"].on("check-for-update",((e,t=!1)=>{console.log("check-for-update",t),ar(!t)})),r["ipcMain"].on("change-app-i18n",((e,t)=>{t&&(console.log("change i18n",t),Ft.updateLocales(t.value||t))})),r["app"].on("ready",(async()=>{await gt.ready,sr();const e=()=>{Ft.getUserSettings("autoCheckUpdate")&&!Qt.isBusy&&ar(!1)};setTimeout((()=>{e(),setTimeout((()=>{Wt.a.scheduleJob("0 0 12 * * *",e)}),1e4)}),1e4)})),r["app"].on("render-process-gone",((e,t,n)=>{e.preventDefault();const r=t.getTitle()+"\n"+JSON.stringify(n,null,2);console.log("Crash info:",r),"Alphabiz Webtorrent Hidden Window"!==t.getTitle()?"clean-exit"!==n.reason&&Vn():console.log("Should not quit")})),r["app"].on("child-process-gone",((e,t)=>{console.log(t),"clean-exit"!==t.reason&&Vn()}));const ir=r["app"].getPath("logs");Object(a["existsSync"])(ir)||Object(a["mkdirSync"])(ir,{recursive:!0});const lr=()=>{console.log("log path",ir);const e=new Date;e.setMonth(e.getMonth()-1);const t=e.valueOf();Object(a["readdir"])(ir,((e,n)=>{if(e)return console.error("error",e);console.log("got files",n.length);let r=0;n.forEach((e=>{const n=parseInt(e.startsWith("crash-")?e.substring(6):e);isNaN(n)||n<t&&(Object(a["unlink"])(s.a.resolve(ir,e),(()=>{})),r++)})),r&&console.log("unlink",r,"files")}))};lr(),process.on("uncaughtException",(e=>{Object(a["writeFileSync"])(Object(o["resolve"])(ir,`crash-${Date.now()}.log`),[e.name,e.message,e.stack||""].join("\n")),rr&&rr.webContents.send("main-process-error",{message:e.message,name:e.name,stack:e.stack||[]}),"ENOSPC"===e.name&&Vn()})),r["ipcMain"].on("exit-app",(()=>Vn()))}]);